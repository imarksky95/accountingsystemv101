"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[668],{3518:(t,n,e)=>{function c(t){if(!t)return"";const n="string"===typeof t?new Date(t):t;if(Number.isNaN(n.getTime()))return"";const e=String(n.getMonth()+1).padStart(2,"0"),c=String(n.getDate()).padStart(2,"0"),a=String(n.getFullYear());return"".concat(e,"/").concat(c,"/").concat(a)}e.d(n,{V:()=>c})},3668:(t,n,e)=>{e.r(n),e.d(n,{default:()=>I});var c=e(2555),a=e(5043),o=e(3518),l=e(6446),i=e(5865),r=e(1906),s=e(9650),d=e(3336),h=e(1806),A=e(4882),u=e(8076),p=e(2420),j=e(3460),m=e(7392),x=e(35),y=e(6600),_=e(5316),f=e(5795),g=e(3193),C=e(9190),v=e(2221),S=e(1449),w=e(9347),b=e(3159),k=e(3471),E=e(2505),T=e(4739),N=e(579);const D=["Customer","Vendor","Employee"],I=()=>{const[t,n]=(0,a.useState)([]),[e,I]=(0,a.useState)(!1),[W,B]=(0,a.useState)(!1),[F,L]=(0,a.useState)(null),[M,O]=(0,a.useState)(!1),[V,$]=(0,a.useState)(null),[z,H]=(0,a.useState)({contact_control:"",display_name:"",contact_type:"",contact_info:""}),J=async()=>{I(!0);try{const t=await(0,T.S)("/api/contacts"),e=await t.json();n(Array.isArray(e)?e:[])}catch(t){console.error("fetch contacts failed",t)}finally{I(!1)}};(0,a.useEffect)(()=>{J()},[]);const P=t=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur(),t?(L(t.contact_id),H({contact_control:t.contact_control,display_name:t.display_name,contact_type:t.contact_type||"",contact_info:t.contact_info||""})):(L(null),H({contact_control:"",display_name:"",contact_type:"",contact_info:""})),B(!0)},U=()=>{B(!1),L(null)};return(0,N.jsxs)(l.A,{p:2,children:[(0,N.jsx)(i.A,{variant:"h5",gutterBottom:!0,children:"Contacts"}),(0,N.jsx)(r.A,{variant:"contained",startIcon:(0,N.jsx)(E.A,{}),onClick:()=>P(),sx:{mb:2},children:"Add Contact"}),(0,N.jsx)(s.A,{component:d.A,children:(0,N.jsxs)(h.A,{children:[(0,N.jsx)(A.A,{children:(0,N.jsxs)(u.A,{children:[(0,N.jsx)(p.A,{children:"Contact Control #"}),(0,N.jsx)(p.A,{children:"Display Name"}),(0,N.jsx)(p.A,{children:"Type"}),(0,N.jsx)(p.A,{children:"Contact Info"}),(0,N.jsx)(p.A,{children:"Created At"}),(0,N.jsx)(p.A,{align:"right",children:"Actions"})]})}),(0,N.jsxs)(j.A,{children:[t.map(t=>(0,N.jsxs)(u.A,{children:[(0,N.jsx)(p.A,{children:t.contact_control}),(0,N.jsx)(p.A,{children:t.display_name}),(0,N.jsx)(p.A,{children:t.contact_type}),(0,N.jsx)(p.A,{children:t.contact_info}),(0,N.jsx)(p.A,{children:(0,o.V)(t.created_at)}),(0,N.jsxs)(p.A,{align:"right",children:[(0,N.jsx)(m.A,{onClick:()=>P(t),children:(0,N.jsx)(b.A,{})}),(0,N.jsx)(m.A,{color:"error",onClick:()=>(async t=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur(),$(t),O(!0)})(t.contact_id),children:(0,N.jsx)(k.A,{})})]})]},t.contact_id)),0===t.length&&!e&&(0,N.jsx)(u.A,{children:(0,N.jsx)(p.A,{colSpan:6,align:"center",children:"No contacts found."})})]})]})}),(0,N.jsxs)(x.A,{open:W,onClose:U,children:[(0,N.jsx)(y.A,{children:F?"Edit Contact":"Add Contact"}),(0,N.jsxs)(_.A,{children:[(0,N.jsx)(f.A,{margin:"dense",label:"Contact Control #",name:"contact_control",value:z.contact_control,onChange:t=>H((0,c.A)((0,c.A)({},z),{},{contact_control:t.target.value})),fullWidth:!0,disabled:!F,helperText:F?"":"Auto-generated"}),(0,N.jsx)(f.A,{autoFocus:!0,margin:"dense",label:"Display Name",name:"display_name",value:z.display_name,onChange:t=>H((0,c.A)((0,c.A)({},z),{},{display_name:t.target.value})),fullWidth:!0}),(0,N.jsxs)(g.A,{fullWidth:!0,margin:"dense",children:[(0,N.jsx)(C.A,{id:"contact-type-label",children:"Contact Type"}),(0,N.jsxs)(v.A,{labelId:"contact-type-label",name:"contact_type",value:z.contact_type,label:"Contact Type",onChange:t=>H((0,c.A)((0,c.A)({},z),{},{contact_type:t.target.value})),children:[(0,N.jsx)(S.A,{value:"",children:(0,N.jsx)("em",{children:"None"})}),D.map(t=>(0,N.jsx)(S.A,{value:t,children:t},t))]})]}),(0,N.jsx)(f.A,{margin:"dense",label:"Contact Info",name:"contact_info",value:z.contact_info,onChange:t=>H((0,c.A)((0,c.A)({},z),{},{contact_info:t.target.value})),fullWidth:!0,multiline:!0,rows:3})]}),(0,N.jsxs)(w.A,{children:[(0,N.jsx)(r.A,{onClick:U,children:"Cancel"}),(0,N.jsx)(r.A,{onClick:async()=>{try{let t;const n=localStorage.getItem("token");if(!n)return void alert("You must be logged in to perform this action.");const e={Authorization:"Bearer ".concat(n)};if(F){const n={display_name:z.display_name,contact_type:z.contact_type,contact_info:z.contact_info};z.contact_control&&(n.contact_control=z.contact_control),t=await window.fetch((0,T.c$)("/api/contacts/".concat(F)),{method:"PUT",headers:(0,c.A)({"Content-Type":"application/json"},e),body:JSON.stringify(n)})}else{const n={display_name:z.display_name,contact_type:z.contact_type,contact_info:z.contact_info};t=await window.fetch((0,T.c$)("/api/contacts"),{method:"POST",headers:(0,c.A)({"Content-Type":"application/json"},e),body:JSON.stringify(n)})}if(!t.ok)throw new Error("Save failed");await J(),U()}catch(t){alert("Save failed")}},variant:"contained",children:F?"Update":"Add"})]})]}),(0,N.jsxs)(x.A,{open:M,onClose:()=>O(!1),children:[(0,N.jsx)(y.A,{children:"Confirm Delete"}),(0,N.jsx)(_.A,{children:"Are you sure you want to delete this contact?"}),(0,N.jsxs)(w.A,{children:[(0,N.jsx)(r.A,{autoFocus:!0,onClick:()=>O(!1),children:"Cancel"}),(0,N.jsx)(r.A,{color:"error",onClick:async()=>{if(V)try{await window.fetch((0,T.c$)("/api/contacts/".concat(V)),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")||"")}}),O(!1),$(null),await J()}catch(t){alert("Delete failed")}},children:"Delete"})]})]})]})}}}]);
//# sourceMappingURL=668.574b8cc1.chunk.js.map