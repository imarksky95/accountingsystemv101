{"version":3,"file":"static/js/46.c997e991.chunk.js","mappings":"gcAOAA,QAAQC,OAASD,QAAQC,MAAM,uCAAwCC,EAAAA,IAAqB,2BAoB5F,MAAMC,EAAoB,CACxBC,OAAQ,QACRC,iBAAkB,GAClBC,QAAS,GACTC,aAAc,GACdC,YAAa,KACbC,YAAa,GACbC,cAAe,GACfC,cAAe,IAg4BjB,EA73BkCC,KAChC,MAAM,KAAEC,IAASC,EAAAA,EAAAA,YAAWC,EAAAA,IACrBC,EAAOC,IAAYC,EAAAA,EAAAA,UAAgB,KACnCC,EAASC,IAAcF,EAAAA,EAAAA,WAAS,IAGhCG,EAAUC,IAAeJ,EAAAA,EAAAA,UAAgB,KACzCK,EAAMC,IAAWN,EAAAA,EAAAA,UAAgB,KAGjCO,EAAMC,IAAWR,EAAAA,EAAAA,WAAS,IAC1BS,EAASC,IAAcV,EAAAA,EAAAA,UAAqB,OAC5CW,EAAMC,IAAWZ,EAAAA,EAAAA,UAAiBf,IAClC4B,EAAiBC,IAAsBd,EAAAA,EAAAA,UAAiB,IACzDe,GAAgBC,EAAAA,EAAAA,QAAgC,OAC/CC,EAAgBC,IAAqBlB,EAAAA,EAAAA,UAAc,OACnDmB,EAAWC,IAAgBpB,EAAAA,EAAAA,UAAiC,CAAC,IAC7DqB,EAAaC,IAAkBtB,EAAAA,EAAAA,WAAS,IACxCuB,GAAaC,KAAkBxB,EAAAA,EAAAA,UAAqB,MAGrDyB,GAAuBC,IAC3B,QAAYC,IAARD,GAA6B,OAARA,GAAwB,KAARA,EAAY,MAAO,GAC5D,GAAIE,MAAMC,QAAQH,GAAM,OAAOA,EAAII,IAAIC,QAAQC,OAAOC,SACtD,GAAmB,kBAARP,EAAkB,MAAO,CAACK,OAAOL,IAC5C,GAAmB,kBAARA,EAAkB,CAE3B,IACE,MAAMQ,EAAIC,KAAKC,MAAMV,GACrB,GAAIE,MAAMC,QAAQK,GAAI,OAAOA,EAAEJ,IAAIC,QAAQC,OAAOC,SAClD,GAAiB,kBAANC,GAA+B,kBAANA,EAAgB,MAAO,CAACH,OAAOG,GACrE,CAAE,MAAOG,GACP,CAGF,MAAMC,EAAIZ,EAAIa,MAAM,OACpB,OAAID,EAAU,CAACA,EAAE,IAEV,EACT,CACA,MAAO,IAIHE,GAAuBd,IAC3B,MAAMe,EAAMhB,GAAoBC,GAChC,OAAIe,EAAIC,OACCD,EAAIX,IAAIa,GAAMxB,EAAUY,OAAOY,KAAQZ,OAAOY,IAAKC,KAAK,MAG7DlB,GAAsB,kBAARA,EAAyBA,EACpC,KAIFmB,GAAUC,KAAe9C,EAAAA,EAAAA,UAAwB,OACjD+C,GAAaC,KAAkBhD,EAAAA,EAAAA,WAAS,IAGxCiD,GAAUC,KAAelD,EAAAA,EAAAA,UAAkC,CAAC,IAG5DmD,GAAWC,KAAgBpD,EAAAA,EAAAA,WAAS,IACpCqD,GAAUC,KAAetD,EAAAA,EAAAA,UAAS,KAClCuD,GAAeC,KAAoBxD,EAAAA,EAAAA,UAAuC,QAE3EyD,IAAWC,EAAAA,EAAAA,aAAYC,UAC3BzD,GAAW,GACX,IAEF,IAAI0D,EAAwB,GACxB,IACJ,MAAMC,QAAcC,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,0BACjCJ,EAAYhC,MAAMC,QAAQgC,EAAMI,MAAQJ,EAAMI,KAAO,EACvD,CAAE,MAAOC,GAAU,IAADC,EAChBrF,QAAQsF,MAAM,gCAAmC,OAAHF,QAAG,IAAHA,GAAa,QAAVC,EAAHD,EAAKG,gBAAQ,IAAAF,OAAV,EAAHA,EAAeF,OAAQC,EAAII,SAAWJ,EAEtF,CACAnE,EAAS6D,GAET,IACE,MAAMW,EAA8B,CAAC,EAC/BC,EAAa,IAAIC,IACvB,IAAK,MAAMvC,KAAK0B,EACd,GAAI1B,EAAEwC,qBAAsBH,EAAKxC,OAAOG,EAAE5C,cAAgB4C,EAAEwC,0BACvD,GAAIxC,EAAE5C,cAAgBqF,MAAMC,OAAO1C,EAAE5C,cAAe,CACvD,MAAMuF,EAAM9C,OAAOG,EAAE5C,aAEhB6B,EAAU0D,IAAML,EAAWM,IAAID,EACtC,CAGF,GADIE,OAAOC,KAAKT,GAAM7B,QAAQtB,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAASV,IAC9DC,EAAWW,KAAM,CACnB,MAAMC,EAAQC,aAAaC,QAAQ,eAC7BC,QAAQC,IAAI5D,MAAM6D,KAAKjB,GAAY1C,IAAI6B,UAC3C,IACE,MAAM+B,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAehD,IAAO,CAAEiD,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAC/GM,GAAKA,EAAEzB,MAAM7C,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAACtC,GAAK+C,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAYpD,IACjG,CAAE,MAAON,GACP,IAGN,CACF,CAAE,MAAOA,GAAI,CAGjB,IAAI2D,EAA8F,GAC9F,IACJ,MAAMC,QAAmBnC,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,kBACtCgC,EAAkBpE,MAAMC,QAAQoE,EAAWhC,MAAQgC,EAAWhC,KAAO,EACvE,CAAE,MAAOC,GAAU,IAADgC,EAChBpH,QAAQsF,MAAM,wBAA2B,OAAHF,QAAG,IAAHA,GAAa,QAAVgC,EAAHhC,EAAKG,gBAAQ,IAAA6B,OAAV,EAAHA,EAAejC,OAAQC,EAAII,SAAWJ,GAC5E8B,EAAkB,EACpB,CAGA,GAA+B,IAA3BA,EAAgBtD,OAClB,IACE,MAAMyD,QAAgBrC,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,iBAGnCoC,GAFUxE,MAAMC,QAAQsE,EAAQlC,MAAQkC,EAAQlC,KAAO,IAEtCnC,IAAIuE,IAAC,CAAOC,WAAYD,EAAEE,UAAWC,aAAcH,EAAEI,KAAMC,aAAc,YAChG5H,QAAQ6H,IAAI,gDAAiDP,EAAO1D,OAAQ0D,EAAOQ,MAAM,EAAE,IAC3FxG,EAAYgG,EACd,CAAE,MAAO/D,GAAQ,IAADwE,EACd/H,QAAQsF,MAAM,gCAAiC,OAAD/B,QAAC,IAADA,GAAW,QAAVwE,EAADxE,EAAGgC,gBAAQ,IAAAwC,OAAV,EAADA,EAAa5C,OAAQ5B,EAAEiC,SAAWjC,GAChFjC,EAAY,GACd,MAEAtB,QAAQ6H,IAAI,0BAA2BX,EAAgBtD,OAAQsD,EAAgBY,MAAM,EAAE,IACvFxG,EAAY4F,GAId,IACJ,MAAMc,QAAehD,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,wBAC5B+C,EAAInF,MAAMC,QAAQiF,EAAO7C,MAAQ6C,EAAO7C,KAAO,GACrDnF,QAAQ6H,IAAI,sBAAuBI,EAAErE,OAAQqE,EAAEH,MAAM,EAAE,IACvDtG,EAAQyG,EACV,CAAE,MAAO7C,GAAU,IAAD8C,EAChBlI,QAAQmI,KAAK,6CAAgD,OAAH/C,QAAG,IAAHA,GAAa,QAAV8C,EAAH9C,EAAKG,gBAAQ,IAAA2C,OAAV,EAAHA,EAAe/C,OAAQC,EAAII,SAAWJ,GAChG,IACE,MAAMgD,QAAWpD,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,iCAC9BmD,EAAKvF,MAAMC,QAAQqF,EAAGjD,MAAQiD,EAAGjD,KAAO,GAC9CnF,QAAQ6H,IAAI,8BAA+BQ,EAAGzE,OAAQyE,EAAGP,MAAM,EAAE,IACjEtG,EAAQ6G,EACV,CAAE,MAAOC,GAAW,IAADC,EACjBvI,QAAQsF,MAAM,6BAAiC,OAAJgD,QAAI,IAAJA,GAAc,QAAVC,EAAJD,EAAM/C,gBAAQ,IAAAgD,OAAV,EAAJA,EAAgBpD,OAAQmD,EAAK9C,SAAW8C,GACnF9G,EAAQ,GACV,CACF,CACF,CAAE,MAAO+B,GACPvD,QAAQsF,MAAM,iBAAkB/B,EAClC,CAAC,QAAWnC,GAAW,EAAQ,GAC9B,CAACiB,IAEEmG,GAAY3D,UAChB,IAEF,MAAM4D,QAAYC,EAAAA,EAAAA,GAAqB,uBACnC,IAAKD,EAAIE,GAAI,MAAM,IAAIC,MAAM,6BAAD/B,OAA8B4B,EAAIrI,SAC9D,MAAM+E,QAAasD,EAAII,OACjBZ,EAAInF,MAAMC,QAAQoC,GAAQA,EAAO,GAEvC,OADA3D,EAAQyG,GACDA,CACT,CAAE,MAAO7C,GACPpF,QAAQmI,KAAK,6CAAgD,OAAH/C,QAAG,IAAHA,OAAG,EAAHA,EAAKI,UAAWJ,GAC1E,IACJ,MAAM0D,QAAcJ,EAAAA,EAAAA,GAAqB,gCACnC,IAAKI,EAAMH,GAAI,MAAM,IAAIC,MAAM,8BAAD/B,OAA+BiC,EAAM1I,SACnE,MAAM2I,QAAcD,EAAMD,OACpBR,EAAKvF,MAAMC,QAAQgG,GAASA,EAAQ,GAE1C,OADAvH,EAAQ6G,GACDA,CACT,CAAE,MAAOC,GAGP,OAFAtI,QAAQsF,MAAM,6BAAiC,OAAJgD,QAAI,IAAJA,OAAI,EAAJA,EAAM9C,UAAW8C,GAC5D9G,EAAQ,IACD,EACT,CACF,GAGIwH,GAAgBnE,UACpB,IACF,MAAMsC,QAAmBnC,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,kBAClCgC,EAAkBpE,MAAMC,QAAQoE,EAAWhC,MAAQgC,EAAWhC,KAAO,GAC3E,IAAK+B,GAA8C,IAA3BA,EAAgBtD,OAEtC,IACE,MAAMyD,QAAgBrC,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,iBAEnCoC,GADUxE,MAAMC,QAAQsE,EAAQlC,MAAQkC,EAAQlC,KAAO,IACtCnC,IAAKuE,IAAK,CAAQC,WAAYD,EAAEE,UAAWC,aAAcH,EAAEI,KAAMC,aAAc,YAEtG,OADAtG,EAAYgG,GACLA,CACT,CAAE,MAAO/D,GAAQ,IAAD0F,EAGd,OAFAjJ,QAAQsF,MAAM,gCAAiC,OAAD/B,QAAC,IAADA,GAAW,QAAV0F,EAAD1F,EAAGgC,gBAAQ,IAAA0D,OAAV,EAADA,EAAa9D,OAAQ5B,EAAEiC,SAAWjC,GAChFjC,EAAY,IACL,EACT,CAGF,OADAA,EAAY4F,GACLA,CACT,CAAE,MAAO9B,GAAU,IAAD8D,EAGhB,OAFAlJ,QAAQsF,MAAM,wBAA2B,OAAHF,QAAG,IAAHA,GAAa,QAAV8D,EAAH9D,EAAKG,gBAAQ,IAAA2D,OAAV,EAAHA,EAAe/D,OAAQC,EAAII,SAAWJ,GAC5E9D,EAAY,IACL,EACT,GAwIF6H,EAAAA,UAAgB,KACdxE,MACC,CAACA,KAIJwE,EAAAA,UAAgB,KACV1H,GAEF2H,WAAW,KAAQ,IAAK,IAADC,EAAuB,QAArBA,EAAApH,EAAcqH,eAAO,IAAAD,GAArBA,EAAuBE,OAAS,CAAE,MAAOhG,GAAI,GAAK,IAE5E,CAAC9B,IAEJ0H,EAAAA,UAAgB,MAEdT,EAAAA,EAAAA,GAAqB,uBAAwB,CAAEc,MAAO,aACnDC,KAAK7C,GAAKA,EAAE+B,GAAK/B,EAAEiC,OAAOY,KAAKC,GAAKtH,EAAkBsH,IAAMtH,EAAkB,OAC9EuH,MAAM,IAAMvH,EAAkB,QAChC,IA2DH,OACEwH,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAAAC,SAAA,EACFF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAOC,eAAe,gBAAgBC,WAAW,UAAUJ,SAAA,EAC9EK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,sBACJF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACC,QAAQ,YAAYC,QAvNpBzF,gBACR4B,QAAQC,IAAI,CAACsC,KAAiBR,OAEpC,IACF,MAAMC,QAAYzD,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,iCAC3BqF,EAAOzH,MAAMC,QAAQ0F,EAAItD,MAAQsD,EAAItD,KAAO,GAClDnD,EAAmB,MAAD6E,OAAO0D,EAAK3G,OAAS,GACzC,CAAE,MAAOL,GAAQ,IAADiH,EACdxK,QAAQmI,KAAK,sCAAuC,OAAD5E,QAAC,IAADA,GAAW,QAAViH,EAADjH,EAAGgC,gBAAQ,IAAAiF,OAAV,EAADA,EAAarF,OAAQ5B,EAAEiC,SAAWjC,GACrFvB,EAAmB,GACrB,CACAJ,EAAW,MAEb,IAAI6I,EAA6B,KAC/B,IACE,MAAMnE,EAAQC,aAAaC,QAAQ,SAC7BkE,QAAa1F,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,gBAAiB,CAAE4B,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAC9GoE,GAAQA,EAAKvF,OAAMsF,EAAgBC,EAAKvF,KAC9C,CAAE,MAAO5B,GAEPkH,EAAgB5J,CAClB,CAEF,IAAI8J,EAAmC,GACnCC,EAAmC,GACrC,IACE,MAAMC,EAAkBJ,EACxB,GAAII,EAAI,CACN,MAAMC,EAAYD,EACdC,EAAIC,YAAaJ,EAAkBG,EAAIC,YAClCD,EAAIE,kBAAiBL,EAAkBG,EAAIE,iBAChDF,EAAIG,YAAaL,EAAkBE,EAAIG,YAClCH,EAAII,kBAAiBN,EAAkBE,EAAII,gBACtD,CAEIL,GAAMA,EAAGM,SACX7I,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAAClD,OAAO4H,EAAGM,UAAWN,EAAG7D,WAAa6D,EAAG5D,UAAYhE,OAAO4H,EAAGM,YAGlG,IACE,MAAM7E,EAAQC,aAAaC,QAAQ,SACnC,GAAIqE,GAAMA,EAAGE,cAAgBlF,MAAMC,OAAO+E,EAAGE,cAAe,CAC1D,MAAMK,EAAMnI,OAAO4H,EAAGE,aACtB/F,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAeuE,IAAQ,CAAEtE,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IACjGmD,KAAK7C,IAAWA,GAAKA,EAAEzB,MAAM7C,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAACiF,GAAMxE,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAYmE,OAC5GzB,MAAM,OACX,CACA,GAAIkB,GAAMA,EAAGI,cAAgBpF,MAAMC,OAAO+E,EAAGI,cAAe,CAC1D,MAAMI,EAAMpI,OAAO4H,EAAGI,aACtBjG,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAewE,IAAQ,CAAEvE,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IACjGmD,KAAK7C,IAAWA,GAAKA,EAAEzB,MAAM7C,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAACkF,GAAMzE,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAYoE,OAC5G1B,MAAM,OACX,CACF,CAAE,MAAOpG,GAAI,CACf,CAAE,MAAOA,GAAI,CAEbzB,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACJjG,GAAS,IACZE,kBAAkB,IAAIiL,MAAOC,cAAczD,MAAM,EAAE,IACnDtH,YAAciK,GAAiBA,EAAcU,QAAWV,EAAcU,SAAe,OAAJtK,QAAI,IAAJA,OAAI,EAAJA,EAAMsK,UAAW,KAClGK,YAAab,EACbc,YAAab,EAGblK,cAAe,CAAC,CAAEgL,SAAU,GAAIjL,YAAa,GAAIkL,OAAQ,IACzDhL,cAAe,CAAC,CAAEiL,OAAQ,GAAIC,MAAO,EAAGC,OAAQ,EAAGC,QAAS,QAG9D,IACE,MAAMzF,EAAQC,aAAaC,QAAQ,SACnC,GAAImE,IAAoB9E,MAAMC,OAAO6E,IAAmB,CACtD,MAAM9G,EAAKZ,OAAO0H,GAClB3F,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAehD,IAAO,CAAEiD,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAChGmD,KAAK7C,IAAWA,GAAKA,EAAEzB,MACtB7C,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAACtC,GAAK+C,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAYpD,OAE/E8F,MAAM,OACX,CACA,GAAIiB,IAAoB/E,MAAMC,OAAO8E,IAAmB,CACtD,MAAMoB,EAAM/I,OAAO2H,GACnB5F,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAemF,IAAQ,CAAElF,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IACjGmD,KAAK7C,IAAWA,GAAKA,EAAEzB,MACtB7C,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAAC6F,GAAMpF,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAY+E,OAEhFrC,MAAM,OACX,CACF,CAAE,MAAOpG,GAAI,CACb7B,GAAQ,IAgI4CuK,GAAI,CAACC,GAAG,GAAGpC,SAAC,YAC1DK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAM3F,KAAYsH,GAAI,CAACC,GAAG,GAAGpC,SAAC,aAC/CK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC+B,MAAM,YAAY9B,QAAQ,WAAWC,QAASA,IAAMlG,GAAY,CAAC,GAAG0F,SAAC,0BAIhF3I,GAAUgJ,EAAAA,EAAAA,KAACiC,EAAAA,EAAgB,KAC1BxC,EAAAA,EAAAA,MAACyC,EAAAA,EAAK,CAAAvC,SAAA,EACJK,EAAAA,EAAAA,KAACmC,EAAAA,EAAS,CAAAxC,UACRF,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,KACVrC,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,aACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,cACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,mBACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,aACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,YACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,kBAGfF,EAAAA,EAAAA,MAAC6C,EAAAA,EAAS,CAAA3C,SAAA,CACP9I,EAAMgC,IAAI0J,IACT9C,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UAACK,EAAAA,EAAAA,KAACwC,EAAAA,EAAQ,CAACC,UAAWzI,GAASuI,EAAGG,oBAAqBC,SAAUA,KAAMC,OA/BzElJ,EA+BsF6I,EAAGG,mBA/B1EzI,GAAY+B,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAACtC,IAAMsC,EAAKtC,MAA3DA,YAgCRsG,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAE4C,EAAGM,2BACf7C,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAE4C,EAAG9G,uBAAyB8G,EAAGlM,cAAgBqF,MAAMC,OAAO4G,EAAGlM,cAAiB6B,EAAUY,OAAOyJ,EAAGlM,eAAiByC,OAAOyJ,EAAGlM,aAAiBkM,EAAGlM,aAAe,OAC9K2J,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UAAEmD,EAAAA,EAAAA,GAAqBP,EAAGrM,qBACpC8J,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAE4C,EAAGpM,SAAW,OAC1B6J,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAE4C,EAAGQ,gBAAkBR,EAAGhM,eAAiBgM,EAAGhM,cAAckD,OAAS8I,EAAGhM,cAAcyM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAE1B,SAAS,GAAG,GAAK,MACrJ/B,EAAAA,EAAAA,MAAC4C,EAAAA,EAAS,CAAA1C,SAAA,EACRK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC/D,KAAK,QAAQiE,QAASA,IA1J7BzF,iBACT4B,QAAQC,IAAI,CAACsC,KAAiBR,OACpC5G,EAAW8K,GACX1K,EAAmB0K,EAAGM,yBAA2B,IAGjD,MAAMM,EAAaZ,EAAG3B,aAAe2B,EAAG1B,iBAAmB0B,EAAGlB,aAAekB,EAAGa,oBAAsB,GAChGC,EAAad,EAAGzB,aAAeyB,EAAGxB,iBAAmBwB,EAAGjB,aAAeiB,EAAGe,oBAAsB,GAChGC,EAAgBJ,GAAezM,IAAUA,EAAckK,aAAgBlK,EAAcmK,kBAAqB,GAC1G2C,EAAgBH,GAAe3M,IAAUA,EAAcoK,aAAgBpK,EAAcqK,kBAAqB,GAEhHpJ,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACJsG,GAAE,IACLrM,iBAAkBqM,EAAGrM,kBAAmD,kBAAxBqM,EAAGrM,mBAAuE,IAAtCqM,EAAGrM,iBAAiBuN,QAAQ,KAAclB,EAAGrM,iBAAiByH,MAAM,EAAE,IAAM4E,EAAGrM,iBACnKK,cAAegM,EAAGhM,eAAiBgM,EAAGhM,cAAckD,OAAS8I,EAAGhM,cAAcsC,IAAK6K,IAAM,CAAQnC,SAAUmC,EAAGC,iBAAmB7K,OAAO4K,EAAGC,kBAAqBD,EAAGnC,UAAY,GAAKqC,WAAYF,EAAGG,eAAiBH,EAAGE,YAAc,GAAItN,YAAaoN,EAAGpN,aAAe,GAAIkL,OAAQkC,EAAGlC,QAAU,KAAQ,CAAC,CAAED,SAAU,GAAIjL,YAAa,GAAIkL,OAAQ,IACnVhL,cAAe+L,EAAG/L,eAAiB+L,EAAG/L,cAAciD,OAAS8I,EAAG/L,cAAgB,CAAC,CAAEiL,OAAQ,GAAIC,MAAO,EAAGC,OAAQ,EAAGC,QAAS,KAC7HP,YAAakC,EACbjC,YAAakC,KAGf,IACE,MAAMrH,EAAQC,aAAaC,QAAQ,SAC7ByH,EAAyB,GACzB7C,EAAMsC,GAAiB,GACvBrC,EAAMsC,GAAiB,GACvBO,EAAMxB,EAAGlM,aAAe,GAC1B4K,IAAQvF,MAAMC,OAAOsF,KAAO6C,EAAaE,KAAKlL,OAAOmI,IACrDC,IAAQxF,MAAMC,OAAOuF,KAAO4C,EAAaE,KAAKlL,OAAOoI,IACrD6C,IAAQrI,MAAMC,OAAOoI,KAAOD,EAAaE,KAAKlL,OAAOiL,IACrDD,EAAarK,cACT6C,QAAQC,IAAI5D,MAAM6D,KAAK,IAAIhB,IAAIsI,IAAejL,IAAI6B,UACtD,IACE,MAAM+B,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAehD,IAAO,CAAEiD,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAC/GM,GAAKA,EAAEzB,MAAM7C,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAACtC,GAAK+C,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAYpD,IACjG,CAAE,MAAON,GAAqC,IAGpD,CAAE,MAAOA,GAAI,CAEb7B,GAAQ,IAmH0C0M,CAAS1B,GAAKT,GAAI,CAACC,GAAG,GAAGpC,SAAC,UAC9DK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC/D,KAAK,QAAQ8F,MAAM,QAAQ7B,QAASA,KAAM+D,OArD3CxK,EAqDyD6I,EAAGG,mBArD3C7I,GAAYH,QAAKK,IAAe,GAAjDL,OAqDiFoI,GAAI,CAACC,GAAG,GAAGpC,SAAC,YACpGK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC/D,KAAK,QAAQiE,QAASzF,UAC5B,IAEE,IAAK1C,EAAgB,CACnB,MAAMyE,QAAU8B,EAAAA,EAAAA,GAAqB,uBAAwB,CAAEc,MAAO,aACtE,GAAI5C,EAAE+B,GAAI,CACR,MAAMe,QAAU9C,EAAEiC,OAClBzG,EAAkBsH,EACpB,CACF,CAIA,IAAI4E,EAAgB,KACpB,IACE,MAAMhI,EAAQC,aAAaC,QAAQ,SAC7BkE,QAAa1F,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,yBAAD2B,OAA0B6F,EAAGG,qBAAuB,CAAE/F,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAChJoE,GAAQA,EAAKvF,OAAMmJ,EAAW5D,EAAKvF,KACzC,CAAE,MAAO5B,GAEP+K,EAAW,IACb,CAGA,MAAMC,EAASD,GAAY5B,EAGrB8B,GAAmBD,EAAO5N,eAAiB,IAAIqC,IAAKyL,IACxD,MAAMC,GAAItI,EAAAA,EAAAA,GAAA,GAAQqI,GAClB,IAAKC,EAAKC,aAAc,CACtB,MAAMC,EAAMF,EAAK9C,QAAU8C,EAAKG,IAChC,QAAYhM,IAAR+L,GAA6B,OAARA,GAAgBrN,GAAQA,EAAKqC,OAAQ,CAC5D,MAAMkL,EAAQvN,EAAKwN,KAAM9G,GAAUhF,OAAOgF,EAAE2D,UAAY3I,OAAO2L,IAAQ3L,OAAOgF,EAAE2D,UAAY3I,OAAQyL,EAAK9C,QAAU,KAC/GkD,IAAOJ,EAAKC,aAAeG,EAAMH,cAAgBG,EAAMnH,MAAQ,GACrE,CACF,CACA,OAAO+G,IAGHM,GAAU5I,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQmI,GAAM,IAAE5N,cAAe6N,IAGzCS,EAAsC,CAAC,EAC7C,IACE,MAAMC,EAAStM,QAAqBC,IAARD,GAA6B,OAARA,EAAgBA,EAAM,GACjEuM,EAAUxM,GAAoBuM,EAAMF,EAAWjE,cAAgBmE,EAAMF,EAAWhE,kBAAoBkE,EAAMF,EAAWxD,cAAgB0D,EAAMF,EAAWzB,qBAAuB,IAC7K6B,EAAUzM,GAAoBuM,EAAMF,EAAW/D,cAAgBiE,EAAMF,EAAW9D,kBAAoBgE,EAAMF,EAAWvD,cAAgByD,EAAMF,EAAWvB,qBAAuB,IAC7K4B,EAAU1M,GAAoBuM,EAAMF,EAAWxO,cAAgB0O,EAAMF,EAAWM,qBAAuB,IACvG5J,EAAa,IAAIC,IACvB,IAAK,MAAM9B,IAAM,IAAIsL,KAAYC,KAAYC,GACvCxL,IAAOxB,EAAUY,OAAOY,KAAM6B,EAAWM,IAAI/C,OAAOY,IAE1D,GAAI6B,EAAWW,KAAM,CACnB,MAAMC,EAAQC,aAAaC,QAAQ,eAC7BC,QAAQC,IAAI5D,MAAM6D,KAAKjB,GAAY1C,IAAI6B,UAC3C,IACE,MAAM+B,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAehD,IAAO,CAAEiD,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAC/GM,GAAKA,EAAEzB,OAAM8J,EAAapL,GAAM+C,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAYpD,EAC7E,CAAE,MAAON,GACP,KAGA0C,OAAOC,KAAK+I,GAAcrL,QAAQtB,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAS8I,GAC5E,CACF,CAAE,MAAO1L,GAAiB,CAG1B,IAAKyL,EAAWO,iBAAkB,CAChC,MAAMC,EAAO7M,GAAoBqM,EAAWxO,aAAewO,EAAWM,oBAAsB,IACxFE,GAAQA,EAAK5L,OAAQoL,EAAWO,iBAAmBlN,EAAUmN,EAAK,KAAOP,EAAaO,EAAK,KAAOvM,OAAOuM,EAAK,IAC7GR,EAAWO,iBAAmBP,EAAWM,oBAAsB,EACtE,CACA,IAAKN,EAAWS,iBAAkB,CAChC,MAAMD,EAAO7M,GAAoBqM,EAAWjE,aAAeiE,EAAWhE,iBAAmBgE,EAAWxD,aAAewD,EAAWzB,oBAAsB,IAChJiC,GAAQA,EAAK5L,OAAQoL,EAAWS,iBAAmBpN,EAAUmN,EAAK,KAAOP,EAAaO,EAAK,KAAOvM,OAAOuM,EAAK,IAC7GR,EAAWS,iBAAmBT,EAAWhE,iBAAmBgE,EAAWzB,oBAAsB,EACpG,CACA,IAAKyB,EAAWU,iBAAkB,CAChC,MAAMF,EAAO7M,GAAoBqM,EAAW/D,aAAe+D,EAAW9D,iBAAmB8D,EAAWvD,aAAeuD,EAAWvB,oBAAsB,IAChJ+B,GAAQA,EAAK5L,OAAQoL,EAAWU,iBAAmBrN,EAAUmN,EAAK,KAAOP,EAAaO,EAAK,KAAOvM,OAAOuM,EAAK,IAC7GR,EAAWU,iBAAmBV,EAAW9D,iBAAmB8D,EAAWvB,oBAAsB,EACpG,CAIIc,GAAUA,EAAOoB,iBAAgBX,EAAWW,eAAiBpB,EAAOoB,gBACpEpB,GAAUA,EAAOqB,iBAAgBZ,EAAWY,eAAiBrB,EAAOqB,gBAExElN,GAAesM,EACjB,CAAE,MAAOzL,GAEP,IAAMb,GAAegK,EAAK,CAAE,MAAOmD,GAAMnN,GAAe,KAAO,CACjE,CACAF,GAAe,IACfsH,SAAC,iBAxGQ4C,EAAGG,qBA4GF,IAAjB7L,EAAM4C,SACLuG,EAAAA,EAAAA,KAACoC,EAAAA,EAAQ,CAAAzC,UAACK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACsD,QAAS,EAAEhG,SAAC,wCAQzCF,EAAAA,EAAAA,MAACmG,EAAAA,EAAM,CAACtO,KAAMA,EAAMuO,QAASA,IAAMtO,GAAQ,GAAQuO,WAAS,EAACC,SAAS,KAAIpG,SAAA,EACxEF,EAAAA,EAAAA,MAACuG,EAAAA,EAAW,CAAArG,SAAA,CAAEnI,EAAO,yBAAAkF,OAA4B9E,GAAoBJ,GAAWA,EAAQqL,yBAA4B,GAAE,2BAAAnG,OAA4B9E,EAAkB,eAAiBA,EAAkB,IAAM,KAAKoI,EAAAA,EAAAA,KAACiG,EAAAA,EAAU,CAAC,aAAW,QAAQ9F,QAASA,IAAM5I,GAAQ,GAAQuK,GAAI,CAACoE,SAAS,WAAYC,MAAM,EAAGC,IAAI,GAAGzG,UAACK,EAAAA,EAAAA,KAACqG,EAAAA,EAAS,UACrU5G,EAAAA,EAAAA,MAAC6G,EAAAA,EAAa,CAAA3G,SAAA,EAEZF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACjC,QAAQ,OAAQ0G,oBAAqB,UAAWC,IAAK,EAAGC,GAAG,GAAG9G,SAAA,EACtEK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACC,SAAU7O,EAAe8O,MAAM,mBAAmBC,KAAK,OAAOC,MAAOpP,EAAKxB,kBAAoB,GAAIyM,SAAUvJ,GAAKzB,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAExB,iBAAkBkD,EAAE2N,OAAOD,SAASE,gBAAiB,CAAEC,QAAQ,MAC7MxH,EAAAA,EAAAA,MAACyH,EAAAA,EAAW,CAAAvH,SAAA,EACVK,EAAAA,EAAAA,KAACmH,EAAAA,EAAU,CAACzN,GAAG,gBAAeiG,SAAC,aAC/BF,EAAAA,EAAAA,MAAC2H,EAAAA,EAAM,CAACC,QAAQ,gBAAgBP,MAAOpP,EAAKvB,SAAW,GAAIyQ,MAAM,UAAUjE,SAAUvJ,GAAKzB,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAEvB,QAASiD,EAAE2N,OAAOD,SAAQnH,SAAA,EACpIK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,GAAEnH,SAAC,0BACnBK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,gBAAenH,SAAC,mBAChCK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,sBAAqBnH,SAAC,yBACtCK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,uCAAsCnH,SAAC,0CACvDK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,cAAanH,SAAC,iBAC9BK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,gCAA+BnH,SAAC,mCAChDK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,iBAAgBnH,SAAC,6BAMvCF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGd,GAAG,GAAG9G,SAAA,EACpBK,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAAC0F,WAAW,IAAKf,GAAG,GAAG9G,SAAC,qBACjCF,EAAAA,EAAAA,MAACyC,EAAAA,EAAK,CAAChG,KAAK,QAAOyD,SAAA,EACjBK,EAAAA,EAAAA,KAACmC,EAAAA,EAAS,CAAAxC,UACRF,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,WACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,iBACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACoF,MAAM,QAAO9H,SAAC,mBACzBK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,UAGdrC,EAAAA,EAAAA,KAACsC,EAAAA,EAAS,CAAA3C,UACNjI,EAAKnB,eAAiB,IAAIsC,IAAI,CAAC6O,EAAUC,KACzClI,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACP,GAAI,CAAC8F,SAAS,KAAKjI,UAC5BF,EAAAA,EAAAA,MAAC2H,EAAAA,EAAM,CAACtB,WAAS,EAACgB,MAAOY,EAAKnG,UAAYmG,EAAKG,OAAS,GAAIlF,SAAUvJ,IAAM,IAAD0O,EACzE,MAAM1K,EAAIhE,EAAE2N,OAAOD,MAAavC,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAC7FgO,EAAKhO,cAAcoR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKhO,cAAcoR,IAAQ,CAAC,GAAG,CAAF,GAAGpG,SAAUnE,EAAGwG,YAA8D,QAAlDkE,EAAA5Q,EAAS0N,KAAK9G,GAAGhF,OAAOgF,EAAET,cAAcvE,OAAOsE,WAAG,IAAA0K,OAAA,EAAlDA,EAAoDvK,eAAgB,KAC7J5F,EAAQ4M,IACR5E,SAAA,EACAK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,GAAEnH,SAAC,uBAClBzI,EAAS2B,IAAIiF,IACZ2B,EAAAA,EAAAA,MAAC6H,EAAAA,EAAQ,CAAoBR,MAAOhO,OAAOgF,EAAET,YAAYsC,SAAA,CACtD7B,EAAEP,aACFO,EAAEL,aAAY,KAAAf,OAAQoB,EAAEL,aAAY,KAAM,KAF9BK,EAAET,mBAOvB2C,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACZ,WAAS,EAACgB,MAAOY,EAAKpR,aAAe,GAAIqM,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAAIgO,EAAKhO,cAAcoR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKhO,cAAcoR,IAAQ,CAAC,GAAG,CAAF,GAAGrR,YAAa8C,EAAE2N,OAAOD,QAASnP,EAAQ4M,SAErPvE,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACoF,MAAM,QAAO9H,UACtBK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACG,KAAK,SAASC,MAAOY,EAAKlG,QAAU,GAAImB,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAAIgO,EAAKhO,cAAcoR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKhO,cAAcoR,IAAQ,CAAC,GAAG,CAAF,GAAGnG,OAAQpI,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAUwD,WAAY,CAAEjG,GAAI,CAAEkG,UAAW,eAExRhI,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC+B,MAAM,QAAQ7B,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAAIgO,EAAKhO,cAAgBgO,EAAKhO,cAAcwC,OAAO,CAACkP,EAAMC,IAAWA,IAAIP,GAAMhQ,EAAQ4M,IAAS5E,SAAC,eAvBhMgI,UA6BrB3H,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,GAAG5H,UACdK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,KACf,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GACjB6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAC3CgO,EAAKhO,cAAcyN,KAAK,CAACzC,SAAS,GAAIjL,YAAY,GAAIkL,OAAO,IAC7D7J,EAAQ4M,IACR5E,SAAC,0BAELF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGS,UAAU,QAASR,WAAW,KAAK7H,SAAA,CAAC,6BAA2BjI,EAAKnB,eAAiB,IAAIyM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAE1B,SAAS,GAAI,UAI5J/B,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGd,GAAG,GAAG9G,SAAA,EACpBK,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAAC0F,WAAW,IAAKf,GAAG,GAAG9G,SAAC,mBACjCF,EAAAA,EAAAA,MAACyC,EAAAA,EAAK,CAAChG,KAAK,QAAOyD,SAAA,EACjBK,EAAAA,EAAAA,KAACmC,EAAAA,EAAS,CAAAxC,UACRF,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,SACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,WACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,YACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,aACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,UAGdrC,EAAAA,EAAAA,KAACsC,EAAAA,EAAS,CAAA3C,UACNjI,EAAKlB,eAAiB,IAAIqC,IAAI,CAAC6O,EAAUC,KACzClI,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACP,GAAI,CAAC8F,SAAS,KAAKjI,UAC5BF,EAAAA,EAAAA,MAAC2H,EAAAA,EAAM,CAACtB,WAAS,EAACgB,MAAOhO,OAAO4O,EAAKjG,QAAU,IAAKkB,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcmR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAK/N,cAAcmR,IAAQ,CAAC,GAAG,CAAF,GAAGlG,OAAQrI,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAS5E,SAAA,EACrPK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,GAAEnH,SAAC,qBAClBvI,EAAKyB,IAAKsP,IAAUnI,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAAgBR,MAAOhO,OAAOqP,EAAE1G,QAAQ9B,SAAEwI,EAAE3D,cAAgB2D,EAAE3K,MAAQ2K,EAAE1G,QAAlE0G,EAAE1G,eAG1CzB,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACZ,WAAS,EAACgB,MAAOY,EAAKhG,OAAS,GAAIiB,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcmR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAK/N,cAAcmR,IAAQ,CAAC,GAAG,CAAF,GAAGjG,MAAOtI,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAUwD,WAAY,CAAEjG,GAAI,CAAEkG,UAAW,eAElRhI,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACZ,WAAS,EAACgB,MAAOY,EAAK/F,QAAU,GAAIgB,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcmR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAK/N,cAAcmR,IAAQ,CAAC,GAAG,CAAF,GAAGhG,OAAQvI,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAUwD,WAAY,CAAEjG,GAAI,CAAEkG,UAAW,eAEpRhI,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACZ,WAAS,EAACgB,MAAOY,EAAK9F,SAAW,GAAIe,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcmR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAK/N,cAAcmR,IAAQ,CAAC,GAAG,CAAF,GAAG/F,QAASxI,EAAE2N,OAAOD,QAASnP,EAAQ4M,SAE7OvE,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC+B,MAAM,QAAQ7B,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAgB+N,EAAK/N,cAAcuC,OAAO,CAACkP,EAAMC,IAAWA,IAAIP,GAAMhQ,EAAQ4M,IAAS5E,SAAC,eAjBhMgI,UAuBrB3H,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,GAAG5H,UACdK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcwN,KAAK,CAACvC,OAAO,GAAIC,MAAM,EAAGC,OAAO,EAAGC,QAAQ,KAAMjK,EAAQ4M,IAAS5E,SAAC,0BAEzLF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGS,UAAU,SAASrI,SAAA,EACjCF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,gBAAoB,SAAOjI,EAAKlB,eAAiB,IAAIwM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAExB,QAAQ,GAAI,OAClHjC,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,iBAAqB,SAAOjI,EAAKlB,eAAiB,IAAIwM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAEvB,SAAS,GAAI,aAKxHlC,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGd,GAAG,GAAG9G,SAAA,EACpBK,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAAC0F,WAAW,IAAKf,GAAG,GAAG9G,SAAC,iBACjCF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACjC,QAAQ,OAAQ0G,oBAAqB,cAAeC,IAAI,GAAG7G,SAAA,EACjEK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACE,MAAM,cAAcE,MAAOvN,GAAoB7B,EAAKrB,aAAeqB,EAAKyN,qBAA0B,OAAJzO,QAAI,IAAJA,OAAI,EAAJA,EAAMsK,UAAUoH,UAAQ,KACjIpI,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACE,MAAM,cAAcE,MAAOvN,GAAoB7B,EAAK2J,aAAe3J,EAAK0L,oBAAuB1M,IAAUA,EAAckK,aAAgBlK,EAAcmK,kBAAoB8B,SAAUvJ,GAAKzB,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAE2J,YAAajI,EAAE2N,OAAOD,YAC3O9G,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACE,MAAM,cAAcE,MAAOvN,GAAoB7B,EAAK4J,aAAe5J,EAAK4L,oBAAuB5M,IAAUA,EAAcoK,aAAgBpK,EAAcqK,kBAAoB4B,SAAUvJ,GAAKzB,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAE4J,YAAalI,EAAE2N,OAAOD,qBAInPrH,EAAAA,EAAAA,MAAC4I,EAAAA,EAAa,CAAA1I,SAAA,EACZK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAM5I,GAAQ,GAAOoI,SAAC,YACvCK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASzF,UAEf,IAAKhD,EAAKvB,QAA8F,OAAnFkE,GAAY,uBAAwBE,GAAiB,cAAUJ,IAAa,GACjG,IAAKzC,EAAKnB,eAA+C,IAA9BmB,EAAKnB,cAAckD,OAAqH,OAArGY,GAAY,yCAA0CE,GAAiB,cAAUJ,IAAa,GAC5J,IAAKzC,EAAKlB,eAAiBkB,EAAKlB,cAAciD,OAAS,EAAkH,OAA7GY,GAAY,iDAAkDE,GAAiB,cAAUJ,IAAa,GAClK,IAAKzC,EAAK2J,cAAgB3J,EAAK4J,YAAyH,OAA1GjH,GAAY,8CAA+CE,GAAiB,cAAUJ,IAAa,GAIjJ,IAFoBzC,EAAKlB,eAAiB,IAAIwM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAExB,QAAQ,GAAI,MACzEhK,EAAKlB,eAAiB,IAAIwM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAEvB,SAAS,GAAI,GAC4C,OAA1GtH,GAAY,8CAA+CE,GAAiB,cAAUJ,IAAa,GAGrI,MAAMmO,GAAsB5Q,EAAKnB,eAAiB,IAAIsC,IAAKqK,IAAW,IAADqF,EACnE,MAAMC,EAAYtF,EAAE3B,UAAY2B,EAAES,kBAAoB,GAChD9D,EAAUqD,EAAEU,YAAcV,EAAEW,gBAAsF,QAAzE0E,EAAKrR,EAAS0N,KAAM9G,GAAUhF,OAAOgF,EAAET,cAAgBvE,OAAO0P,WAAW,IAAAD,OAAA,EAApEA,EAAsEhL,eAAiB,GAC3I,MAAO,CAAEoG,iBAAkB6E,EAAY7M,OAAO6M,GAAa,KAAM3E,cAAehE,EAASvJ,YAAa4M,EAAE5M,YAAakL,OAAQ7F,OAAOuH,EAAE1B,WAIlIiH,EAAsBhQ,IAC1B,QAAYC,IAARD,GAA6B,OAARA,GAAwB,KAARA,EAAY,MAAO,CAAEiB,GAAI,KAAMgP,OAAQ,MAChF,IAAKhN,MAAMC,OAAOlD,IAAO,MAAO,CAAEiB,GAAIiC,OAAOlD,GAAMiQ,OAAQ,MAE3D,IACE,MAAMzP,EAAIC,KAAKC,MAAMV,GACrB,GAAIE,MAAMC,QAAQK,IAAMA,EAAEQ,SAAWiC,MAAMC,OAAO1C,EAAE,KAAM,MAAO,CAAES,GAAIiC,OAAO1C,EAAE,IAAKyP,OAAQ,KAC/F,CAAE,MAAOtP,GAAI,CACb,MAAO,CAAEM,GAAI,KAAMgP,OAAQ5P,OAAOL,KAG9BkQ,EAAeF,EAAmB/Q,EAAK2J,aAAe3J,EAAK0L,oBAAsB,IACjFwF,EAAeH,EAAmB/Q,EAAK4J,aAAe5J,EAAK4L,oBAAsB,IAEjFuF,EAAU,CACd5S,OAAQyB,EAAKzB,QAAU,QACvBC,iBAAkBwB,EAAKxB,iBACvBC,QAASuB,EAAKvB,QACdC,aAAcsB,EAAKtB,cAAgB,OACnCC,aAAiB,OAAJK,QAAI,IAAJA,OAAI,EAAJA,EAAMsK,UAAW,KAC9B1K,YAAaoB,EAAKpB,aAAe,GACjCC,cAAe+R,EACf9R,eAAgBkB,EAAKlB,eAAiB,IAAIqC,IAAKqK,IAAK,CAAQzB,OAAQyB,EAAEzB,QAAU,KAAMC,MAAO/F,OAAOuH,EAAExB,QAAQ,EAAGC,OAAQhG,OAAOuH,EAAEvB,SAAS,EAAGC,QAASsB,EAAEtB,SAAW,MAEpKhB,YAAa+H,EAAajP,GAC1BmH,gBAAiB8H,EAAaD,OAC9B5H,YAAa8H,EAAalP,GAC1BqH,gBAAiB6H,EAAaF,QAEhC,IACE,MAAMvM,EAAQC,aAAaC,QAAQ,SACnC,GAAI7E,QACIqD,EAAAA,EAAMiO,KAAI/N,EAAAA,EAAAA,IAAS,yBAAD2B,OAA0BlF,EAAQkL,qBAAuBmG,EAAS,CAAElM,QAAS,CAAEC,cAAc,UAADF,OAAYP,MAChI9B,GAAY,2BAA4BE,GAAiB,WAAYJ,IAAa,GAAO5C,GAAQ,GAAQiD,SACpG,CACL,MAAM8D,QAAYzD,EAAAA,EAAMkO,MAAKhO,EAAAA,EAAAA,IAAS,yBAA0B8N,EAAS,CAAElM,QAAS,CAAEC,cAAc,UAADF,OAAYP,MACzG6M,EAAO1K,EAAItD,MAAQsD,EAAItD,KAAK6H,wBAA0BvE,EAAItD,KAAK6H,wBAA0B,KAC/FxI,GAAY2O,EAAI,4BAAAtM,OAA+BsM,EAAI,KAAM,2BAA4BzO,GAAiB,WAAYJ,IAAa,GAAO5C,GAAQ,GAAQiD,IACxJ,CACF,CAAE,MAAOS,GAAU,IAADgO,EAAAC,EAAE7O,IAAwB,QAAZ4O,EAAAhO,EAAIG,gBAAQ,IAAA6N,GAAM,QAANC,EAAZD,EAAcjO,YAAI,IAAAkO,OAAN,EAAZA,EAAoB/N,QAASF,EAAII,SAAW,eAAgBd,GAAiB,SAAUJ,IAAa,EAAO,GAC1I+F,QAAQ,YAAWP,SAAC,gBAK3BF,EAAAA,EAAAA,MAACmG,EAAAA,EAAM,CAACtO,KAAMc,EAAayN,QAASA,IAAMxN,GAAe,GAAQyN,WAAS,EAACC,SAAS,KAAIpG,SAAA,EACtFK,EAAAA,EAAAA,KAACgG,EAAAA,EAAW,CAAArG,SAAC,6BACbK,EAAAA,EAAAA,KAACsG,EAAAA,EAAa,CAAA3G,SACXrH,IACCmH,EAAAA,EAAAA,MAAA,OAAK/F,GAAG,gBAAgBkG,MAAO,CAACuJ,QAAQ,GAAIC,WAAY,oBAAqBpH,MAAO,QAAQrC,SAAA,EAC1FF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAQC,eAAe,gBAAiBC,WAAW,SAAUsJ,aAAa,IAAI1J,SAAA,EACjGF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC0J,SAAS,GAAI9B,WAAW,KAAK7H,UAAgB,OAAd3H,QAAc,IAAdA,OAAc,EAAdA,EAAgBuR,gBAA8B,OAAdvR,QAAc,IAAdA,OAAc,EAAdA,EAAgBwF,OAAQ,kBACpGwC,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC0J,SAAS,IAAI3J,UAAgB,OAAd3H,QAAc,IAAdA,OAAc,EAAdA,EAAgBwR,UAAW,SAEzDxJ,EAAAA,EAAAA,KAAA,OAAAL,SACiB,OAAd3H,QAAc,IAAdA,GAAAA,EAAgByR,MAAOzJ,EAAAA,EAAAA,KAAA,OAAK0J,IAAK1R,EAAeyR,KAAME,IAAI,OAAO/J,MAAO,CAACgK,OAAO,MAAU,WAG/F5J,EAAAA,EAAAA,KAAA,UACAP,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAQC,eAAe,gBAAiB+J,UAAU,IAAIlK,SAAA,EACzEF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,aAAiB,IAAErH,GAAYuK,4BAC5CpD,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,cAAkB,KAAEmD,EAAAA,EAAAA,GAAqBxK,GAAYpC,sBAClEuJ,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,aAAiB,IAAErH,GAAYnC,eAE9C6J,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACoI,UAAU,SAASrI,UAC9BF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,YAAgB,QAAMrH,GAAYyK,gBAAkBzK,GAAY/B,eAAiB+B,GAAY/B,cAAckD,OAASnB,GAAY/B,cAAcyM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAE1B,SAAS,GAAG,GAAK,YAGpN/B,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACiK,UAAU,IAAIlK,SAAA,EACzBK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,qBAC9BF,EAAAA,EAAAA,MAAA,SAAOG,MAAO,CAACkK,MAAM,OAAQC,eAAe,WAAYF,UAAU,GAAGlK,SAAA,EACnEK,EAAAA,EAAAA,KAAA,SAAAL,UACEF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAIK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,QAAQrI,SAAC,WAAUK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,QAAQrI,SAAC,iBAAgBK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,SAASrI,SAAC,iBAE3NK,EAAAA,EAAAA,KAAA,SAAAL,UACIrH,GAAY/B,eAAiB,IAAIsC,IAAI,CAACqK,EAAOgF,KAC7CzI,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAYK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,SAASxJ,SAAEuD,EAAEW,eAAiBX,EAAEU,YAAcV,EAAES,kBAAoB,OAAS3D,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,SAASxJ,SAAEuD,EAAE5M,aAAe,MAAQ0J,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,QAASnB,UAAU,SAASrI,SAAEhE,OAAOuH,EAAE1B,QAAQyI,QAAQ,OAAvO/B,aAKjBzI,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACiK,UAAU,IAAIlK,SAAA,EACzBK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,qBAC9BF,EAAAA,EAAAA,MAAA,SAAOG,MAAO,CAACkK,MAAM,OAAQC,eAAe,WAAYF,UAAU,GAAGlK,SAAA,EACnEK,EAAAA,EAAAA,KAAA,SAAAL,UACEF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAIK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,QAAQrI,SAAC,SAAQK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,SAASrI,SAAC,WAAUK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,SAASrI,SAAC,iBAEpNK,EAAAA,EAAAA,KAAA,SAAAL,UACIrH,GAAY9B,eAAiB,IAAIqC,IAAI,CAACyL,EAAO4D,KAC7CzI,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAYK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,SAASxJ,SAAE2E,EAAEE,cAAgBF,EAAE4F,UAAY,MAAQlK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,QAASnB,UAAU,SAASrI,SAAEhE,OAAO2I,EAAE5C,OAAO,GAAGuI,QAAQ,MAAQjK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,QAASnB,UAAU,SAASrI,SAAEhE,OAAO2I,EAAE3C,QAAQ,GAAGsI,QAAQ,OAA7O/B,aAKjBlI,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,IAAIlK,UACzBF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAQC,eAAe,iBAAiBH,SAAA,EAC3DF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACoI,UAAU,SAAU8B,MAAM,OAAOnK,SAAA,EAC5CK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,iBAC9BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,IAAIlK,SAAC,wBAC5BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,EAAGP,SAAS,IAAI3J,SAAErH,GAAY8M,kBAAoB7L,GAAoBjB,GAAYjC,aAAeiC,GAAY6M,oBAAsB,UAE5J1F,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACoI,UAAU,SAAU8B,MAAM,OAAOnK,SAAA,EAC5CK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,iBAC9BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,IAAIlK,SAAC,wBAC5BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,EAAGP,SAAS,IAAI3J,SAAErH,GAAYgN,kBAAoB/L,GAAoBjB,GAAY+I,aAAe/I,GAAY8K,oBAAsB,UAE5J3D,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACoI,UAAU,SAAU8B,MAAM,OAAOnK,SAAA,EAC5CK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,iBAC9BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,IAAIlK,SAAC,wBAC5BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,EAAGP,SAAS,IAAI3J,SAAErH,GAAYiN,kBAAoBhM,GAAoBjB,GAAYgJ,aAAehJ,GAAYgL,oBAAsB,kBAKhKtD,EAAAA,EAAAA,KAAA,OAAAL,SAAK,uBAEXF,EAAAA,EAAAA,MAAC4I,EAAAA,EAAa,CAAA1I,SAAA,EACZK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAM9H,GAAe,GAAOsH,SAAC,WAC9CK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAM7H,IAxdXoC,WAClB,GAAKyP,EACL,IACE,MAAMhO,EAAQC,aAAaC,QAAQ,SACjCM,EAAkC,CAAC,EACjCR,IAAOQ,EAAQC,cAAa,UAAAF,OAAaP,IACjD,MAAMoE,QAAahC,EAAAA,EAAAA,GAAqB,yBAAD7B,OAA0ByN,EAAI,QAAQ,CAAExN,YAC3E,IAAK4D,EAAK/B,GAAI,CACZ,MAAM4L,QAAY7J,EAAK8J,OACvB,IAAIC,EAAMF,EACV,IAAME,EAAMpR,KAAKC,MAAMiR,GAAKjP,OAASiP,CAAK,CAAE,MAAOhR,GAAKkR,EAAMF,CAAK,CAGnE,OAFA/P,GAAYiQ,GAAG,uBAAA5N,OAA2B6D,EAAKtK,SAC/CsE,GAAiB,cAAUJ,IAAa,EAE1C,CAEA,KADWoG,EAAK5D,QAAQ7B,IAAI,iBAAmB,IACvCyP,SAAS,mBAAoB,CACnC,MAAMH,QAAY7J,EAAK8J,OACvB,IAAIC,EAAMF,EACV,IAAME,EAAMpR,KAAKC,MAAMiR,GAAKjP,OAASiP,CAAK,CAAE,MAAOhR,GAAKkR,EAAMF,CAAK,CAEnE,OADA/P,GAAYiQ,GAAO,+BAAgC/P,GAAiB,cAAUJ,IAAa,EAE7F,CACA,MAAMqQ,QAAajK,EAAKiK,OAClBC,EAAMC,IAAIC,gBAAgBH,GAC1BI,EAAOrK,EAAK5D,QAAQ7B,IAAI,wBAA0B,GACxD,IAAI+P,EAAW,cACf,MAAMxR,EAAI,wBAAwByR,KAAKF,GACnCvR,GAAKA,EAAE,KAAIwR,EAAWxR,EAAE,IAC5B,MAAM8O,EAAI4C,SAASC,cAAc,KACjC7C,EAAE8C,KAAOR,EAAKtC,EAAE+C,SAAWL,EAAUE,SAASI,KAAKC,YAAYjD,GAAIA,EAAEkD,QAASlD,EAAEmD,SAChFZ,IAAIa,gBAAgBd,EACtB,CAAE,MAAOrR,GACPiB,IAAa,OAADjB,QAAC,IAADA,OAAC,EAADA,EAAGiC,UAAW,mBAAoBd,GAAiB,SAAUJ,IAAa,EACxF,GAsb4CqR,CAAYlT,GAAYoK,oBAAqBZ,GAAI,CAACC,GAAG,GAAGpC,SAAC,kBAC/FK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,KACf,MAAMsL,EAAKV,SAASW,eAAe,iBACnC,IAAKD,EAC4E,OAA/EpR,GAAY,oBAAqBE,GAAiB,aAASJ,IAAa,GAI1E,MAAMwR,EAAS,mRAAAjP,OAAsR+O,EAAGG,UAAS,0YAC3SC,EAAMC,OAAOxU,KAAK,GAAI,UAC5B,IAAKuU,EAEH,IAAK,IAADE,EACF,MAAMC,EAASjB,SAASC,cAAc,UACtCgB,EAAOpM,MAAMsG,SAAW,QAAS8F,EAAOpM,MAAMuG,MAAQ,IAAK6F,EAAOpM,MAAMqM,OAAS,IAAKD,EAAOpM,MAAMkK,MAAQ,IAAKkC,EAAOpM,MAAMgK,OAAS,IAAKoC,EAAOpM,MAAMsM,OAAS,IACjKnB,SAASI,KAAKC,YAAYY,GAC1B,MAAMG,EAA2B,QAAvBJ,EAAGC,EAAOI,qBAAa,IAAAL,OAAA,EAApBA,EAAsBhB,SACnC,IAAKoB,EAAM,MAAM,IAAI1N,MAAM,0BAC3B0N,EAAK7U,OACL6U,EAAKE,MAAMV,GACXQ,EAAKG,QACL,MAAMC,EAAWA,KACf,IAAK,IAADC,EAAAC,EAAsB,QAApBD,EAAAR,EAAOI,qBAAa,IAAAI,GAApBA,EAAsBpN,QAA6B,QAApBqN,EAAAT,EAAOI,qBAAa,IAAAK,GAApBA,EAAsBC,OAAS,CAAE,MAAOtT,GAAKvD,QAAQsF,MAAM,sBAAuB/B,GAAIiB,GAAY,0BAA2BE,GAAiB,SAAUJ,IAAa,EAAO,CACjN8E,WAAW,KAAQ,IAAM8L,SAASI,KAAKwB,YAAYX,EAAS,CAAE,MAAO5S,GAAI,GAAK,MAMhF,OAHA4S,EAAOY,OAASL,OAEhBtN,WAAWsN,EAAU,IAEvB,CAAE,MAAOnT,GAGP,OAFAvD,QAAQsF,MAAM,wBAAyB/B,GACvCiB,GAAY,wEAAyEE,GAAiB,cAAUJ,IAAa,EAE/H,CAEF0R,EAAId,SAASzT,OACbuU,EAAId,SAASsB,MAAMV,GACnBE,EAAId,SAASuB,SACZpM,QAAQ,YAAWP,SAAC,+BAI3BF,EAAAA,EAAAA,MAACmG,EAAAA,EAAM,CAACtO,KAAMwC,GAAa+L,QAASA,IAAM9L,IAAe,GAAO4F,SAAA,EAC9DK,EAAAA,EAAAA,KAACgG,EAAAA,EAAW,CAAArG,SAAC,oBACbK,EAAAA,EAAAA,KAACsG,EAAAA,EAAa,CAAA3G,SAAC,2DACfF,EAAAA,EAAAA,MAAC4I,EAAAA,EAAa,CAAA1I,SAAA,EACZK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAMpG,IAAe,GAAO4F,SAAC,YAC9CK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC+B,MAAM,QAAQ7B,QAhebzF,UACf,GAAgB,MAAZd,GACJ,IACE,MAAMuC,EAAQC,aAAaC,QAAQ,eACjCxB,EAAAA,EAAMgS,QAAO9R,EAAAA,EAAAA,IAAS,yBAAD2B,OAA0B9C,KAAa,CAAE+C,QAAS,CAAEC,cAAc,UAADF,OAAYP,MACpG9B,GAAY,WAAYE,GAAiB,WAAYJ,IAAa,GAClEJ,IAAe,GAAQF,GAAY,MACnCW,IACF,CAAE,MAAOpB,GAAQ,IAAD0T,EAAAC,EACd1S,IAAsB,QAAVyS,EAAA1T,EAAEgC,gBAAQ,IAAA0R,GAAM,QAANC,EAAVD,EAAY9R,YAAI,IAAA+R,OAAN,EAAVA,EAAkB5R,QAAS/B,EAAEiC,SAAW,iBAAkBd,GAAiB,SAAUJ,IAAa,EAChH,GAsd8CwF,SAAC,kBAI7CK,EAAAA,EAAAA,KAACgN,EAAAA,EAAQ,CAAC1V,KAAM4C,GAAW+S,iBAAkB,IAAMpH,QAASA,IAAM1L,IAAa,GAAOwF,UACpFK,EAAAA,EAAAA,KAACkN,EAAAA,EAAK,CAACC,SAAU7S,GAAewH,GAAI,CAAEgI,MAAO,QAASnK,SAAEvF,WCr5BjD,SAASgT,IACtB,MAAQpS,KAAMqS,EAAO,QAAErW,EAAO,MAAEmE,EAAK,SAAEX,GCAlC,SAAgB8S,GAAqD,IAAjD,SAAEC,EAAQ,YAAEC,EAAc,IAAoBF,EACvE,MAAOtS,EAAMyS,IAAW1W,EAAAA,EAAAA,UAAcyW,IAC/BxW,EAASC,IAAcF,EAAAA,EAAAA,WAAS,IAChCoE,EAAOuS,IAAY3W,EAAAA,EAAAA,UAAwB,MAElDlB,QAAQC,OAASD,QAAQC,MAAM,+BAAgCC,EAAAA,IAAqB,2BAEpF,MAAM4X,EAAWC,IAAe7S,EAAAA,EAAAA,IAAS6S,EAAGC,WAAW,KAAOD,EAAK,IAAMA,GAEnEpT,GAAWC,EAAAA,EAAAA,aAAYC,UAC3BzD,GAAW,GACXyW,EAAS,MACT,IACE,MAAMjD,EAAMkD,EAAQJ,GACdjP,QAAYzD,EAAAA,EAAMC,IAAI2P,GAC5BgD,EAAQnP,EAAItD,KACd,CAAE,MAAOC,GAAW,IAADC,EAAA4S,EACjBJ,GAAqB,QAAZxS,EAAAD,EAAIG,gBAAQ,IAAAF,GAAM,QAAN4S,EAAZ5S,EAAcF,YAAI,IAAA8S,OAAN,EAAZA,EAAoBzS,UAAWJ,EAAII,QAC9C,CAAC,QACCpE,GAAW,EACb,GACC,CAACsW,IAEE1R,GAAMpB,EAAAA,EAAAA,aAAYC,UACtBzD,GAAW,GACXyW,EAAS,MACT,IACE,MAAMjD,EAAMkD,EAAQJ,SACd1S,EAAAA,EAAMkO,KAAK0B,EAAKsD,SAChBvT,GACR,CAAE,MAAOS,GAAW,IAADgC,EAAA+Q,EACjBN,GAAqB,QAAZzQ,EAAAhC,EAAIG,gBAAQ,IAAA6B,GAAM,QAAN+Q,EAAZ/Q,EAAcjC,YAAI,IAAAgT,OAAN,EAAZA,EAAoB3S,UAAWJ,EAAII,QAC9C,CAAC,QACCpE,GAAW,EACb,GACC,CAACsW,EAAU/S,IAERyT,GAASxT,EAAAA,EAAAA,aAAYC,MAAOhB,EAAqBqU,KACrD9W,GAAW,GACXyW,EAAS,MACT,IACE,MAAMjD,EAAMkD,EAAQ,GAADjR,OAAI6Q,EAAQ,KAAA7Q,OAAIhD,UAC7BmB,EAAAA,EAAMiO,IAAI2B,EAAKsD,SACfvT,GACR,CAAE,MAAOS,GAAW,IAAD8C,EAAAmQ,EACjBR,GAAqB,QAAZ3P,EAAA9C,EAAIG,gBAAQ,IAAA2C,GAAM,QAANmQ,EAAZnQ,EAAc/C,YAAI,IAAAkT,OAAN,EAAZA,EAAoB7S,UAAWJ,EAAII,QAC9C,CAAC,QACCpE,GAAW,EACb,GACC,CAACsW,EAAU/S,IAER8Q,GAAS7Q,EAAAA,EAAAA,aAAYC,UACzBzD,GAAW,GACXyW,EAAS,MACT,IACE,MAAMjD,EAAMkD,EAAQ,GAADjR,OAAI6Q,EAAQ,KAAA7Q,OAAIhD,UAC7BmB,EAAAA,EAAMgS,OAAOpC,SACbjQ,GACR,CAAE,MAAOS,GAAW,IAAD8D,EAAAoP,EACjBT,GAAqB,QAAZ3O,EAAA9D,EAAIG,gBAAQ,IAAA2D,GAAM,QAANoP,EAAZpP,EAAc/D,YAAI,IAAAmT,OAAN,EAAZA,EAAoB9S,UAAWJ,EAAII,QAC9C,CAAC,QACCpE,GAAW,EACb,GACC,CAACsW,EAAU/S,IAEd,MAAO,CACLQ,OACAhE,UACAmE,QACAX,WACAqB,MACAoS,SACA3C,SACAmC,UAEJ,CD3EsDW,CAAa,CAAEb,SAAU,+BACtEc,EAAUC,IAAevX,EAAAA,EAAAA,UAAS,CAAC,IACnCwX,EAAQC,IAAazX,EAAAA,EAAAA,UAAgB,KACrCiD,EAAUC,IAAelD,EAAAA,EAAAA,UAAkC,CAAC,IAC5D0X,EAAUC,IAAe3X,EAAAA,EAAAA,WAAS,IAEzC4X,EAAAA,EAAAA,WAAU,KAEV9T,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,0BAA0BuE,KAAK7C,GAAK+R,EAAU/R,EAAEzB,OAAOwE,MAAM,SAC7E,IAEHR,EAAAA,UAAgB,KAAQxE,KAAe,CAACA,IAGxC,MAAON,EAAWC,IAAgBpD,EAAAA,EAAAA,WAAS,IACpCqD,EAAUC,IAAetD,EAAAA,EAAAA,UAAS,KAClCuD,EAAeC,IAAoBxD,EAAAA,EAAAA,UAAmC,SACtE6X,EAAiBC,IAAsB9X,EAAAA,EAAAA,WAAS,IAChD+X,EAAeC,IAAoBhY,EAAAA,EAAAA,UAAc,OACjDiY,EAAaC,IAAkBlY,EAAAA,EAAAA,UAAc,OAC7CmY,EAAYC,IAAiBpY,EAAAA,EAAAA,WAAS,IACtCqY,EAAYC,IAAiBtY,EAAAA,EAAAA,WAAS,GAE7C,OAAIC,GAAgBgJ,EAAAA,EAAAA,KAAA,OAAAL,SAAK,eACrBxE,GAAc6E,EAAAA,EAAAA,KAAA,OAAAL,SAAK,2BAGrBF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,0BACJK,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAM3F,IAAWmF,SAAC,aACnCF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAO2G,IAAK,QAAQ7G,SAAA,EACvCF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAC0P,KAAK,GAAG3P,SAAA,EACnBK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,gCACJF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEK,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAMlG,EAAY,CAAC,GAAG0F,SAAC,WACxCK,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAMtF,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,0BAA0BuE,KAAK7C,GAAK+R,EAAU/R,EAAEzB,OAAOwE,MAAM,QAAUG,SAAC,gBAEpHK,EAAAA,EAAAA,KAAA,MAAAL,SACG4O,EAAO1V,IAAI0J,IACV9C,EAAAA,EAAAA,MAAA,MAAgCG,MAAO,CAACC,QAAQ,OAAOE,WAAW,SAASyG,IAAI,UAAU7G,SAAA,EACvFK,EAAAA,EAAAA,KAAA,SAAO6G,KAAK,WAAWpE,UAAWzI,EAASuI,EAAGG,oBAAqBC,SAAUA,IAAM1I,EAAY+B,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAOD,GAAI,IAAC,CAACuG,EAAGG,qBAAsB1G,EAAKuG,EAAGG,0BACjJjD,EAAAA,EAAAA,MAAA,OAAAE,SAAA,CAAM4C,EAAGM,wBAAwB,WAAIN,EAAGqB,YAAerB,EAAGhM,eAAiBgM,EAAGhM,cAAc,KAAOgM,EAAGhM,cAAc,GAAGsN,eAAiBtB,EAAGhM,cAAc,GAAGoN,mBAAsB,GAAG,WAAIpB,EAAGQ,gBAAkBR,EAAGhM,eAAiBgM,EAAGhM,cAAckD,OAAS8I,EAAGhM,cAAcyM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAE1B,SAAS,GAAG,GAAK,QAF3Te,EAAGG,wBAMhB1C,EAAAA,EAAAA,KAAA,OAAAL,UACEK,EAAAA,EAAAA,KAAA,UAAQoI,SAAUqG,EAAUtO,QAASzF,UACnC,MAAMlB,EAAMsC,OAAOC,KAAK/B,GAAUjB,OAAOwW,GAAGvV,GAAUuV,IAAI1W,IAAI0W,IAAIA,GAClE,GAAmB,IAAf/V,EAAIC,OAIN,OAHAY,EAAY,0BACZE,EAAiB,aACjBJ,GAAa,GAGf,MAAM4I,EAAgBwL,EAAOxV,OAAOE,GAAKO,EAAI+Q,SAAStR,EAAEyJ,qBAAqBM,OAAO,CAACC,EAAGhK,IAAMgK,GAAKtH,OAAO1C,EAAE8J,iBAAmB9J,EAAE1C,eAAiB0C,EAAE1C,cAAckD,OAASR,EAAE1C,cAAcyM,OAAO,CAACwM,EAAOtM,IAAQsM,GAAM7T,OAAOuH,EAAE1B,SAAS,GAAG,GAAK,IAAK,GACvPkN,GAAY,GACZ,IACE,MAAMvS,EAAQC,aAAaC,QAAQ,eAC7BxB,EAAAA,EAAMkO,MAAKhO,EAAAA,EAAAA,IAAS,6BAA8B,CACtD9E,OAAQ,QACRwZ,mBAAmB,IAAItO,MAAOC,cAAczD,MAAM,EAAE,IACpDxH,QAAS,uBACT4M,gBACA3M,aAAc,OACdsZ,YAAalW,GACZ,CAAEmD,QAAS,CAAEC,cAAc,UAADF,OAAYP,MACzC9B,EAAY,+BACZE,EAAiB,WACjBJ,GAAa,GACbK,IACAP,EAAY,CAAC,EACf,CAAE,MAAOb,GAAQ,IAADwE,EAAA+R,EACdtV,GAAsB,QAAVuD,EAAAxE,EAAEgC,gBAAQ,IAAAwC,GAAM,QAAN+R,EAAV/R,EAAY5C,YAAI,IAAA2U,OAAN,EAAVA,EAAkBxU,QAAS/B,EAAEiC,SAAW,iBACpDd,EAAiB,SACjBJ,GAAa,EACf,CAAC,QAAWuU,GAAY,EAAQ,GAChC/O,SAAE8O,GAAWhP,EAAAA,EAAAA,MAAAmQ,EAAAA,SAAA,CAAAjQ,SAAA,EAAEK,EAAAA,EAAAA,KAACiC,EAAAA,EAAgB,CAAC/F,KAAM,KAAM,kBAAkB,kCAGrEuD,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAC0P,KAAK,GAAG3P,SAAA,EACnBK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,0BACJK,EAAAA,EAAAA,KAAA,UAAQG,QAASA,IAAM3F,IAAWmF,SAAC,aACnCK,EAAAA,EAAAA,KAAA,MAAAL,SACG0N,GAAWA,EAAQxU,IAAK4D,IAC3BgD,EAAAA,EAAAA,MAAA,MAAmCG,MAAO,CAACyJ,aAAc,QAAQ1J,SAAA,EAC/DF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAOC,eAAe,iBAAiBH,SAAA,EAC1DF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEK,EAAAA,EAAAA,KAAA,UAAAL,SAASlD,EAAEoT,kCAAyC,YAAI/M,EAAAA,EAAAA,GAAqBrG,EAAEgT,mBAAmB,WAAIhT,EAAExG,WAE1GwJ,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACIF,EAAAA,EAAAA,MAAA,UAAQU,QAASA,IAAMmO,EAAYtS,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASD,GAAI,IAAE,CAACS,EAAEqT,yBAA0B9T,EAAKS,EAAEqT,2BAA2BnQ,SAAA,CAClH0O,EAAS5R,EAAEqT,wBAA0B,OAAS,OAAO,gBAExD9P,EAAAA,EAAAA,KAAA,UAAQJ,MAAO,CAACmQ,WAAW,GAAI5P,QAASzF,UAEtC,IACE,MAAM4D,QAAYzD,EAAAA,EAAMC,IAAI,6BAAD4B,OAA8BD,EAAEqT,yBAC3Df,EAAiBzQ,EAAItD,MAErB,MAAMgV,QAAiBnV,EAAAA,EAAMkO,KAAK,6BAADrM,OAA8BD,EAAEqT,uBAAsB,WAAW,CAAEG,SAAS,GAAS,CAAEtT,QAAS,CAAEC,cAAc,UAADF,OAAYN,aAAaC,QAAQ,aAAgBiD,KAAK4Q,GAAKA,EAAElV,MAC7MiU,EAAee,EAASG,SAAW,MACnCtB,GAAmB,EACrB,CAAE,MAAOzV,GAAQ,IAAD0F,EAAAsR,EACd/V,GAAsB,QAAVyE,EAAA1F,EAAEgC,gBAAQ,IAAA0D,GAAM,QAANsR,EAAVtR,EAAY9D,YAAI,IAAAoV,OAAN,EAAVA,EAAkBjV,QAAS/B,EAAEiC,SAAW,0BACpDd,EAAiB,SACjBJ,GAAa,EACf,GACAwF,SAAC,8BAGR0O,EAAS5R,EAAEqT,0BACV9P,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACyQ,YAAa,OAAQxG,UAAW,UAAUlK,SACpDlD,EAAE6T,UAAY7T,EAAE6T,SAAS7W,OAAS,GACjCgG,EAAAA,EAAAA,MAAA,SAAOG,MAAO,CAACkK,MAAM,OAAOC,eAAe,YAAYpK,SAAA,EACrDK,EAAAA,EAAAA,KAAA,SAAAL,UACEF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAIK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,aAAYK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,WAAUK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,YAAWK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,eAEvDK,EAAAA,EAAAA,KAAA,SAAAL,SACGlD,EAAE6T,SAASzX,IAAKuE,IACfqC,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EACEK,EAAAA,EAAAA,KAAA,MAAAL,SAAKvC,EAAEyF,2BACP7C,EAAAA,EAAAA,KAAA,MAAAL,SAAKvC,EAAEwG,YAAexG,EAAE7G,eAAiB6G,EAAE7G,cAAc,KAAO6G,EAAE7G,cAAc,GAAGsN,eAAiBzG,EAAE7G,cAAc,GAAGoN,mBAAsB,MAC7I3D,EAAAA,EAAAA,KAAA,MAAAL,SAAKvC,EAAE2F,gBAAkB3F,EAAE7G,eAAiB6G,EAAE7G,cAAckD,OAAS2D,EAAE7G,cAAcyM,OAAO,CAACwM,EAAOtM,IAAQsM,GAAM7T,OAAOuH,EAAE1B,SAAS,GAAG,GAAK,MAC5IxB,EAAAA,EAAAA,KAAA,MAAAL,UAAKmD,EAAAA,EAAAA,GAAqB1F,EAAElH,sBAJrBkH,EAAEsF,2BASf1C,EAAAA,EAAAA,KAAA,OAAAL,SAAK,oBA5CNlD,EAAEqT,kCAoDf9P,EAAAA,EAAAA,KAACgN,EAAAA,EAAQ,CAAC1V,KAAM4C,EAAW+S,iBAAkB,IAAMpH,QAASA,IAAM1L,GAAa,GAAOwF,UACpFK,EAAAA,EAAAA,KAACkN,EAAAA,EAAK,CAACC,SAAU7S,EAAewH,GAAI,CAAEgI,MAAO,QAASnK,SAAEvF,OAE1DqF,EAAAA,EAAAA,MAACmG,EAAAA,EAAM,CAACtO,KAAMsX,EAAiB/I,QAASA,IAAMgJ,GAAmB,GAAQ9I,SAAS,KAAKD,WAAS,EAAAnG,SAAA,EAC9FK,EAAAA,EAAAA,KAACgG,EAAAA,EAAW,CAAArG,SAAC,6CACbK,EAAAA,EAAAA,KAACsG,EAAAA,EAAa,CAAA3G,SACXqP,GACCvP,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,cAAkB,IAAEqP,EAAYuB,SAAYvB,EAAYuB,SAAS7W,IAAMsV,EAAYuB,SAAS7H,OAAU,WACnHjJ,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,cAAkB,IAAEqP,EAAYwB,SAAYxB,EAAYwB,SAAS9W,IAAMsV,EAAYwB,SAAS9H,OAAU,WACnH1I,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,GAAGlK,UACxBF,EAAAA,EAAAA,MAAA,SAAAE,SAAA,EAAOK,EAAAA,EAAAA,KAAA,SAAO6G,KAAK,WAAWpE,QAAS2M,EAAYzM,SAAWvJ,GAAMiW,EAAcjW,EAAE2N,OAAOtE,WAAY,gDAExGuM,EAAYyB,OAASzB,EAAYyB,MAAMhX,OAAS,IAC/CgG,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACiK,UAAU,GAAGlK,SAAA,EAACK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,YAAeK,EAAAA,EAAAA,KAAA,MAAAL,SAAKqP,EAAYyB,MAAM5X,IAAI,CAAC6X,EAAMxI,KAAYlI,EAAAA,EAAAA,KAAA,MAAAL,SAAa+Q,GAAJxI,aAG3GlI,EAAAA,EAAAA,KAAA,OAAAL,SAAK,+BAEXF,EAAAA,EAAAA,MAAC4I,EAAAA,EAAa,CAAA1I,SAAA,EACZK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAM0O,GAAmB,GAAOlP,SAAC,YAClDK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC+B,MAAM,UAAU9B,QAAQ,YAAYkI,SAAU8G,EAAY/O,QAASzF,UACzE,GAAKoU,EAAL,CACAK,GAAc,GACd,IACE,MAAM7Q,QAAYzD,EAAAA,EAAMkO,KAAK,6BAADrM,OAA8BoS,EAAcgB,uBAAsB,WAAW,CAAEG,QAASb,GAAc,CAAEzS,QAAS,CAAEC,cAAc,UAADF,OAAYN,aAAaC,QAAQ,aAC7LhC,EAAYiE,EAAItD,KAAKK,SAAW,aAChCd,EAAiB,WACjBJ,GAAa,GACb0U,GAAmB,GACnBrU,GACF,CAAE,MAAOpB,GAAQ,IAADiH,EAAAsQ,EACdtW,GAAsB,QAAVgG,EAAAjH,EAAEgC,gBAAQ,IAAAiF,GAAM,QAANsQ,EAAVtQ,EAAYrF,YAAI,IAAA2V,OAAN,EAAVA,EAAkBxV,QAAS/B,EAAEiC,SAAW,iBACpDd,EAAiB,SACjBJ,GAAa,EACf,CAAC,QAAWgV,GAAc,EAAQ,CAbR,GAc1BxP,SAAC,mBAKb,CApLA9J,QAAQC,OAASD,QAAQC,MAAM,2CAA4CC,EAAAA,IAAqB,2B,4CEIhG,MAirBA,EA9qBgC6a,KAC9B,MAAO/Z,EAAOC,IAAYC,EAAAA,EAAAA,UAAgB,KAEnCG,EAAUC,IAAeJ,EAAAA,EAAAA,UAAgB,KACzCK,EAAMC,IAAWN,EAAAA,EAAAA,UAAgB,KAGjCO,EAAMC,IAAWR,EAAAA,EAAAA,WAAS,IAC1BS,EAASC,IAAcV,EAAAA,EAAAA,UAAqB,OAC5CW,EAAMC,IAAWZ,EAAAA,EAAAA,UAAc,CAAC,GACjCe,GAAgBC,EAAAA,EAAAA,QAAgC,OAC/CmC,EAAWC,IAAgBpD,EAAAA,EAAAA,WAAS,IACpCqD,EAAUC,IAAetD,EAAAA,EAAAA,UAAS,KAClCuD,EAAeC,IAAoBxD,EAAAA,EAAAA,UAAmC,SACtEmB,EAAWC,IAAgBpB,EAAAA,EAAAA,UAAgC,CAAC,IAC5D8Z,EAAaC,IAAkB/Z,EAAAA,EAAAA,UAAuE,IAEvGga,EAAYrW,UAChB,IACE,MAAM+B,QAAU8B,EAAAA,EAAAA,GAAqB,uBACjC9B,EAAE+B,GAAI1H,QAAe2F,EAAEiC,QACtB5H,EAAS,GAChB,CAAE,MAAOmR,GAAKnR,EAAS,GAAK,IAG9B6X,EAAAA,EAAAA,WAAU,KAAQoC,KAAgB,IAElC,MAAMlS,EAAgBnE,UACpB,IACE,MAAM+B,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,kBAEnC,OADA5D,EAAYwB,MAAMC,QAAQ6D,EAAEzB,MAAQyB,EAAEzB,KAAO,IACtCyB,EAAEzB,IACX,CAAE,MAAO5B,GAAsB,OAAjBjC,EAAY,IAAY,EAAG,GAErCkH,GAAY3D,UAChB,IAAM,MAAM+B,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,wBAAmE,OAA1C1D,EAAQsB,MAAMC,QAAQ6D,EAAEzB,MAAMyB,EAAEzB,KAAK,IAAYyB,EAAEzB,IAAM,CAAE,MAAO5B,GAAkB,OAAb/B,EAAQ,IAAY,EAAI,GAG7J2Z,GAAmBtW,UACvB,IACE,MAAM+B,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,sBACnC+V,EAAenY,MAAMC,QAAQ6D,EAAEzB,MAAQyB,EAAEzB,KAAO,IAEhD,MAAMnC,EAA6B,CAAC,EACpC,IAAK,MAAMoY,KAAMxU,EAAEzB,MAAM,GAAWiW,GAAKA,EAAEjQ,UAASnI,EAAIC,OAAOmY,EAAEjQ,UAAYiQ,EAAEpU,WAAaoU,EAAEnU,UAAYhE,OAAOmY,EAAEjQ,UAEnH,OADA7I,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUpD,GAAQmD,IAC5BS,EAAEzB,IACX,CAAE,MAAO5B,GAAK,MAAO,EAAI,GAiGrBZ,GAAuBC,IAC3B,QAAYC,IAARD,GAA6B,OAARA,GAAwB,KAARA,EAAY,MAAO,GAC5D,GAAIE,MAAMC,QAAQH,GAAM,OAAOA,EAAII,IAAIC,QAAQC,OAAOC,SACtD,GAAmB,kBAARP,EAAkB,MAAO,CAACK,OAAOL,IAC5C,GAAmB,kBAARA,EAAkB,CAC3B,IACE,MAAMQ,EAAIC,KAAKC,MAAMV,GACrB,GAAIE,MAAMC,QAAQK,GAAI,OAAOA,EAAEJ,IAAIC,QAAQC,OAAOC,SAClD,GAAiB,kBAANC,GAA+B,kBAANA,EAAgB,MAAO,CAACH,OAAOG,GACrE,CAAE,MAAOG,GAAI,CACb,MAAMC,EAAIZ,EAAIa,MAAM,OACpB,OAAID,EAAU,CAACA,EAAE,IACV,EACT,CACA,MAAO,IAGHE,GAAuBd,IAC3B,MAAMe,EAAMhB,GAAoBC,GAChC,OAAIe,EAAIC,OAAeD,EAAIX,IAAIa,GAAMxB,EAAUY,OAAOY,KAAQZ,OAAOY,IAAKC,KAAK,MAC3ElB,GAAsB,kBAARA,EAAyBA,EACpC,IAGHyY,GAAYA,KAAQvZ,EAAQ,CAAC,GAAIF,EAAW,MAAOF,GAAQ,KAmE1Da,GAAaC,KAAkBtB,EAAAA,EAAAA,WAAS,IACxCuB,GAAaC,KAAkBxB,EAAAA,EAAAA,UAAqB,MA+B3D,OACE0I,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAAAC,SAAA,EACFF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAOC,eAAe,gBAAgBC,WAAW,UAAUJ,SAAA,EAC9EK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,oBACJF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACC,QAAQ,YAAYC,QA9NpBzF,gBACR4B,QAAQC,IAAI,CAACsC,IAAiBR,KAAa2S,OACjDvZ,EAAW,MAEX,IAAI0Z,EAA+B,KAC/BC,EAAmB,KACnBC,EAAmB,KACvB,IACE,MAAMlV,EAAQC,aAAaC,QAAQ,SAC7BiV,QAAezW,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,gBAAiB,CAAE4B,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IACpH,GAAImV,GAAUA,EAAOtW,MAAQsW,EAAOtW,KAAKgG,QAAS,CAChDmQ,EAAgBG,EAAOtW,KAAKgG,QAC5B7I,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAAClD,OAAOwY,EAAOtW,KAAKgG,UAAWsQ,EAAOtW,KAAK6B,WAAayU,EAAOtW,KAAK8B,UAAYhE,OAAOwY,EAAOtW,KAAKgG,YAEhIsQ,EAAOtW,KAAK4F,YAAawQ,EAAcE,EAAOtW,KAAK4F,YAAsB0Q,EAAOtW,KAAK6F,kBAAiBuQ,EAAcE,EAAOtW,KAAK6F,iBAChIyQ,EAAOtW,KAAK8F,YAAauQ,EAAcC,EAAOtW,KAAK8F,YAAsBwQ,EAAOtW,KAAK+F,kBAAiBsQ,EAAcC,EAAOtW,KAAK+F,iBAEpI,IACE,MAAM+C,EAAyB,GAC3BsN,IAAgB1V,MAAMC,OAAOyV,KAAetN,EAAaE,KAAKlL,OAAOsY,IACrEC,IAAgB3V,MAAMC,OAAO0V,KAAevN,EAAaE,KAAKlL,OAAOuY,IACzE,IAAK,MAAM3X,KAAMf,MAAM6D,KAAK,IAAIhB,IAAIsI,IAClC,IAAK5L,EAAUwB,GACb,IACE,MAAM+C,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAehD,IAAO,CAAEiD,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAC/GM,GAAKA,EAAEzB,MAAM7C,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAACtC,GAAK+C,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAYpD,IACjG,CAAE,MAAON,GAAiB,CAGhC,CAAE,MAAO6O,GAAI,CACf,CACF,CAAE,MAAO7O,GAAI,CACbzB,EAAQ,CACN4Z,eAAe,IAAIpQ,MAAOC,cAAczD,MAAM,EAAE,IAChDxH,QAAS,GACTI,cAAe,CAxFI,CAAsBoN,iBAAkB,KAAME,cAAe,GAAIvN,YAAa,GAAIkL,OAAQ,IAyF7GhL,cAAe,CAxFI,CAAsBiL,OAAQ,GAAIC,MAAO,EAAGC,OAAQ,EAAGC,QAAS,IAAhE,CAAsBH,OAAQ,GAAIC,MAAO,EAAGC,OAAQ,EAAGC,QAAS,KA0FnF4P,KAAM,SACNC,YAAa,GACbpb,YAAa8a,EACb9P,YAAa+P,EACb9P,YAAa+P,EACbjb,aAAc,OACdH,OAAQ,UAEVsB,GAAQ,GACR0H,WAAW,KAAM,IAAK,IAADC,EAAuB,QAArBA,EAAApH,EAAcqH,eAAO,IAAAD,GAArBA,EAAuBE,OAAS,CAAE,MAAMhG,GAAG,GAAK,IA+KnB0I,GAAI,CAACC,GAAG,GAAGpC,SAAC,YAC1DK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAM4Q,IAAajP,GAAI,CAACC,GAAG,GAAGpC,SAAC,mBAIpDK,EAAAA,EAAAA,KAAC0R,EAAAA,GAAI,CAACC,WAAS,EAACC,QAAS,EAAEjS,UACzBK,EAAAA,EAAAA,KAAC0R,EAAAA,GAAI,CAAC3D,MAAI,EAAC8D,GAAI,GAAIC,GAAI,EAAEnS,UACvBF,EAAAA,EAAAA,MAACsS,EAAAA,EAAK,CAACjQ,GAAI,CAAE7I,EAAG,GAAI0G,SAAA,EAClBK,EAAAA,EAAAA,KAACgS,EAAAA,EAAU,CAAC9R,QAAQ,KAAIP,SAAC,6BACzBK,EAAAA,EAAAA,KAACiS,EAAAA,EAAO,CAACnQ,GAAI,CAAEoQ,GAAI,MACnBlS,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAAAC,UACFF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,CACG9I,EAAMgC,IAAIsZ,IACT1S,EAAAA,EAAAA,MAAA,MAA8BG,MAAO,CAACyJ,aAAa,GAAG1J,SAAA,EACpDK,EAAAA,EAAAA,KAAA,UAAAL,SAASwS,EAAGC,wBAA+B,WAAID,EAAGE,aAAgBF,EAAG5b,eAAiB4b,EAAG5b,cAAc,KAAO4b,EAAG5b,cAAc,GAAGsN,eAAiBsO,EAAG5b,cAAc,GAAGqN,aAAgB,GAAG,eAAQuO,EAAGG,eAAiBH,EAAG5b,eAAiB4b,EAAG5b,cAAckD,OAAS0Y,EAAG5b,cAAcyM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAE1B,SAAS,GAAG,GAAK,IAC1U/B,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACiK,UAAU,GAAGlK,SAAA,EACxBK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC/D,KAAK,QAAQiE,QAASA,IA5LjCzF,WAAmB,IAAD4S,EAAAiF,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,QAC3B7W,QAAQC,IAAI,CAACsC,IAAiBR,KAAa2S,OACjDvZ,EAAW0a,GAEX,IAAIzR,EAAU,KACd,IACE,MAAMvE,EAAQC,aAAaC,QAAQ,SAC7BiV,QAAezW,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,gBAAiB,CAAE4B,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAChHmV,GAAUA,EAAOtW,OAAM0F,EAAK4Q,EAAOtW,KACzC,CAAE,MAAOiN,GAAI,CAEb,MAAM1E,EAAwG,QAA3F+J,EAAmF,QAAnFiF,EAA0D,QAA1DC,EAAoC,QAApCC,EAAkB,QAAlBC,EAAIP,EAAGvR,mBAAW,IAAA8R,EAAAA,EAAIP,EAAG9Q,mBAAW,IAAAoR,EAAAA,EAAIN,EAAGtR,uBAAe,IAAA2R,EAAAA,EAAIL,EAAG/O,0BAAkB,IAAAmP,EAAAA,EAAI,YAAI,IAAAjF,EAAAA,EAAK,KAC7G9J,EAAwG,QAA3FmP,EAAmF,QAAnFC,EAA0D,QAA1DC,EAAoC,QAApCC,EAAkB,QAAlBC,EAAIZ,EAAGrR,mBAAW,IAAAiS,EAAAA,EAAIZ,EAAG7Q,mBAAW,IAAAwR,EAAAA,EAAIX,EAAGpR,uBAAe,IAAA8R,EAAAA,EAAIV,EAAG7O,0BAAkB,IAAAsP,EAAAA,EAAI,YAAI,IAAAD,EAAAA,EAAK,KAC7GS,EAAoC,MAAjB7P,GAA2C,KAAlBA,EAAuBA,EAAiB7C,GAA0C,QAAxCsS,EAAkB,QAAlBC,EAAIvS,EAAGE,mBAAW,IAAAqS,EAAAA,EAAIvS,EAAGG,uBAAe,IAAAmS,EAAAA,EAAY,KAC1IK,EAAoC,MAAjB7P,GAA2C,KAAlBA,EAAuBA,EAAiB9C,GAA0C,QAAxCwS,EAAkB,QAAlBC,EAAIzS,EAAGI,mBAAW,IAAAqS,EAAAA,EAAIzS,EAAGK,uBAAe,IAAAmS,EAAAA,EAAY,KAEhJvb,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACJkW,GAAE,IACLZ,cAAeY,EAAGZ,eAA6C,kBAArBY,EAAGZ,gBAAiE,IAAnCY,EAAGZ,cAAc9N,QAAQ,KAAc0O,EAAGZ,cAAc5T,MAAM,EAAE,IAAMwU,EAAGZ,cACpJhb,cAAgB4b,EAAG5b,eAAiB4b,EAAG5b,cAAckD,OAAU0Y,EAAG5b,cAAcsC,IAAK6K,IAAM,CAAMC,iBAAkBD,EAAGC,iBAAkBE,cAAeH,EAAGG,cAAevN,YAAaoN,EAAGpN,YAAakL,OAAQkC,EAAGlC,UAAa,CA1H3M,CAAsBmC,iBAAkB,KAAME,cAAe,GAAIvN,YAAa,GAAIkL,OAAQ,IA2H7GhL,cAAgB2b,EAAG3b,eAAiB2b,EAAG3b,cAAciD,OAAU0Y,EAAG3b,cAAcqC,IAAKya,IAAM,CAAM7R,OAAQ6R,EAAG7R,OAAQC,MAAO4R,EAAG5R,MAAOC,OAAQ2R,EAAG3R,OAAQC,QAAS0R,EAAG1R,WAAc,CA1H/J,CAAsBH,OAAQ,GAAIC,MAAO,EAAGC,OAAQ,EAAGC,QAAS,IAAhE,CAAsBH,OAAQ,GAAIC,MAAO,EAAGC,OAAQ,EAAGC,QAAS,KA2HnF4P,KAAMW,EAAGoB,gBAAkB,QAAU,SACrC9B,YAAaU,EAAGV,aAAeU,EAAGV,YAAYhY,OAAS0Y,EAAGV,YAAY5Y,IAAK2a,IAAM,CAAMC,WAAYD,EAAGC,WAAYC,aAAcF,EAAGE,aAAcpB,aAAckB,EAAGlB,aAAcqB,eAAgBH,EAAGG,kBAAqB,GACxNtS,YAAa+R,EACb9R,YAAa+R,KAEf9b,GAAQ,GAER,IACE,MAAM4E,EAAQC,aAAaC,QAAQ,SAC7BuX,EAAsB,GACtB7O,EAAS3H,QAAiB1E,IAAN0E,GAAyB,OAANA,EAAcA,EAAI,GACzDiI,EAAO,CAACN,EAAMoN,EAAG9b,aAAc0O,EAAMoN,EAAGhN,oBAAqBJ,EAAMqO,GAAmBrO,EAAMoN,EAAG/O,oBAAqB2B,EAAMsO,GAAmBtO,EAAMoN,EAAG7O,qBAC5J,IAAK,MAAMlG,KAAKiI,EACVjI,IAAM1B,MAAMC,OAAOyB,KAAKwW,EAAU5P,KAAKlL,OAAOsE,IAEpD,IAAK,MAAM1D,KAAMf,MAAM6D,KAAK,IAAIhB,IAAIoY,IAClC,IAAK1b,EAAUwB,GACb,IAAM,MAAM+C,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAehD,IAAO,CAAEiD,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAAUM,GAAKA,EAAEzB,MAAM7C,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAI,IAAE,CAACtC,GAAK+C,EAAEzB,KAAK6B,WAAaJ,EAAEzB,KAAK8B,UAAYpD,IAAQ,CAAE,MAAON,GAAK,CAG1P,CAAE,MAAOA,GAAI,GAmJyC6K,CAASkO,GAAKrQ,GAAI,CAACC,GAAG,GAAGpC,SAAC,UAC9DK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC/D,KAAK,QAAQiE,QAASzF,UAE5B,IACE,MAAMyB,EAAQC,aAAaC,QAAQ,SAC7BI,QAAU5B,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,uBAAD2B,OAAwByV,EAAG0B,mBAAqB,CAAElX,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IACvI2X,EAAOrX,GAAKA,EAAEzB,KAAOyB,EAAEzB,KAAOmX,EAC9B4B,GAAQ9X,EAAAA,EAAAA,GAAA,GAAQ6X,GAEtB,IAAKC,EAASC,QACZ,IACE,MAAMC,QAAW1V,EAAAA,EAAAA,GAAqB,uBAAwB,CAAEc,MAAO,aACnE4U,EAAGzV,KAAIuV,EAASC,cAAgBC,EAAGvV,OACzC,CAAE,MAAOuJ,GAAI,CAGf,MAAMnD,EAAsC,CAAC,EACvCC,EAAS3H,QAAiB1E,IAAN0E,GAAyB,OAANA,EAAcA,EAAI,GACzD5D,EAAgB,GAChB0a,EAAWzb,IAAc,MAAMY,EAAIb,GAAoBC,GAAUY,GAAKA,EAAEI,QAAQD,EAAIwK,QAAQ3K,IAClG6a,EAAQnP,EAAMgP,EAAS1d,cAAgB0O,EAAMgP,EAAS5O,qBACtD+O,EAAQnP,EAAMgP,EAAS1S,cAAgB0D,EAAMgP,EAASnT,cAAgBmE,EAAMgP,EAAS3Q,qBAAuB2B,EAAMgP,EAASlT,kBAC3HqT,EAAQnP,EAAMgP,EAASzS,cAAgByD,EAAMgP,EAASjT,cAAgBiE,EAAMgP,EAASzQ,qBAAuByB,EAAMgP,EAAShT,kBAC3H,MAAMxF,EAAa5C,MAAM6D,KAAK,IAAIhB,IAAIhC,EAAIT,OAAOW,GAAMA,IAAOxB,EAAUwB,MAQxE,GAPI6B,EAAW9B,eACP6C,QAAQC,IAAIhB,EAAW1C,IAAI6B,UAC/B,IAAM,MAAMyZ,QAAWtZ,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAehD,IAAO,CAAEiD,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAAUgY,GAAMA,EAAGnZ,OAAM8J,EAAapL,GAAMya,EAAGnZ,KAAK6B,WAAasX,EAAGnZ,KAAK8B,UAAYpD,EAAI,CAAE,MAAOuO,GAAI,KAE9NnM,OAAOC,KAAK+I,GAAcrL,QAAQtB,EAAa6D,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAUD,GAAS8I,MAGvEiP,EAAS3O,iBAAkB,CAC9B,MAAMC,EAAO7M,GAAoBub,EAAS1d,aAAe0d,EAAS5O,oBAAsB,IACxF4O,EAAS3O,iBAAoBC,EAAK,KAAOnN,EAAUmN,EAAK,KAAOP,EAAaO,EAAK,MAAS0O,EAAS5O,oBAAsB,EAC3H,CACA,IAAK4O,EAASzO,iBAAkB,CAC9B,MAAMD,EAAO7M,GAAoBub,EAAS1S,aAAe0S,EAASnT,aAAemT,EAAS3Q,oBAAsB2Q,EAASlT,iBAAmB,IAC5IkT,EAASzO,iBAAoBD,EAAK,KAAOnN,EAAUmN,EAAK,KAAOP,EAAaO,EAAK,MAAS0O,EAAS3Q,oBAAsB2Q,EAASlT,iBAAmB,EACvJ,CACA,IAAKkT,EAASxO,iBAAkB,CAC9B,MAAMF,EAAO7M,GAAoBub,EAASzS,aAAeyS,EAASjT,aAAeiT,EAASzQ,oBAAsByQ,EAAShT,iBAAmB,IAC5IgT,EAASxO,iBAAoBF,EAAK,KAAOnN,EAAUmN,EAAK,KAAOP,EAAaO,EAAK,MAAS0O,EAASzQ,oBAAsByQ,EAAShT,iBAAmB,EACvJ,CAEA,IAAKgT,EAAS3O,mBAAqB2O,EAASzO,mBAAqByO,EAASxO,iBACxE,IACE,MAAM6O,QAAYvZ,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,gBAAiB,CAAE4B,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAC3GuE,EAAK0T,GAAOA,EAAIpZ,KAAOoZ,EAAIpZ,KAAO,KACxC,GAAI0F,EAAI,CACDqT,EAAS3O,mBAAkB2O,EAAS3O,iBAAmB1E,EAAG7D,WAAa6D,EAAG5D,UAAY,IAC3F,MAAMuX,EAAkB3Z,UACtB,GAAIhB,IAAOgC,MAAMC,OAAOjC,IAAM,CAC5B,MAAMkC,EAAM9C,OAAOY,GACnB,GAAIxB,EAAU0D,GAAM,OAAO1D,EAAU0D,GACrC,IAAM,MAAMuY,QAAWtZ,EAAAA,EAAMC,KAAIC,EAAAA,EAAAA,IAAS,cAAD2B,OAAed,IAAQ,CAAEe,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAAM,OAAOgY,GAAMA,EAAGnZ,OAAQmZ,EAAGnZ,KAAK6B,WAAasX,EAAGnZ,KAAK8B,WAAmBlB,CAAK,CAAE,MAAA0Y,GAAQ,OAAO1Y,CAAK,CACtO,CACA,OAAO9C,OAAOY,GAAM,KAEtB,IAAKqa,EAASzO,iBAAkB,CAC9B,MAAMiP,EAAK7T,EAAGE,aAAeF,EAAGG,iBAAmB,GACnDkT,EAASzO,uBAAyB+O,EAAgBE,EACpD,CACA,IAAKR,EAASxO,iBAAkB,CAC9B,MAAMiP,EAAK9T,EAAGI,aAAeJ,EAAGK,iBAAmB,GACnDgT,EAASxO,uBAAyB8O,EAAgBG,EACpD,CACF,CACF,CAAE,MAAOvM,GAAI,CAEf1P,GAAewb,EACjB,CAAE,MAAO3a,GAAKb,GAAe4Z,EAAK,CAClC9Z,IAAe,IACfsH,SAAC,iBA3EEwS,EAAG0B,mBA+EI,IAAjBhd,EAAM4C,SAAgBuG,EAAAA,EAAAA,KAAA,MAAAL,SAAI,0CAOrCF,EAAAA,EAAAA,MAACmG,EAAAA,EAAM,CAACtO,KAAMA,EAAMuO,QAASA,IAAMtO,GAAQ,GAAQuO,WAAS,EAACC,SAAS,KAAIpG,SAAA,EACxEF,EAAAA,EAAAA,MAACuG,EAAAA,EAAW,CAAArG,SAAA,CAAEnI,EAAO,uBAAAkF,OAA2BlF,GAAWA,EAAQ4a,uBAA0B,GAAE,0BAA0BpS,EAAAA,EAAAA,KAACiG,EAAAA,EAAU,CAAC,aAAW,QAAQ9F,QAASA,IAAM5I,GAAQ,GAAQuK,GAAI,CAACoE,SAAS,WAAYC,MAAM,EAAGC,IAAI,GAAGzG,UAACK,EAAAA,EAAAA,KAACqG,EAAAA,EAAS,UAC5O5G,EAAAA,EAAAA,MAAC6G,EAAAA,EAAa,CAAA3G,SAAA,EACZF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACjC,QAAQ,OAAQ0G,oBAAqB,UAAWC,IAAK,EAAGC,GAAG,GAAG9G,SAAA,EACtEK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACC,SAAU7O,EAAe8O,MAAM,aAAaC,KAAK,OAAOC,MAAOpP,EAAK6Z,eAAiB,GAAI5O,SAAUvJ,GAAKzB,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAE6Z,cAAenY,EAAE2N,OAAOD,SAASE,gBAAiB,CAAEC,QAAQ,MACjMjH,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACE,MAAM,UAAUE,MAAOpP,EAAKvB,SAAW,GAAIwM,SAAUvJ,GAAKzB,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAEvB,QAASiD,EAAE2N,OAAOD,cAI5F,UAAdpP,EAAK8Z,OACJxR,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAAC2E,GAAG,GAAG9G,UACdK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACE,MAAM,eAAeE,MAAOpP,EAAK+c,UAAY,GAAI9R,SAAUvJ,GAAKzB,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAE+c,SAAUrb,EAAE2N,OAAOD,cAKpH9G,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAACoQ,GAAG,GAAGvS,UACdF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAAAC,SAAA,EACFF,EAAAA,EAAAA,MAAA,SAAOG,MAAO,CAAC8U,YAAY,IAAI/U,SAAA,EAACK,EAAAA,EAAAA,KAAA,SAAO6G,KAAK,QAAQrJ,KAAK,OAAOiF,QAAuB,UAAd/K,EAAK8Z,KAAkB7O,SAAUA,IAAIhL,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAE8Z,KAAM,cAAc,4BACpJ/R,EAAAA,EAAAA,MAAA,SAAAE,SAAA,EAAOK,EAAAA,EAAAA,KAAA,SAAO6G,KAAK,QAAQrJ,KAAK,OAAOiF,QAAuB,UAAd/K,EAAK8Z,KAAkB7O,SAAUA,IAAIhL,GAAOsE,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAGvE,GAAI,IAAE8Z,KAAM,aAAa,+BAK/G,UAAd9Z,EAAK8Z,OACJ/R,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGd,GAAG,GAAG9G,SAAA,EACpBK,EAAAA,EAAAA,KAACgS,EAAAA,EAAU,CAAC9R,QAAQ,YAAWP,SAAC,iBAChCF,EAAAA,EAAAA,MAACyC,EAAAA,EAAK,CAAChG,KAAK,QAAOyD,SAAA,EACjBK,EAAAA,EAAAA,KAACmC,EAAAA,EAAS,CAAAxC,UACRF,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,gBACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,cACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,WACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACoF,MAAM,QAAO9H,SAAC,YACzBK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,UAGdrC,EAAAA,EAAAA,KAACsC,EAAAA,EAAS,CAAA3C,UACNjI,EAAK+Z,aAAe,IAAI5Y,IAAI,CAAC2a,EAAQ7L,KACrClI,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UAACK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACG,KAAK,OAAOC,MAAO0M,EAAGC,YAAc,GAAI9Q,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKkN,YAAclN,EAAKkN,aAAe,GAAIlN,EAAKkN,YAAY9J,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKkN,YAAY9J,IAAM,CAAC,GAAG,CAAF,GAAG8L,WAAYra,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAUyC,gBAAiB,CAAEC,QAAQ,QACvRjH,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UAACK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACI,MAAO0M,EAAGE,cAAgB,GAAI/Q,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKkN,YAAclN,EAAKkN,aAAe,GAAIlN,EAAKkN,YAAY9J,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKkN,YAAY9J,IAAM,CAAC,GAAG,CAAF,GAAG+L,aAActa,EAAE2N,OAAOD,QAASnP,EAAQ4M,SAC1OvE,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRF,EAAAA,EAAAA,MAAC2H,EAAAA,EAAM,CAACtB,WAAS,EAACgB,MAAOhO,OAAO0a,EAAGG,gBAAkB,IAAKhR,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKkN,YAAclN,EAAKkN,aAAe,GAAIlN,EAAKkN,YAAY9J,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKkN,YAAY9J,IAAM,CAAC,GAAG,CAAF,GAAGgM,eAAgBva,EAAE2N,OAAOD,MAAQnL,OAAOvC,EAAE2N,OAAOD,OAAS,OAAQnP,EAAQ4M,IAAS5E,SAAA,EACzRK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,GAAEnH,SAAC,qBAClBzI,EAAS2B,IAAKiF,IAASkC,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAAoBR,MAAOhJ,EAAET,WAAWsC,SAAE7B,EAAEP,cAAtCO,EAAET,mBAG7C2C,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACoF,MAAM,QAAO9H,UAACK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACG,KAAK,SAASC,MAAO0M,EAAGlB,cAAgB,GAAI3P,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKkN,YAAclN,EAAKkN,aAAe,GAAIlN,EAAKkN,YAAY9J,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKkN,YAAY9J,IAAM,CAAC,GAAG,CAAF,GAAG2K,aAAiC,KAAnBlZ,EAAE2N,OAAOD,MAAe,GAAKnL,OAAOvC,EAAE2N,OAAOD,SAAUnP,EAAQ4M,IAAUwD,WAAY,CAAEjG,GAAI,CAAEkG,UAAW,eACpVhI,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UAACK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC+B,MAAM,QAAQ7B,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKkN,YAAclN,EAAKkN,aAAe,GAAIlN,EAAKkN,YAAclN,EAAKkN,YAAY1Y,OAAO,CAACkP,EAAMC,IAAWA,IAAIP,GAAMhQ,EAAQ4M,IAAS5E,SAAC,eAVjMgI,UAerB3H,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,GAAG5H,UAACK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKkN,YAAclN,EAAKkN,aAAe,GAAIlN,EAAKkN,YAAYzN,KAAK,CAAEyP,WAAW,GAAIC,aAAa,GAAIpB,aAAa,EAAGqB,eAAgB,OAAShc,EAAQ4M,IAAS5E,SAAC,yBAKpOF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGd,GAAG,GAAG9G,SAAA,EACpBK,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAAC0F,WAAW,IAAKf,GAAG,GAAG9G,SAAC,qBACjCF,EAAAA,EAAAA,MAACyC,EAAAA,EAAK,CAAChG,KAAK,QAAOyD,SAAA,EACjBK,EAAAA,EAAAA,KAACmC,EAAAA,EAAS,CAAAxC,UACRF,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,WACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,iBACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACoF,MAAM,QAAO9H,SAAC,mBACzBK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,UAGdrC,EAAAA,EAAAA,KAACsC,EAAAA,EAAS,CAAA3C,UACNjI,EAAKnB,eAAiB,IAAIsC,IAAI,CAAC6O,EAAUC,KACzClI,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACP,GAAI,CAAC8F,SAAS,KAAKjI,UAC5BF,EAAAA,EAAAA,MAAC2H,EAAAA,EAAM,CAACtB,WAAS,EAACgB,MAAOhO,OAAO4O,EAAK/D,kBAAoB,IAAKhB,SAAUvJ,IAAM,IAADmP,EAAE,MAAMnL,EAAIhE,EAAE2N,OAAOD,MAAavC,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAAIgO,EAAKhO,cAAcoR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKhO,cAAcoR,IAAQ,CAAC,GAAG,CAAF,GAAGhE,iBAAkBvG,EAAIzB,OAAOyB,GAAK,KAAMyG,eAAuE,QAAxD0E,EAAArR,EAAS0N,KAAM9G,GAAQhF,OAAOgF,EAAET,cAAcvE,OAAOsE,WAAG,IAAAmL,OAAA,EAAxDA,EAA0DhL,eAAgB,KAAM5F,EAAQ4M,IAAS5E,SAAA,EACtYK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,GAAEnH,SAAC,uBAClBzI,EAAS2B,IAAKiF,IAAU2B,EAAAA,EAAAA,MAAC6H,EAAAA,EAAQ,CAAoBR,MAAOhO,OAAOgF,EAAET,YAAYsC,SAAA,CAAE7B,EAAEP,aAAcO,EAAEL,aAAY,KAAAf,OAAQoB,EAAEL,aAAY,KAAM,KAAtGK,EAAET,mBAG9C2C,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACZ,WAAS,EAACgB,MAAOY,EAAKpR,aAAe,GAAIqM,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAAIgO,EAAKhO,cAAcoR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKhO,cAAcoR,IAAQ,CAAC,GAAG,CAAF,GAAGrR,YAAa8C,EAAE2N,OAAOD,QAASnP,EAAQ4M,SAErPvE,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACoF,MAAM,QAAO9H,UACtBK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACG,KAAK,SAASC,MAAOY,EAAKlG,QAAU,GAAImB,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAAIgO,EAAKhO,cAAcoR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAKhO,cAAcoR,IAAQ,CAAC,GAAG,CAAF,GAAGnG,OAAQpI,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAUwD,WAAY,CAAEjG,GAAI,CAAEkG,UAAW,eAExRhI,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC+B,MAAM,QAAQ7B,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAAIgO,EAAKhO,cAAgBgO,EAAKhO,cAAcwC,OAAO,CAACkP,EAAMC,IAAWA,IAAIP,GAAMhQ,EAAQ4M,IAAS5E,SAAC,eAdhMgI,UAoBrB3H,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,GAAG5H,UACdK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAKhO,cAAgBgO,EAAKhO,eAAiB,GAAIgO,EAAKhO,cAAcyN,KAndxG,CAAsBL,iBAAkB,KAAME,cAAe,GAAIvN,YAAa,GAAIkL,OAAQ,IAmdwC7J,EAAQ4M,IAAS5E,SAAC,0BAEjKF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGS,UAAU,QAASR,WAAW,KAAK7H,SAAA,CAAC,6BAA2BjI,EAAKnB,eAAiB,IAAIyM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAE1B,SAAS,GAAI,UAI5J/B,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGd,GAAG,GAAG9G,SAAA,EACpBK,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAAC0F,WAAW,IAAKf,GAAG,GAAG9G,SAAC,mBACjCF,EAAAA,EAAAA,MAACyC,EAAAA,EAAK,CAAChG,KAAK,QAAOyD,SAAA,EACjBK,EAAAA,EAAAA,KAACmC,EAAAA,EAAS,CAAAxC,UACRF,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,SACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,WACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,YACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,SAAC,aACXK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,UAGdrC,EAAAA,EAAAA,KAACsC,EAAAA,EAAS,CAAA3C,UACNjI,EAAKlB,eAAiB,IAAIqC,IAAI,CAAC6O,EAAUC,KACzClI,EAAAA,EAAAA,MAAC2C,EAAAA,EAAQ,CAAAzC,SAAA,EACPK,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAACP,GAAI,CAAC8F,SAAS,KAAKjI,UAC5BF,EAAAA,EAAAA,MAAC2H,EAAAA,EAAM,CAACtB,WAAS,EAACgB,MAAOhO,OAAO4O,EAAKjG,QAAU,IAAKkB,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcmR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAK/N,cAAcmR,IAAQ,CAAC,GAAG,CAAF,GAAGlG,OAAQrI,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAS5E,SAAA,EACrPK,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAACR,MAAM,GAAEnH,SAAC,qBAClBvI,EAAKyB,IAAKsP,IAAUnI,EAAAA,EAAAA,KAACsH,EAAAA,EAAQ,CAAgBR,MAAOhO,OAAOqP,EAAE1G,QAAQ9B,SAAEwI,EAAE3D,cAAgB2D,EAAE3K,MAAQ2K,EAAE1G,QAAlE0G,EAAE1G,eAG1CzB,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACZ,WAAS,EAACgB,MAAOY,EAAKhG,OAAS,GAAIiB,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcmR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAK/N,cAAcmR,IAAQ,CAAC,GAAG,CAAF,GAAGjG,MAAOtI,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAUwD,WAAY,CAAEjG,GAAI,CAAEkG,UAAW,eAElRhI,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACZ,WAAS,EAACgB,MAAOY,EAAK/F,QAAU,GAAIgB,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcmR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAK/N,cAAcmR,IAAQ,CAAC,GAAG,CAAF,GAAGhG,OAAQvI,EAAE2N,OAAOD,QAASnP,EAAQ4M,IAAUwD,WAAY,CAAEjG,GAAI,CAAEkG,UAAW,eAEpRhI,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACZ,WAAS,EAACgB,MAAOY,EAAK9F,SAAW,GAAIe,SAAUvJ,IAAO,MAAMmL,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcmR,IAAI1L,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAASsI,EAAK/N,cAAcmR,IAAQ,CAAC,GAAG,CAAF,GAAG/F,QAASxI,EAAE2N,OAAOD,QAASnP,EAAQ4M,SAE7OvE,EAAAA,EAAAA,KAACqC,EAAAA,EAAS,CAAA1C,UACRK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAAC+B,MAAM,QAAQ7B,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAgB+N,EAAK/N,cAAcuC,OAAO,CAACkP,EAAMC,IAAWA,IAAIP,GAAMhQ,EAAQ4M,IAAS5E,SAAC,eAjBhMgI,UAuBrB3H,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,GAAG5H,UACdK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,KAAQ,MAAMoE,GAAItI,EAAAA,EAAAA,GAAA,GAAOvE,GAAO6M,EAAK/N,cAAgB+N,EAAK/N,eAAiB,GAAI+N,EAAK/N,cAAcwN,KA9fxG,CAAsBvC,OAAQ,GAAIC,MAAO,EAAGC,OAAQ,EAAGC,QAAS,KA8fkEjK,EAAQ4M,IAAS5E,SAAC,0BAEjKF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGS,UAAU,SAASrI,SAAA,EACjCF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,gBAAoB,SAAOjI,EAAKlB,eAAiB,IAAIwM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAExB,QAAQ,GAAI,OAClHjC,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,iBAAqB,SAAOjI,EAAKlB,eAAiB,IAAIwM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAEvB,SAAS,GAAI,aAKxHlC,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACyF,GAAG,EAAGd,GAAG,GAAG9G,SAAA,EACpBK,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACoC,GAAI,CAAC0F,WAAW,IAAKf,GAAG,GAAG9G,SAAC,iBACjCF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACoC,GAAI,CAACjC,QAAQ,OAAQ0G,oBAAqB,cAAeC,IAAI,GAAG7G,SAAA,EACnEK,EAAAA,EAAAA,KAAC0G,EAAAA,EAAS,CAACE,MAAM,cAAcE,MAAQpP,EAAKyN,oBAAsBzN,EAAKyN,oBAAwBzN,EAAKrB,aAAe6B,EAAUY,OAAOpB,EAAKrB,eAAkB,GAAI+R,UAAQ,KACvKpI,EAAAA,EAAAA,KAAC2U,EAAAA,EAAY,CACXC,UAAQ,EACRC,QAAShE,EAAYhY,IAAIoY,IAAC,CAAOvX,GAAIuX,EAAEjQ,QAAS4F,MAAOqK,EAAEpU,WAAaoU,EAAEnU,UAAYhE,OAAOmY,EAAEjQ,YAC7F8T,eAAiBC,GAA2B,kBAARA,EAAmBA,EAAOA,GAAOA,EAAInO,OAAU,GAEnFE,MAAO,MACL,MAAM1J,EAAI1F,EAAK2J,YACf,OAAU,OAANjE,QAAoB1E,IAAN0E,GAAyB,KAANA,EAAiB,GACjD1B,MAAMC,OAAOyB,IACXA,EADuBlF,EAAUY,OAAOsE,KAAOtE,OAAOsE,EAE9D,EALM,GAMP4X,WAAY,MACV,MAAM5X,EAAI1F,EAAK2J,YACf,OAAU,OAANjE,QAAoB1E,IAAN0E,GAAyB,KAANA,EAAiB,GACjD1B,MAAMC,OAAOyB,IACXA,EADuBlF,EAAUY,OAAOsE,KAAOtE,OAAOsE,EAE9D,EALW,GAMZ6X,cAAeA,CAAChN,EAAGiN,KAEjBvd,EAASqE,IAASC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWD,GAAI,IAAEqF,YAAa6T,MAElDvS,SAAUA,CAACsF,EAAGkN,IAE2Bxd,EADlCwd,EACiB,kBAAXA,EAAqCnZ,IAASC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWD,GAAI,IAAEqF,YAAa8T,IACvEnZ,IAASC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWD,GAAI,IAAEqF,YAAa8T,EAAOzb,KAFjCsC,IAASC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWD,GAAI,IAAEqF,YAAa,QAItE+T,YAAcC,IAAWrV,EAAAA,EAAAA,KAAC0G,EAAAA,GAASzK,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAKoZ,GAAM,IAAEzO,MAAM,oBAExD5G,EAAAA,EAAAA,KAAC2U,EAAAA,EAAY,CACXC,UAAQ,EACRC,QAAShE,EAAYhY,IAAIoY,IAAC,CAAOvX,GAAIuX,EAAEjQ,QAAS4F,MAAOqK,EAAEpU,WAAaoU,EAAEnU,UAAYhE,OAAOmY,EAAEjQ,YAC7F8T,eAAiBC,GAA2B,kBAARA,EAAmBA,EAAOA,GAAOA,EAAInO,OAAU,GACnFE,MAAO,MACL,MAAM1J,EAAI1F,EAAK4J,YACf,OAAU,OAANlE,QAAoB1E,IAAN0E,GAAyB,KAANA,EAAiB,GACjD1B,MAAMC,OAAOyB,IACXA,EADuBlF,EAAUY,OAAOsE,KAAOtE,OAAOsE,EAE9D,EALM,GAMP4X,WAAY,MACV,MAAM5X,EAAI1F,EAAK4J,YACf,OAAU,OAANlE,QAAoB1E,IAAN0E,GAAyB,KAANA,EAAiB,GACjD1B,MAAMC,OAAOyB,IACXA,EADuBlF,EAAUY,OAAOsE,KAAOtE,OAAOsE,EAE9D,EALW,GAMZ6X,cAAeA,CAAChN,EAAGiN,KACjBvd,EAASqE,IAASC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWD,GAAI,IAAEsF,YAAa4T,MAElDvS,SAAUA,CAACsF,EAAGkN,IAE2Bxd,EADlCwd,EACiB,kBAAXA,EAAqCnZ,IAASC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWD,GAAI,IAAEsF,YAAa6T,IACvEnZ,IAASC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWD,GAAI,IAAEsF,YAAa6T,EAAOzb,KAFjCsC,IAASC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWD,GAAI,IAAEsF,YAAa,QAItE8T,YAAcC,IAAWrV,EAAAA,EAAAA,KAAC0G,EAAAA,GAASzK,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAKoZ,GAAM,IAAEzO,MAAM,6BAK9DnH,EAAAA,EAAAA,MAAC4I,EAAAA,EAAa,CAAA1I,SAAA,EACZK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,KAAQ+Q,MAAevR,SAAC,YACzCK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASzF,eA1ZZA,WAEX,IAAKhD,EAAKvB,QAA8F,OAAnFkE,EAAY,uBAAwBE,EAAiB,cAAUJ,GAAa,GACjG,IAAKzC,EAAKnB,eAA+C,IAA9BmB,EAAKnB,cAAckD,OAAqH,OAArGY,EAAY,yCAA0CE,EAAiB,cAAUJ,GAAa,GAC5J,IAAKzC,EAAKlB,eAAiBkB,EAAKlB,cAAciD,OAAS,EAAkH,OAA7GY,EAAY,iDAAkDE,EAAiB,cAAUJ,GAAa,GAIlK,IAFoBzC,EAAKlB,eAAiB,IAAIwM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAExB,QAAQ,GAAI,MACzEhK,EAAKlB,eAAiB,IAAIwM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAEvB,SAAS,GAAI,GAC4C,OAA1GtH,EAAY,8CAA+CE,EAAiB,cAAUJ,GAAa,GAGrI,MAAMmO,GAAsB5Q,EAAKnB,eAAiB,IAAIsC,IAAKqK,IAAK,IAAA4E,EAAA,MAAM,CAAEnE,iBAAkBT,EAAES,iBAAmBhI,OAAOuH,EAAES,kBAAoB,KAAME,cAAeX,EAAEW,gBAA2F,QAA9EiE,EAAK5Q,EAAS0N,KAAM9G,GAAQhF,OAAOgF,EAAET,cAAcvE,OAAOoK,EAAES,0BAAkB,IAAAmE,OAAA,EAAzEA,EAA2EvK,eAAiB,GAAIjH,YAAa4M,EAAE5M,aAAe,GAAIkL,OAAQ7F,OAAOuH,EAAE1B,SAAS,KAC3U8T,GAAsB5d,EAAKlB,eAAiB,IAAIqC,IAAKqK,IAAK,CAAMzB,OAAQyB,EAAEzB,QAAU,KAAMC,MAAO/F,OAAOuH,EAAExB,QAAQ,EAAGC,OAAQhG,OAAOuH,EAAEvB,SAAS,EAAGC,QAASsB,EAAEtB,SAAW,MAExKiH,EAAe,CACnB5S,OAAQyB,EAAKzB,QAAU,QACvBsb,cAAe7Z,EAAK6Z,cACpBpb,QAASuB,EAAKvB,QACdC,aAAcsB,EAAKtB,cAAgB,OACnCC,YAAaqB,EAAKrB,aAAe,KACjCC,YAAaoB,EAAKpB,aAAe,GACjCC,cAAe+R,EACf9R,cAAe8e,GAGXC,EAAiBnY,GACX,OAANA,QAAoB1E,IAAN0E,GAAyB,KAANA,EAAiB,CAAE1D,GAAI,KAAMgP,OAAQ,MACrEhN,MAAMC,OAAOyB,IACX,CAAE1D,GAAI,KAAMgP,OAAQ5P,OAAOsE,IADJ,CAAE1D,GAAIiC,OAAOyB,GAAIsL,OAAQ,MAGnD6L,EAAKgB,EAAc7d,EAAK2J,aACxBmT,EAAKe,EAAc7d,EAAK4J,aAC1BiT,EAAG7a,GAAImP,EAAQjI,YAAc2T,EAAG7a,GAAa6a,EAAG7L,SAAQG,EAAQhI,gBAAkB0T,EAAG7L,QACrF8L,EAAG9a,GAAImP,EAAQ/H,YAAc0T,EAAG9a,GAAa8a,EAAG9L,SAAQG,EAAQ9H,gBAAkByT,EAAG9L,QAEzFG,EAAQxH,YAAc3J,EAAK2J,aAAe,KAC1CwH,EAAQvH,YAAc5J,EAAK4J,aAAe,KAExB,UAAd5J,EAAK8Z,MAAoB7Y,MAAMC,QAAQlB,EAAK+Z,cAC9C5I,EAAQ4I,aAAe/Z,EAAK+Z,aAAe,IAAI5Y,IAAKiF,IAAK,CAAM4V,aAAc5V,EAAE4V,cAAgB5V,EAAE2W,UAAY,KAAMhB,WAAY3V,EAAE2V,YAAc,KAAMnB,aAAc3W,OAAOmC,EAAEwU,eAAe,EAAGqB,eAAgB7V,EAAE6V,gBAAkB,QAClO9K,EAAQ0K,gBAAkB,IAE1B1K,EAAQ0K,gBAAkB,EAEtB7b,EAAK+c,WAAU5L,EAAQ4L,SAAW/c,EAAK+c,WAEvC/c,EAAK4a,cAAsC,IAAtB5a,EAAK4a,gBAAoBzJ,EAAQyJ,aAAe3W,OAAOjE,EAAK4a,gBAGvF,IACE,MAAMnW,EAAQC,aAAaC,QAAQ,SACnC,GAAI7E,GAAWA,EAAQqc,uBACfhZ,EAAAA,EAAMiO,KAAI/N,EAAAA,EAAAA,IAAS,uBAAD2B,OAAwBlF,EAAQqc,mBAAqBhL,EAAS,CAAElM,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IACjJ9B,EAAY,yBAA0BE,EAAiB,WAAYJ,GAAa,GAAO5C,GAAQ,GAAQwZ,QAClG,CACL,MAAMzS,QAAYzD,EAAAA,EAAMkO,MAAKhO,EAAAA,EAAAA,IAAS,uBAAwB8N,EAAS,CAAElM,QAASR,EAAQ,CAAES,cAAc,UAADF,OAAYP,IAAY,CAAC,IAC5H6M,EAAO1K,EAAItD,MAAQsD,EAAItD,KAAKwa,eAAiBlX,EAAItD,KAAKwa,cAAcpD,sBAAwB9T,EAAItD,KAAKwa,cAAcpD,sBAAwB,KACjJ/X,EAAY2O,EAAI,0BAAAtM,OAA6BsM,EAAI,KAAM,yBAA0BzO,EAAiB,WAAYJ,GAAa,GAAO5C,GAAQ,GAAQwZ,GACpJ,CACF,CAAE,MAAO9V,GAAU,IAADC,EAAA4S,EAChBzT,GAAwB,QAAZa,EAAAD,EAAIG,gBAAQ,IAAAF,GAAM,QAAN4S,EAAZ5S,EAAcF,YAAI,IAAA8S,OAAN,EAAZA,EAAoB3S,QAASF,EAAII,SAAW,eAAgBd,EAAiB,SAAUJ,GAAa,EAClH,GA6V2Csb,GAAiEvE,MAAgBhR,QAAQ,YAAWP,SAAC,gBAK9IF,EAAAA,EAAAA,MAACmG,EAAAA,EAAM,CAACtO,KAAMc,GAAayN,QAASA,IAAMxN,IAAe,GAAQyN,WAAS,EAACC,SAAS,KAAIpG,SAAA,EACtFK,EAAAA,EAAAA,KAACgG,EAAAA,EAAW,CAAArG,SAAC,2BACbK,EAAAA,EAAAA,KAACsG,EAAAA,EAAa,CAAA3G,SACXrH,IACCmH,EAAAA,EAAAA,MAAA,OAAK/F,GAAG,gBAAgBkG,MAAO,CAACuJ,QAAQ,GAAIC,WAAY,oBAAqBpH,MAAO,QAAQrC,SAAA,EAC1FF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAQC,eAAe,gBAAiBC,WAAW,SAAUsJ,aAAa,IAAI1J,SAAA,EACjGF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC0J,SAAS,GAAI9B,WAAW,KAAK7H,SAAErH,GAAY0b,UAAW1b,GAAY0b,QAAQxW,MAAQlF,GAAY0b,QAAQzK,eAAsB,MACzIvJ,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC0J,SAAS,IAAI3J,SAAErH,GAAY0b,SAAW1b,GAAY0b,QAAQxK,SAAiB,SAE1FxJ,EAAAA,EAAAA,KAAA,OAAAL,SACGrH,GAAY0b,SAAW1b,GAAY0b,QAAQvK,MAAOzJ,EAAAA,EAAAA,KAAA,OAAK0J,IAAKpR,GAAY0b,QAAQvK,KAAME,IAAI,OAAO/J,MAAO,CAACgK,OAAO,MAAS,WAG9H5J,EAAAA,EAAAA,KAAA,UACAP,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAQC,eAAe,gBAAiB+J,UAAU,IAAIlK,SAAA,EACzEF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,aAAiB,IAAErH,GAAY8Z,uBAAyB9Z,GAAYub,qBACjFpU,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,cAAkB,KAAEmD,EAAAA,EAAAA,GAAqBxK,GAAYiZ,mBAClE9R,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,aAAiB,IAAErH,GAAYnC,eAE9C6J,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACoI,UAAU,SAASrI,UAC9BF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EAAKK,EAAAA,EAAAA,KAAA,UAAAL,SAAQ,YAAgB,QAAMrH,GAAYga,eAAiBha,GAAY/B,eAAiB+B,GAAY/B,cAAckD,OAASnB,GAAY/B,cAAcyM,OAAO,CAACC,EAAMC,IAAQD,GAAKtH,OAAOuH,EAAE1B,SAAS,GAAG,GAAK,YAGnN/B,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACiK,UAAU,IAAIlK,SAAA,EACzBK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,qBAC9BF,EAAAA,EAAAA,MAAA,SAAOG,MAAO,CAACkK,MAAM,OAAQC,eAAe,WAAYF,UAAU,GAAGlK,SAAA,EACnEK,EAAAA,EAAAA,KAAA,SAAAL,UACEF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAIK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,QAAQrI,SAAC,WAAUK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,QAAQrI,SAAC,iBAAgBK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,SAASrI,SAAC,iBAE3NK,EAAAA,EAAAA,KAAA,SAAAL,UACIrH,GAAY/B,eAAiB,IAAIsC,IAAI,CAACqK,EAAOgF,KAC7CzI,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAYK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,SAASxJ,SAAEuD,EAAEW,eAAiBX,EAAEU,YAAcV,EAAES,kBAAoB,OAAS3D,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,SAASxJ,SAAEuD,EAAE5M,aAAe,MAAQ0J,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,QAASnB,UAAU,SAASrI,SAAEhE,OAAOuH,EAAE1B,QAAQ,GAAGyI,QAAQ,OAA1O/B,aAKjBzI,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACiK,UAAU,IAAIlK,SAAA,EACzBK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,qBAC9BF,EAAAA,EAAAA,MAAA,SAAOG,MAAO,CAACkK,MAAM,OAAQC,eAAe,WAAYF,UAAU,GAAGlK,SAAA,EACnEK,EAAAA,EAAAA,KAAA,SAAAL,UACEF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAIK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,QAAQrI,SAAC,SAAQK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,SAASrI,SAAC,WAAUK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACoK,aAAa,iBAAkBhC,UAAU,SAASrI,SAAC,iBAEpNK,EAAAA,EAAAA,KAAA,SAAAL,UACIrH,GAAY9B,eAAiB,IAAIqC,IAAI,CAACyL,EAAO4D,KAC7CzI,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EAAYK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,SAASxJ,SAAE2E,EAAEE,cAAgBF,EAAE4F,UAAY5F,EAAE7C,QAAU,MAAQzB,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,QAASnB,UAAU,SAASrI,SAAEhE,OAAO2I,EAAE5C,OAAO,GAAGuI,QAAQ,MAAQjK,EAAAA,EAAAA,KAAA,MAAIJ,MAAO,CAACuJ,QAAQ,QAASnB,UAAU,SAASrI,SAAEhE,OAAO2I,EAAE3C,QAAQ,GAAGsI,QAAQ,OAAzP/B,aAKjBlI,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,IAAIlK,UACzBF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACC,QAAQ,OAAQC,eAAe,iBAAiBH,SAAA,EAC3DF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACoI,UAAU,SAAU8B,MAAM,OAAOnK,SAAA,EAC5CK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,iBAC9BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,IAAIlK,SAAC,wBAC5BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,EAAGP,SAAS,IAAI3J,SAAErH,GAAY8M,kBAAoB7L,GAAoBjB,GAAYjC,aAAeiC,GAAY6M,oBAAsB,UAE5J1F,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACoI,UAAU,SAAU8B,MAAM,OAAOnK,SAAA,EAC5CK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,iBAC9BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,IAAIlK,SAAC,wBAC5BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,EAAGP,SAAS,IAAI3J,SAAErH,GAAYgN,kBAAoB/L,GAAoBjB,GAAY+I,aAAe/I,GAAY8K,oBAAsB,UAE5J3D,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAACoI,UAAU,SAAU8B,MAAM,OAAOnK,SAAA,EAC5CK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAAC4H,WAAW,KAAK7H,SAAC,iBAC9BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,IAAIlK,SAAC,wBAC5BK,EAAAA,EAAAA,KAAA,OAAKJ,MAAO,CAACiK,UAAU,EAAGP,SAAS,IAAI3J,SAAErH,GAAYiN,kBAAoBhM,GAAoBjB,GAAYgJ,aAAehJ,GAAYgL,oBAAsB,kBAKhKtD,EAAAA,EAAAA,KAAA,OAAAL,SAAK,uBAEXF,EAAAA,EAAAA,MAAC4I,EAAAA,EAAa,CAAA1I,SAAA,EACZK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAM9H,IAAe,GAAOsH,SAAC,WAC9CK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,IAAM7H,IAvaXoC,WAClB,GAAKgb,EACL,IACE,MAAMvZ,EAAQC,aAAaC,QAAQ,SAC7BM,EAAiC,CAAC,EACpCR,IAAOQ,EAAQC,cAAa,UAAAF,OAAaP,IAC7C,MAAMoE,QAAahC,EAAAA,EAAAA,GAAqB,uBAAD7B,OAAwBgZ,EAAI,QAAQ,CAAE/Y,YAC7E,IAAK4D,EAAK/B,GAAI,CACZ,MAAM4L,QAAY7J,EAAK8J,OACvB,IAAIC,EAAMF,EACV,IAAME,EAAMpR,KAAKC,MAAMiR,GAAKjP,OAASiP,CAAK,CAAE,MAAOhR,GAAKkR,EAAMF,CAAK,CACsC,OAAzG/P,EAAYiQ,GAAG,uBAAA5N,OAA2B6D,EAAKtK,SAAWsE,EAAiB,cAAUJ,GAAa,EACpG,CAEA,KADWoG,EAAK5D,QAAQ7B,IAAI,iBAAmB,IACvCyP,SAAS,mBAAoB,CACnC,MAAMH,QAAY7J,EAAK8J,OACvB,IAAIC,EAAMF,EACV,IAAME,EAAMpR,KAAKC,MAAMiR,GAAKjP,OAASiP,CAAK,CAAE,MAAOhR,GAAKkR,EAAMF,CAAK,CAC+B,OAAlG/P,EAAYiQ,GAAO,+BAAgC/P,EAAiB,cAAUJ,GAAa,EAC7F,CACA,MAAMqQ,QAAajK,EAAKiK,OAClBC,EAAMC,IAAIC,gBAAgBH,GAC1BI,EAAOrK,EAAK5D,QAAQ7B,IAAI,wBAA0B,GACxD,IAAI+P,EAAW,oBACf,MAAMxR,EAAI,wBAAwByR,KAAKF,GACnCvR,GAAKA,EAAE,KAAIwR,EAAWxR,EAAE,IAC5B,MAAM8O,EAAI4C,SAASC,cAAc,KAAM7C,EAAE8C,KAAOR,EAAKtC,EAAE+C,SAAWL,EAAUE,SAASI,KAAKC,YAAYjD,GAAIA,EAAEkD,QAASlD,EAAEmD,SAAUZ,IAAIa,gBAAgBd,EACvJ,CAAE,MAAOrR,GAASiB,GAAa,OAADjB,QAAC,IAADA,OAAC,EAADA,EAAGiC,UAAW,mBAAoBd,EAAiB,SAAUJ,GAAa,EAAO,GA4YnEqR,CAAYlT,GAAYub,kBAAmB/R,GAAI,CAACC,GAAG,GAAGpC,SAAC,kBAC7FK,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACE,QAASA,KACf,MAAMsL,EAAKV,SAASW,eAAe,iBACnC,IAAKD,EAAqF,OAA/EpR,EAAY,oBAAqBE,EAAiB,aAASJ,GAAa,GACnF,MAAMwR,EAAS,iRAAAjP,OAAoR+O,EAAGG,UAAS,0YACzSC,EAAMC,OAAOxU,KAAK,GAAI,UAC5B,IAAKuU,EAEH,IAAK,IAADE,EACF,MAAMC,EAASjB,SAASC,cAAc,UAAWgB,EAAOpM,MAAMsG,SAAS,QAAS8F,EAAOpM,MAAMuG,MAAM,IAAK6F,EAAOpM,MAAMqM,OAAO,IAAKD,EAAOpM,MAAMkK,MAAM,IAAKkC,EAAOpM,MAAMgK,OAAO,IAAKoC,EAAOpM,MAAMsM,OAAO,IAAKnB,SAASI,KAAKC,YAAYY,GACrO,MAAMG,EAA2B,QAAvBJ,EAAGC,EAAOI,qBAAa,IAAAL,OAAA,EAApBA,EAAsBhB,SAAU,IAAKoB,EAAM,MAAM,IAAI1N,MAAM,0BAA2B0N,EAAK7U,OAAQ6U,EAAKE,MAAMV,GAAYQ,EAAKG,QAAS,MAAMC,EAAWA,KAAQ,IAAK,IAADC,EAAAC,EAAsB,QAApBD,EAAAR,EAAOI,qBAAa,IAAAI,GAApBA,EAAsBpN,QAA6B,QAApBqN,EAAAT,EAAOI,qBAAa,IAAAK,GAApBA,EAAsBC,OAAS,CAAE,MAAOtT,GAAKiB,EAAY,0BAA2BE,EAAiB,SAAUJ,GAAa,EAAO,CAAE8E,WAAW,KAAQ,IAAM8L,SAASI,KAAKwB,YAAYX,EAAS,CAAE,MAAO5S,GAAI,GAAK,MACjX,OAArD4S,EAAOY,OAASL,OAAUtN,WAAWsN,EAAU,IACjD,CAAE,MAAOnT,GAA6I,OAApIiB,EAAY,wEAAyEE,EAAiB,cAAUJ,GAAa,EAAe,CAEhK0R,EAAId,SAASzT,OAAQuU,EAAId,SAASsB,MAAMV,GAAYE,EAAId,SAASuB,SAChEpM,QAAQ,YAAWP,SAAC,+BAI3BK,EAAAA,EAAAA,KAACgN,EAAAA,EAAQ,CAAC1V,KAAM4C,EAAW+S,iBAAkB,IAAMpH,QAASA,IAAM1L,GAAa,GAAOwF,UACpFK,EAAAA,EAAAA,KAACkN,EAAAA,EAAK,CAACC,SAAU7S,EAAewH,GAAI,CAAEgI,MAAO,QAASnK,SAAEvF,UC/qBhE,SAASub,EAAQrI,GAAmC,IAAlC,SAAE3N,EAAQ,MAAEmH,EAAK,MAAE8O,GAAYtI,EAChD,OAAOtN,EAAAA,EAAAA,KAAA,OAAK6V,KAAK,WAAWC,OAAQhP,IAAU8O,EAAMjW,SAAEmH,IAAU8O,IAAS5V,EAAAA,EAAAA,KAACN,EAAAA,EAAG,CAACzG,EAAG,EAAE0G,SAAEA,KACtF,CAEA,MAmBA,EAnB+BoW,KAC9B,MAAOC,EAAKC,GAAUjX,EAAAA,SAAe,GACpC,OACCS,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAAAC,SAAA,EACHK,EAAAA,EAAAA,KAAA,MAAAL,SAAI,0BACLK,EAAAA,EAAAA,KAAC+R,EAAAA,EAAK,CAAApS,UACLF,EAAAA,EAAAA,MAACyW,EAAAA,EAAI,CAACpP,MAAOkP,EAAKrT,SAAUA,CAACvJ,EAAGgE,IAAM6Y,EAAO7Y,GAAI+Y,eAAe,UAAUC,UAAU,UAASzW,SAAA,EAC5FK,EAAAA,EAAAA,KAACqW,EAAAA,EAAG,CAACzP,MAAM,sBACX5G,EAAAA,EAAAA,KAACqW,EAAAA,EAAG,CAACzP,MAAM,0BACX5G,EAAAA,EAAAA,KAACqW,EAAAA,EAAG,CAACzP,MAAM,yBAGb5G,EAAAA,EAAAA,KAAC2V,EAAQ,CAAC7O,MAAOkP,EAAKJ,MAAO,EAAEjW,UAACK,EAAAA,EAAAA,KAACvJ,EAAe,OAChDuJ,EAAAA,EAAAA,KAAC2V,EAAQ,CAAC7O,MAAOkP,EAAKJ,MAAO,EAAEjW,UAACK,EAAAA,EAAAA,KAACoN,EAAmB,OACpDpN,EAAAA,EAAAA,KAAC2V,EAAQ,CAAC7O,MAAOkP,EAAKJ,MAAO,EAAEjW,UAACK,EAAAA,EAAAA,KAAC4Q,EAAa,S,iBCxB1C,SAAS9N,EAAqBwT,GACnC,IAAKA,EAAO,MAAO,GACnB,MAAM/W,EAAqB,kBAAV+W,EAAqB,IAAInV,KAAKmV,GAASA,EACxD,GAAI3a,OAAOD,MAAM6D,EAAEgX,WAAY,MAAO,GACtC,MAAMC,EAAK1d,OAAOyG,EAAEkX,WAAa,GAAGC,SAAS,EAAG,KAC1CC,EAAK7d,OAAOyG,EAAEqX,WAAWF,SAAS,EAAG,KACrCG,EAAO/d,OAAOyG,EAAEuX,eACtB,MAAM,GAANpa,OAAU8Z,EAAE,KAAA9Z,OAAIia,EAAE,KAAAja,OAAIma,EACxB,C","sources":["pages/PaymentVouchers.tsx","pages/DisbursementReports.tsx","hooks/useCrud.ts","pages/CheckVouchers.tsx","pages/APManagement.tsx","utils/date.ts"],"sourcesContent":["import React, { useState, useContext, useRef, useCallback } from 'react';\nimport { Box, Button, Dialog, DialogTitle, DialogContent, DialogActions, TextField, Select, MenuItem, FormControl, InputLabel, Snackbar, Alert, CircularProgress, IconButton, Table, TableHead, TableRow, TableCell, TableBody, Checkbox } from '@mui/material';\nimport CloseIcon from '@mui/icons-material/Close';\nimport axios from 'axios';\nimport { UserContext, User } from '../UserContext';\nimport { buildUrl, tryFetchWithFallback, API_BASE as RESOLVED_API_BASE } from '../apiBase';\nimport { formatDateToMMDDYYYY } from '../utils/date';\nconsole.debug && console.debug('PaymentVouchers: resolved API_BASE =', RESOLVED_API_BASE || '(empty, using fallback)');\n\ninterface PaymentLine { payee_id?: string | number; payee_contact_id?: number | null; payee_name?: string; payee_display?: string; description?: string; amount?: number | string }\ninterface JournalLine { coa_id?: string | number | null; debit?: number | string; credit?: number | string; remarks?: string }\ninterface PVForm {\n  status?: string;\n  preparation_date?: string | null;\n  purpose?: string;\n  paid_through?: string;\n  prepared_by?: number | string | null;\n  prepared_by_manual?: string | null;\n  description?: string;\n  payment_lines?: PaymentLine[];\n  journal_lines?: JournalLine[];\n  reviewed_by?: number | string;\n  reviewed_by_manual?: string;\n  approved_by?: number | string;\n  approved_by_manual?: string;\n}\n\nconst emptyForm: PVForm = {\n  status: 'Draft',\n  preparation_date: '',\n  purpose: '',\n  paid_through: '',\n  prepared_by: null,\n  description: '',\n  payment_lines: [],\n  journal_lines: [],\n};\n\nconst PaymentVouchers: React.FC = () => {\n  const { user } = useContext(UserContext);\n  const [items, setItems] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  // Contacts and COA lists\n  const [contacts, setContacts] = useState<any[]>([]);\n  const [coas, setCoas] = useState<any[]>([]);\n\n  // Dialog state\n  const [open, setOpen] = useState(false);\n  const [editing, setEditing] = useState<any | null>(null);\n  const [form, setForm] = useState<PVForm>(emptyForm);\n  const [expectedControl, setExpectedControl] = useState<string>('');\n  const firstFocusRef = useRef<HTMLInputElement | null>(null);\n  const [companyProfile, setCompanyProfile] = useState<any>(null);\n  const [userNames, setUserNames] = useState<Record<string, string>>({});\n  const [previewOpen, setPreviewOpen] = useState(false);\n  const [previewItem, setPreviewItem] = useState<any | null>(null);\n\n  // Helper: parse signatory value which may be a number, string, JSON array string like '[\"1\"]', or an array\n  const parseSignatoryValue = (val:any): string[] => {\n    if (val === undefined || val === null || val === '') return [];\n    if (Array.isArray(val)) return val.map(String).filter(Boolean);\n    if (typeof val === 'number') return [String(val)];\n    if (typeof val === 'string') {\n      // Try JSON parse (handles '[\"1\"]' or '[1]')\n      try {\n        const p = JSON.parse(val);\n        if (Array.isArray(p)) return p.map(String).filter(Boolean);\n        if (typeof p === 'number' || typeof p === 'string') return [String(p)];\n      } catch (e) {\n        // not JSON\n      }\n      // Try extract first numeric id from string like '[1]' or '1'\n      const m = val.match(/\\d+/);\n      if (m) return [m[0]];\n      // otherwise treat as manual name (no numeric ids)\n      return [];\n    }\n    return [];\n  };\n\n  // Helper: render signatory display using userNames cache when possible, fallback to manual string\n  const getSignatoryDisplay = (val:any): string => {\n    const ids = parseSignatoryValue(val);\n    if (ids.length) {\n      return ids.map(id => userNames[String(id)] || String(id)).join(', ');\n    }\n    // fallback to raw string (manual name)\n    if (val && typeof val === 'string') return val;\n    return '';\n  };\n\n  // Delete confirmation\n  const [deleteId, setDeleteId] = useState<number | null>(null);\n  const [confirmOpen, setConfirmOpen] = useState(false);\n\n  // Multi-select (previously used for DR creation)\n  const [selected, setSelected] = useState<Record<number, boolean>>({});\n\n  // Snackbar\n  const [snackOpen, setSnackOpen] = useState(false);\n  const [snackMsg, setSnackMsg] = useState('');\n  const [snackSeverity, setSnackSeverity] = useState<'success' | 'error' | 'info'>('info');\n\n  const fetchAll = useCallback(async () => {\n    setLoading(true);\n    try {\n      // Fetch payment vouchers, contacts, and coas independently so one failure doesn't block the others\n  let pvResData: Array<any> = [];\n      try {\n  const pvRes = await axios.get(buildUrl('/api/payment-vouchers'));\n        pvResData = Array.isArray(pvRes.data) ? pvRes.data : [];\n      } catch (err:any) {\n        console.error('payment-vouchers fetch error', err?.response?.data || err.message || err);\n        // keep pvResData as empty array\n      }\n      setItems(pvResData);\n      // Seed userNames cache from any prepared_by_username in the fetched PVs\n      try {\n        const seed: Record<string,string> = {};\n        const idsToFetch = new Set<string>();\n        for (const p of pvResData) {\n          if (p.prepared_by_username) seed[String(p.prepared_by)] = p.prepared_by_username;\n          else if (p.prepared_by && !isNaN(Number(p.prepared_by))) {\n            const sid = String(p.prepared_by);\n            // queue numeric ids that we don't already have in cache\n            if (!userNames[sid]) idsToFetch.add(sid);\n          }\n        }\n        if (Object.keys(seed).length) setUserNames(prev => ({ ...prev, ...seed }));\n        if (idsToFetch.size) {\n          const token = localStorage.getItem('token');\n          await Promise.all(Array.from(idsToFetch).map(async id => {\n            try {\n              const r = await axios.get(buildUrl(`/api/users/${id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n              if (r && r.data) setUserNames(prev => ({ ...prev, [id]: r.data.full_name || r.data.username || id }));\n            } catch (e) {\n              // don't block others; leave id unresolved\n            }\n          }));\n        }\n      } catch (e) {}\n\n      // Contacts\n  let fetchedContacts: Array<{ contact_id: number; display_name: string; contact_type?: string }> = [];\n      try {\n  const contactRes = await axios.get(buildUrl('/api/contacts'));\n        fetchedContacts = Array.isArray(contactRes.data) ? contactRes.data : [];\n      } catch (err:any) {\n        console.error('contacts fetch error', err?.response?.data || err.message || err);\n        fetchedContacts = [];\n      }\n\n      // if no contacts returned, try vendors as fallback\n      if (fetchedContacts.length === 0) {\n        try {\n          const vendRes = await axios.get(buildUrl('/api/vendors'));\n          const vendors = Array.isArray(vendRes.data) ? vendRes.data : [];\n          // Map vendors to contact-like shape\n          const mapped = vendors.map(v => ({ contact_id: v.vendor_id, display_name: v.name, contact_type: 'Vendor' }));\n          console.log('contacts empty; using vendors fallback count=', mapped.length, mapped.slice(0,5));\n          setContacts(mapped);\n        } catch (e:any) {\n          console.error('vendors fallback fetch error', e?.response?.data || e.message || e);\n          setContacts([]);\n        }\n      } else {\n        console.log('contacts fetched count=', fetchedContacts.length, fetchedContacts.slice(0,5));\n        setContacts(fetchedContacts);\n      }\n\n      // COA\n      try {\n  const coaRes = await axios.get(buildUrl('/api/coa/all/simple'));\n        const c = Array.isArray(coaRes.data) ? coaRes.data : [];\n        console.log('coas fetched count=', c.length, c.slice(0,5));\n        setCoas(c);\n      } catch (err:any) {\n        console.warn('coa fetch primary failed, trying fallback', err?.response?.data || err.message || err);\n        try {\n          const fb = await axios.get(buildUrl('/api/coa/all/simple/fallback'));\n          const c2 = Array.isArray(fb.data) ? fb.data : [];\n          console.log('coa fetched fallback count=', c2.length, c2.slice(0,5));\n          setCoas(c2);\n        } catch (err2:any) {\n          console.error('coa fetch fallback failed', err2?.response?.data || err2.message || err2);\n          setCoas([]);\n        }\n      }\n    } catch (e:any) {\n      console.error('fetchAll error', e);\n    } finally { setLoading(false); }\n  }, [userNames]);\n\n  const fetchCoas = async () => {\n    try {\n      // Use the same simple fetch style as `Contacts.tsx` for consistent behavior\n  const res = await tryFetchWithFallback('/api/coa/all/simple');\n      if (!res.ok) throw new Error(`COA primary fetch failed: ${res.status}`);\n      const data = await res.json();\n      const c = Array.isArray(data) ? data : [];\n      setCoas(c);\n      return c;\n    } catch (err:any) {\n      console.warn('coa fetch primary failed, trying fallback', err?.message || err);\n      try {\n  const fbRes = await tryFetchWithFallback('/api/coa/all/simple/fallback');\n        if (!fbRes.ok) throw new Error(`COA fallback fetch failed: ${fbRes.status}`);\n        const data2 = await fbRes.json();\n        const c2 = Array.isArray(data2) ? data2 : [];\n        setCoas(c2);\n        return c2;\n      } catch (err2:any) {\n        console.error('coa fetch fallback failed', err2?.message || err2);\n        setCoas([]);\n        return [];\n      }\n    }\n  };\n\n  const fetchContacts = async () => {\n    try {\n  const contactRes = await axios.get(buildUrl('/api/contacts'));\n      const fetchedContacts = Array.isArray(contactRes.data) ? contactRes.data : [];\n      if (!fetchedContacts || fetchedContacts.length === 0) {\n        // fallback to vendors\n        try {\n          const vendRes = await axios.get(buildUrl('/api/vendors'));\n          const vendors = Array.isArray(vendRes.data) ? vendRes.data : [];\n          const mapped = vendors.map((v:any) => ({ contact_id: v.vendor_id, display_name: v.name, contact_type: 'Vendor' }));\n          setContacts(mapped);\n          return mapped;\n        } catch (e:any) {\n          console.error('vendors fallback fetch error', e?.response?.data || e.message || e);\n          setContacts([]);\n          return [];\n        }\n      }\n      setContacts(fetchedContacts);\n      return fetchedContacts;\n    } catch (err:any) {\n      console.error('contacts fetch error', err?.response?.data || err.message || err);\n      setContacts([]);\n      return [];\n    }\n  };\n\n  const openNew = async () => {\n    await Promise.all([fetchContacts(), fetchCoas()]);\n    // compute expected control based on current count (matches backend behavior)\n    try {\n  const res = await axios.get(buildUrl('/api/payment-vouchers/simple'));\n      const rows = Array.isArray(res.data) ? res.data : [];\n      setExpectedControl(`PV-${rows.length + 1}`);\n    } catch (e:any) {\n      console.warn('failed to compute expected control', e?.response?.data || e.message || e);\n      setExpectedControl('');\n    }\n    setEditing(null);\n    // Refresh current user from server to ensure workflow fields are up-to-date\n  let refreshedUser: User | null = null;\n    try {\n      const token = localStorage.getItem('token');\n      const resp = await axios.get(buildUrl('/api/auth/me'), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n      if (resp && resp.data) refreshedUser = resp.data;\n    } catch (e) {\n      // fallback to local context\n      refreshedUser = user as User | null;\n    }\n    // derive signatories from refreshed user's workflow settings (prefer id then manual)\n  let reviewed_by_val: number | string = '';\n  let approved_by_val: number | string = '';\n    try {\n      const me: User | null = refreshedUser as User | null;\n      if (me) {\n        const _me: User = me;\n        if (_me.reviewer_id) reviewed_by_val = _me.reviewer_id;\n        else if (_me.reviewer_manual) reviewed_by_val = _me.reviewer_manual as string;\n        if (_me.approver_id) approved_by_val = _me.approver_id;\n        else if (_me.approver_manual) approved_by_val = _me.approver_manual as string;\n      }\n      // seed userNames cache with current user's full_name for prepared_by\n      if (me && me.user_id) {\n        setUserNames(prev => ({ ...prev, [String(me.user_id)]: me.full_name || me.username || String(me.user_id) }));\n      }\n      // seed reviewer/approver names from refreshed user workflow if numeric\n      try {\n        const token = localStorage.getItem('token');\n        if (me && me.reviewer_id && !isNaN(Number(me.reviewer_id))) {\n          const rid = String(me.reviewer_id);\n          axios.get(buildUrl(`/api/users/${rid}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} })\n            .then(r => { if (r && r.data) setUserNames(prev => ({ ...prev, [rid]: r.data.full_name || r.data.username || rid })); })\n            .catch(() => {});\n        }\n        if (me && me.approver_id && !isNaN(Number(me.approver_id))) {\n          const aid = String(me.approver_id);\n          axios.get(buildUrl(`/api/users/${aid}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} })\n            .then(r => { if (r && r.data) setUserNames(prev => ({ ...prev, [aid]: r.data.full_name || r.data.username || aid })); })\n            .catch(() => {});\n        }\n      } catch (e) {}\n    } catch (e) {}\n\n    setForm({\n      ...emptyForm,\n      preparation_date: new Date().toISOString().slice(0,10),\n      prepared_by: (refreshedUser && refreshedUser.user_id) ? refreshedUser.user_id : (user?.user_id || null),\n      reviewed_by: reviewed_by_val,\n      approved_by: approved_by_val,\n      // note: do not store separate display fields here; rely on userNames cache and user.full_name\n      // ensure at least one payment_line and one journal_line so selects render options\n      payment_lines: [{ payee_id: '', description: '', amount: 0 }],\n      journal_lines: [{ coa_id: '', debit: 0, credit: 0, remarks: '' }]\n    });\n    // If reviewed_by/approved_by are numeric IDs, resolve their full_name for display\n    try {\n      const token = localStorage.getItem('token');\n      if (reviewed_by_val && !isNaN(Number(reviewed_by_val))) {\n        const id = String(reviewed_by_val);\n        axios.get(buildUrl(`/api/users/${id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} })\n          .then(r => { if (r && r.data) {\n            setUserNames(prev => ({ ...prev, [id]: r.data.full_name || r.data.username || id }));\n          } })\n          .catch(() => { /* ignore - we'll fallback to manual string in rendering */ });\n      }\n      if (approved_by_val && !isNaN(Number(approved_by_val))) {\n        const id2 = String(approved_by_val);\n        axios.get(buildUrl(`/api/users/${id2}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} })\n          .then(r => { if (r && r.data) {\n            setUserNames(prev => ({ ...prev, [id2]: r.data.full_name || r.data.username || id2 }));\n          } })\n          .catch(() => { /* ignore - manual fallback handled in UI */ });\n      }\n    } catch (e) {}\n    setOpen(true);\n  };\n  interface PVItem { payment_voucher_id?: number; payment_voucher_control?: string; payment_lines?: PaymentLine[]; journal_lines?: JournalLine[]; reviewer_id?: number | string; reviewer_manual?: string; approver_id?: number | string; approver_manual?: string; reviewed_by?: number | string; reviewed_by_manual?: string; approved_by?: number | string; approved_by_manual?: string; prepared_by?: number | string; preparation_date?: string | null }\n  const openEdit = async (pv: PVItem) => {\n    await Promise.all([fetchContacts(), fetchCoas()]);\n    setEditing(pv);\n    setExpectedControl(pv.payment_voucher_control || '');\n\n    // Determine reviewer/approver values: prefer PV-level fields; if missing, fall back to current user's workflow so the form is actually filled\n    const pvReviewer = pv.reviewer_id || pv.reviewer_manual || pv.reviewed_by || pv.reviewed_by_manual || '';\n    const pvApprover = pv.approver_id || pv.approver_manual || pv.approved_by || pv.approved_by_manual || '';\n    const reviewerValue = pvReviewer || (user && ((user as User).reviewer_id || (user as User).reviewer_manual)) || '';\n    const approverValue = pvApprover || (user && ((user as User).approver_id || (user as User).approver_manual)) || '';\n\n    setForm({\n      ...pv,\n      preparation_date: pv.preparation_date && typeof pv.preparation_date === 'string' && pv.preparation_date.indexOf('T') !== -1 ? pv.preparation_date.slice(0,10) : pv.preparation_date,\n      payment_lines: pv.payment_lines && pv.payment_lines.length ? pv.payment_lines.map((pl:any) => ({ payee_id: pl.payee_contact_id ? String(pl.payee_contact_id) : (pl.payee_id || ''), payee_name: pl.payee_display || pl.payee_name || '', description: pl.description || '', amount: pl.amount || 0 })) : [{ payee_id: '', description: '', amount: 0 }],\n      journal_lines: pv.journal_lines && pv.journal_lines.length ? pv.journal_lines : [{ coa_id: '', debit: 0, credit: 0, remarks: '' }],\n      reviewed_by: reviewerValue,\n      approved_by: approverValue\n    });\n    // Seed userNames cache for the values we've set so the displayed labels show full names when possible\n    try {\n      const token = localStorage.getItem('token');\n      const idsToResolve: string[] = [];\n      const rid = reviewerValue || '';\n      const aid = approverValue || '';\n      const pid = pv.prepared_by || '';\n      if (rid && !isNaN(Number(rid))) idsToResolve.push(String(rid));\n      if (aid && !isNaN(Number(aid))) idsToResolve.push(String(aid));\n      if (pid && !isNaN(Number(pid))) idsToResolve.push(String(pid));\n      if (idsToResolve.length) {\n        await Promise.all(Array.from(new Set(idsToResolve)).map(async id => {\n          try {\n            const r = await axios.get(buildUrl(`/api/users/${id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n            if (r && r.data) setUserNames(prev => ({ ...prev, [id]: r.data.full_name || r.data.username || id }));\n          } catch (e) { /* ignore individual failures */ }\n        }));\n      }\n    } catch (e) {}\n\n    setOpen(true);\n  };\n\n  // Prefetch data on mount for the overview and dialog selects\n  React.useEffect(() => {\n    fetchAll();\n  }, [fetchAll]);\n\n  // When dialog opens, move focus into the dialog to avoid leaving focus\n  // on an element that will be aria-hidden (prevents accessibility console warnings).\n  React.useEffect(() => {\n    if (open) {\n      // slight delay to allow dialog to mount\n      setTimeout(() => { try { firstFocusRef.current?.focus(); } catch (e) {} }, 0);\n    }\n  }, [open]);\n\n  React.useEffect(() => {\n    // fetch company profile for header\n    tryFetchWithFallback('/api/company-profile', { cache: 'no-store' })\n      .then(r => r.ok ? r.json().then(d => setCompanyProfile(d)) : setCompanyProfile(null))\n      .catch(() => setCompanyProfile(null));\n  }, []);\n\n  const downloadPdf = async (pvId: number | string | undefined) => {\n    if (!pvId) return;\n    try {\n      const token = localStorage.getItem('token');\n  const headers: Record<string, string> = {};\n      if (token) headers.Authorization = `Bearer ${token}`;\n  const resp = await tryFetchWithFallback(`/api/payment-vouchers/${pvId}/pdf`, { headers });\n      if (!resp.ok) {\n        const txt = await resp.text();\n        let msg = txt;\n        try { msg = JSON.parse(txt).error || txt; } catch (e) { msg = txt; }\n        setSnackMsg(msg || `PDF request failed: ${resp.status}`);\n        setSnackSeverity('error'); setSnackOpen(true);\n        return;\n      }\n      const ct = resp.headers.get('content-type') || '';\n      if (!ct.includes('application/pdf')) {\n        const txt = await resp.text();\n        let msg = txt;\n        try { msg = JSON.parse(txt).error || txt; } catch (e) { msg = txt; }\n        setSnackMsg(msg || 'Server did not return a PDF'); setSnackSeverity('error'); setSnackOpen(true);\n        return;\n      }\n      const blob = await resp.blob();\n      const url = URL.createObjectURL(blob);\n      const disp = resp.headers.get('content-disposition') || '';\n      let filename = 'voucher.pdf';\n      const m = /filename=\"?([^\";]+)\"?/.exec(disp);\n      if (m && m[1]) filename = m[1];\n      const a = document.createElement('a');\n      a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove();\n      URL.revokeObjectURL(url);\n    } catch (e:any) {\n      setSnackMsg(e?.message || 'Download failed'); setSnackSeverity('error'); setSnackOpen(true);\n    }\n  };\n\n  \n\n  const confirmDelete = (id: number) => { setDeleteId(id); setConfirmOpen(true); };\n  const doDelete = async () => {\n    if (deleteId == null) return;\n    try {\n      const token = localStorage.getItem('token');\n  await axios.delete(buildUrl(`/api/payment-vouchers/${deleteId}`), { headers: { Authorization: `Bearer ${token}` } });\n      setSnackMsg('Deleted'); setSnackSeverity('success'); setSnackOpen(true);\n      setConfirmOpen(false); setDeleteId(null);\n      fetchAll();\n    } catch (e:any) {\n      setSnackMsg(e.response?.data?.error || e.message || 'Delete failed'); setSnackSeverity('error'); setSnackOpen(true);\n    }\n  };\n\n  const toggleSelect = (id: number) => setSelected(prev => ({ ...prev, [id]: !prev[id] }));\n\n  // createDR removed  feature deprecated\n\n  return (\n    <Box>\n      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>\n        <h3>Payment Vouchers</h3>\n        <div>\n          <Button variant=\"contained\" onClick={openNew} sx={{mr:1}}>New PV</Button>\n          <Button onClick={() => fetchAll()} sx={{mr:1}}>Refresh</Button>\n          <Button color=\"secondary\" variant=\"outlined\" onClick={() => setSelected({})}>Clear Selection</Button>\n        </div>\n      </div>\n\n      {loading ? <CircularProgress /> : (\n        <Table>\n          <TableHead>\n            <TableRow>\n              <TableCell></TableCell>\n              <TableCell>PV Ctrl</TableCell>\n              <TableCell>Prepared</TableCell>\n              <TableCell>Prepared Date</TableCell>\n              <TableCell>Purpose</TableCell>\n              <TableCell>Amount</TableCell>\n              <TableCell>Actions</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {items.map(pv => (\n              <TableRow key={pv.payment_voucher_id}>\n                <TableCell><Checkbox checked={!!selected[pv.payment_voucher_id]} onChange={() => toggleSelect(pv.payment_voucher_id)} /></TableCell>\n                <TableCell>{pv.payment_voucher_control}</TableCell>\n                <TableCell>{pv.prepared_by_username || (pv.prepared_by && !isNaN(Number(pv.prepared_by)) ? (userNames[String(pv.prepared_by)] || String(pv.prepared_by)) : (pv.prepared_by || ''))}</TableCell>\n                <TableCell>{formatDateToMMDDYYYY(pv.preparation_date)}</TableCell>\n                <TableCell>{pv.purpose || '-'}</TableCell>\n                <TableCell>{pv.amount_to_pay || (pv.payment_lines && pv.payment_lines.length ? pv.payment_lines.reduce((s:any,l:any)=>s + (Number(l.amount)||0),0) : 0)}</TableCell>\n                <TableCell>\n                  <Button size=\"small\" onClick={() => openEdit(pv)} sx={{mr:1}}>Edit</Button>\n                  <Button size=\"small\" color=\"error\" onClick={() => confirmDelete(pv.payment_voucher_id)} sx={{mr:1}}>Delete</Button>\n                  <Button size=\"small\" onClick={async () => {\n                    try {\n                      // Ensure company profile is available\n                      if (!companyProfile) {\n                        const r = await tryFetchWithFallback('/api/company-profile', { cache: 'no-store' });\n                        if (r.ok) {\n                          const d = await r.json();\n                          setCompanyProfile(d);\n                        }\n                      }\n\n                      // First try to fetch the server-enriched single PV which should include\n                      // prepared_by_name, reviewed_by_name, approved_by_name and account_name on journal lines.\n                      let serverPV: any = null;\n                      try {\n                        const token = localStorage.getItem('token');\n                        const resp = await axios.get(buildUrl(`/api/payment-vouchers/${pv.payment_voucher_id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n                        if (resp && resp.data) serverPV = resp.data;\n                      } catch (e) {\n                        // server fetch failed; we'll fallback to local enrichment below\n                        serverPV = null;\n                      }\n\n                      // If server provided an enriched PV, prefer it as the base for preview\n                      const basePV = serverPV || pv;\n\n                      // Resolve COA account_name for journal lines using local `coas` cache when missing\n                      const resolvedJournal = (basePV.journal_lines || []).map((j:any) => {\n                        const copy = { ...j };\n                        if (!copy.account_name) {\n                          const cid = copy.coa_id || copy.coa;\n                          if (cid !== undefined && cid !== null && coas && coas.length) {\n                            const found = coas.find((c:any) => String(c.coa_id) === String(cid) || String(c.coa_id) === String((copy.coa_id || '')));\n                            if (found) copy.account_name = found.account_name || found.name || '';\n                          }\n                        }\n                        return copy;\n                      });\n\n                      const enrichedPV = { ...basePV, journal_lines: resolvedJournal };\n\n                      // If server did not provide signatory names, fetch numeric user names as needed\n                      const fetchedNames: Record<string,string> = {};\n                      try {\n                        const maybe = (val:any) => (val !== undefined && val !== null) ? val : '';\n                        const ridVals = parseSignatoryValue(maybe(enrichedPV.reviewer_id) || maybe(enrichedPV.reviewer_manual) || maybe(enrichedPV.reviewed_by) || maybe(enrichedPV.reviewed_by_manual) || '');\n                        const aidVals = parseSignatoryValue(maybe(enrichedPV.approver_id) || maybe(enrichedPV.approver_manual) || maybe(enrichedPV.approved_by) || maybe(enrichedPV.approved_by_manual) || '');\n                        const pidVals = parseSignatoryValue(maybe(enrichedPV.prepared_by) || maybe(enrichedPV.prepared_by_manual) || '');\n                        const idsToFetch = new Set<string>();\n                        for (const id of [...ridVals, ...aidVals, ...pidVals]) {\n                          if (id && !userNames[String(id)]) idsToFetch.add(String(id));\n                        }\n                        if (idsToFetch.size) {\n                          const token = localStorage.getItem('token');\n                          await Promise.all(Array.from(idsToFetch).map(async id => {\n                            try {\n                              const r = await axios.get(buildUrl(`/api/users/${id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n                              if (r && r.data) fetchedNames[id] = r.data.full_name || r.data.username || id;\n                            } catch (e) {\n                              // ignore\n                            }\n                          }));\n                          if (Object.keys(fetchedNames).length) setUserNames(prev => ({ ...prev, ...fetchedNames }));\n                        }\n                      } catch (e) { /* ignore */ }\n\n                      // Ensure reviewed_by_name and approved_by_name are present, preferring server values\n                      if (!enrichedPV.prepared_by_name) {\n                        const vals = parseSignatoryValue(enrichedPV.prepared_by || enrichedPV.prepared_by_manual || '');\n                        if (vals && vals.length) enrichedPV.prepared_by_name = userNames[vals[0]] || fetchedNames[vals[0]] || String(vals[0]);\n                        else enrichedPV.prepared_by_name = enrichedPV.prepared_by_manual || '';\n                      }\n                      if (!enrichedPV.reviewed_by_name) {\n                        const vals = parseSignatoryValue(enrichedPV.reviewer_id || enrichedPV.reviewer_manual || enrichedPV.reviewed_by || enrichedPV.reviewed_by_manual || '');\n                        if (vals && vals.length) enrichedPV.reviewed_by_name = userNames[vals[0]] || fetchedNames[vals[0]] || String(vals[0]);\n                        else enrichedPV.reviewed_by_name = enrichedPV.reviewer_manual || enrichedPV.reviewed_by_manual || '';\n                      }\n                      if (!enrichedPV.approved_by_name) {\n                        const vals = parseSignatoryValue(enrichedPV.approver_id || enrichedPV.approver_manual || enrichedPV.approved_by || enrichedPV.approved_by_manual || '');\n                        if (vals && vals.length) enrichedPV.approved_by_name = userNames[vals[0]] || fetchedNames[vals[0]] || String(vals[0]);\n                        else enrichedPV.approved_by_name = enrichedPV.approver_manual || enrichedPV.approved_by_manual || '';\n                      }\n\n                      // Expose the server-provided source flags on the enriched item so the UI can show where names came from\n                      // (server returns `reviewerSource` and `approverSource` when available)\n                      if (basePV && basePV.reviewerSource) enrichedPV.reviewerSource = basePV.reviewerSource;\n                      if (basePV && basePV.approverSource) enrichedPV.approverSource = basePV.approverSource;\n\n                      setPreviewItem(enrichedPV);\n                    } catch (e) {\n                      // fallback to original PV if anything goes wrong\n                      try { setPreviewItem(pv); } catch (ex) { setPreviewItem(null); }\n                    }\n                    setPreviewOpen(true);\n                  }}>Preview</Button>\n                </TableCell>\n              </TableRow>\n            ))}\n            {items.length === 0 && (\n              <TableRow><TableCell colSpan={7}>No payment vouchers found.</TableCell></TableRow>\n            )}\n          </TableBody>\n        </Table>\n      )}\n\n      {/* 'Create DR from selected' removed  feature deprecated */}\n\n      <Dialog open={open} onClose={() => setOpen(false)} fullWidth maxWidth=\"lg\">\n        <DialogTitle>{editing ? `Edit Payment Voucher (${expectedControl || (editing && editing.payment_voucher_control) || ''})` : `New Payment Voucher${expectedControl ? ' (expected: ' + expectedControl + ')' : ''}`}<IconButton aria-label=\"close\" onClick={() => setOpen(false)} sx={{position:'absolute', right:8, top:8}}><CloseIcon /></IconButton></DialogTitle>\n        <DialogContent>\n          {/* Basic Details */}\n          <Box sx={{display:'grid', gridTemplateColumns: '1fr 1fr', gap: 2, mb:2}}>\n            <TextField inputRef={firstFocusRef} label=\"Preparation Date\" type=\"date\" value={form.preparation_date || ''} onChange={e => setForm({...form, preparation_date: e.target.value})} InputLabelProps={{ shrink: true }} />\n            <FormControl>\n              <InputLabel id=\"purpose-label\">Purpose</InputLabel>\n              <Select labelId=\"purpose-label\" value={form.purpose || ''} label=\"Purpose\" onChange={e => setForm({...form, purpose: e.target.value})}>\n                <MenuItem value=\"\">-- Select Purpose --</MenuItem>\n                <MenuItem value=\"Bills Payment\">Bills Payment</MenuItem>\n                <MenuItem value=\"Liquidation Payouts\">Liquidation Payouts</MenuItem>\n                <MenuItem value=\"Government and Other Agency Payments\">Government and Other Agency Payments</MenuItem>\n                <MenuItem value=\"OSM Request\">OSM Request</MenuItem>\n                <MenuItem value=\"Cash Advance / Budget Request\">Cash Advance / Budget Request</MenuItem>\n                <MenuItem value=\"Other Payments\">Other Payments</MenuItem>\n              </Select>\n            </FormControl>\n          </Box>\n\n          {/* Payment Details - dynamic rows */}\n          <Box sx={{mt:2, mb:2}}>\n            <Box sx={{fontWeight:700, mb:1}}>PAYMENT DETAILS</Box>\n            <Table size=\"small\">\n              <TableHead>\n                <TableRow>\n                  <TableCell>Payee</TableCell>\n                  <TableCell>Description</TableCell>\n                  <TableCell align=\"right\">Amount to Pay</TableCell>\n                  <TableCell></TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {(form.payment_lines || []).map((line:any, idx:number) => (\n                  <TableRow key={idx}>\n                    <TableCell sx={{minWidth:200}}>\n                      <Select fullWidth value={line.payee_id || line.payee || ''} onChange={e => {\n                        const v = e.target.value; const copy = {...form}; copy.payment_lines = copy.payment_lines || [];\n                        copy.payment_lines[idx] = { ...(copy.payment_lines[idx] || {}), payee_id: v, payee_name: contacts.find(c=>String(c.contact_id)===String(v))?.display_name || '' };\n                        setForm(copy);\n                      }}>\n                        <MenuItem value=\"\">-- Select Payee --</MenuItem>\n                        {contacts.map(c => (\n                          <MenuItem key={c.contact_id} value={String(c.contact_id)}>\n                            {c.display_name}\n                            {c.contact_type ? ` (${c.contact_type})` : ''}\n                          </MenuItem>\n                        ))}\n                      </Select>\n                    </TableCell>\n                    <TableCell>\n                      <TextField fullWidth value={line.description || ''} onChange={e => { const copy = {...form}; copy.payment_lines = copy.payment_lines || []; copy.payment_lines[idx] = { ...(copy.payment_lines[idx] || {}), description: e.target.value }; setForm(copy); }} />\n                    </TableCell>\n                    <TableCell align=\"right\">\n                      <TextField type=\"number\" value={line.amount || ''} onChange={e => { const copy = {...form}; copy.payment_lines = copy.payment_lines || []; copy.payment_lines[idx] = { ...(copy.payment_lines[idx] || {}), amount: e.target.value }; setForm(copy); }} InputProps={{ sx: { textAlign: 'right' } }} />\n                    </TableCell>\n                    <TableCell>\n                      <Button color=\"error\" onClick={() => { const copy = {...form}; copy.payment_lines = copy.payment_lines || []; copy.payment_lines = copy.payment_lines.filter((_:any,i:number)=>i!==idx); setForm(copy); }}>Remove</Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n            <Box sx={{mt:1}}>\n              <Button onClick={() => {\n                const copy = {...form};\n                copy.payment_lines = copy.payment_lines || [];\n                copy.payment_lines.push({payee_id:'', description:'', amount:0});\n                setForm(copy);\n              }}>+ Add another line</Button>\n            </Box>\n            <Box sx={{mt:2, textAlign:'right', fontWeight:700}}>Total Amount to Pay: PHP {(form.payment_lines || []).reduce((s:any,l:any)=>s + (Number(l.amount)||0), 0)}</Box>\n          </Box>\n\n          {/* Journal Entry - dynamic rows */}\n          <Box sx={{mt:2, mb:2}}>\n            <Box sx={{fontWeight:700, mb:1}}>JOURNAL ENTRY</Box>\n            <Table size=\"small\">\n              <TableHead>\n                <TableRow>\n                  <TableCell>COA</TableCell>\n                  <TableCell>Debit</TableCell>\n                  <TableCell>Credit</TableCell>\n                  <TableCell>Remarks</TableCell>\n                  <TableCell></TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {(form.journal_lines || []).map((line:any, idx:number) => (\n                  <TableRow key={idx}>\n                    <TableCell sx={{minWidth:200}}>\n                      <Select fullWidth value={String(line.coa_id || '')} onChange={e => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines[idx] = { ...(copy.journal_lines[idx] || {}), coa_id: e.target.value }; setForm(copy); }}>\n                        <MenuItem value=\"\">-- Select COA --</MenuItem>\n                        {coas.map((a:any) => <MenuItem key={a.coa_id} value={String(a.coa_id)}>{a.account_name || a.name || a.coa_id}</MenuItem>)}\n                      </Select>\n                    </TableCell>\n                    <TableCell>\n                      <TextField fullWidth value={line.debit || ''} onChange={e => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines[idx] = { ...(copy.journal_lines[idx] || {}), debit: e.target.value }; setForm(copy); }} InputProps={{ sx: { textAlign: 'right' } }} />\n                    </TableCell>\n                    <TableCell>\n                      <TextField fullWidth value={line.credit || ''} onChange={e => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines[idx] = { ...(copy.journal_lines[idx] || {}), credit: e.target.value }; setForm(copy); }} InputProps={{ sx: { textAlign: 'right' } }} />\n                    </TableCell>\n                    <TableCell>\n                      <TextField fullWidth value={line.remarks || ''} onChange={e => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines[idx] = { ...(copy.journal_lines[idx] || {}), remarks: e.target.value }; setForm(copy); }} />\n                    </TableCell>\n                    <TableCell>\n                      <Button color=\"error\" onClick={() => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines = copy.journal_lines.filter((_:any,i:number)=>i!==idx); setForm(copy); }}>Remove</Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n            <Box sx={{mt:1}}>\n              <Button onClick={() => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines.push({coa_id:'', debit:0, credit:0, remarks:''}); setForm(copy); }}>+ Add another line</Button>\n            </Box>\n            <Box sx={{mt:2, textAlign:'right'}}>\n              <div><strong>Total Debit</strong> PHP {(form.journal_lines || []).reduce((s:any,l:any)=>s + (Number(l.debit)||0), 0)}</div>\n              <div><strong>Total Credit</strong> PHP {(form.journal_lines || []).reduce((s:any,l:any)=>s + (Number(l.credit)||0), 0)}</div>\n            </Box>\n          </Box>\n\n          {/* Signatories */}\n          <Box sx={{mt:2, mb:2}}>\n            <Box sx={{fontWeight:700, mb:1}}>SIGNATORIES</Box>\n            <Box sx={{display:'grid', gridTemplateColumns: '1fr 1fr 1fr', gap:2}}>\n                <TextField label=\"Prepared By\" value={getSignatoryDisplay(form.prepared_by || form.prepared_by_manual || user?.user_id)} disabled />\n                <TextField label=\"Reviewed By\" value={getSignatoryDisplay(form.reviewed_by || form.reviewed_by_manual || (user && ((user as User).reviewer_id || (user as User).reviewer_manual)))} onChange={e => setForm({...form, reviewed_by: e.target.value})} />\n                <TextField label=\"Approved By\" value={getSignatoryDisplay(form.approved_by || form.approved_by_manual || (user && ((user as User).approver_id || (user as User).approver_manual)))} onChange={e => setForm({...form, approved_by: e.target.value})} />\n              </Box>\n          </Box>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setOpen(false)}>Cancel</Button>\n          <Button onClick={async () => {\n            // Validation rules\n            if (!form.purpose) { setSnackMsg('Purpose is required'); setSnackSeverity('error'); setSnackOpen(true); return; }\n            if (!form.payment_lines || form.payment_lines.length === 0) { setSnackMsg('At least one payment line is required'); setSnackSeverity('error'); setSnackOpen(true); return; }\n            if (!form.journal_lines || form.journal_lines.length < 2) { setSnackMsg('At least two journal entry lines are required'); setSnackSeverity('error'); setSnackOpen(true); return; }\n            if (!form.reviewed_by || !form.approved_by) { setSnackMsg('Reviewed by and Approved by must be filled'); setSnackSeverity('error'); setSnackOpen(true); return; }\n            // Totals check optional: ensure debit == credit\n            const totalDebit = (form.journal_lines || []).reduce((s:any,l:any)=>s + (Number(l.debit)||0), 0);\n            const totalCredit = (form.journal_lines || []).reduce((s:any,l:any)=>s + (Number(l.credit)||0), 0);\n            if (totalDebit !== totalCredit) { setSnackMsg('Total Debit and Total Credit must be equal'); setSnackSeverity('error'); setSnackOpen(true); return; }\n            // Prepare payload mapping lines to expected backend fields (flatten payment_lines into a simplified array)\n            // Map payment lines to backend field names: payee_contact_id and payee_display\n            const mappedPaymentLines = (form.payment_lines || []).map((l:any) => {\n              const contactId = l.payee_id || l.payee_contact_id || '';\n              const display = l.payee_name || l.payee_display || (contacts.find((c:any) => String(c.contact_id) === String(contactId))?.display_name) || '';\n              return { payee_contact_id: contactId ? Number(contactId) : null, payee_display: display, description: l.description, amount: Number(l.amount) };\n            });\n\n            // Determine reviewer/approver numeric vs manual\n            const determineSignatory = (val:any) => {\n              if (val === undefined || val === null || val === '') return { id: null, manual: null };\n              if (!isNaN(Number(val))) return { id: Number(val), manual: null };\n              // if value looks like JSON array with numeric id\n              try {\n                const p = JSON.parse(val);\n                if (Array.isArray(p) && p.length && !isNaN(Number(p[0]))) return { id: Number(p[0]), manual: null };\n              } catch (e) {}\n              return { id: null, manual: String(val) };\n            };\n\n            const reviewerSpec = determineSignatory(form.reviewed_by || form.reviewed_by_manual || '');\n            const approverSpec = determineSignatory(form.approved_by || form.approved_by_manual || '');\n\n            const payload = {\n              status: form.status || 'Draft',\n              preparation_date: form.preparation_date,\n              purpose: form.purpose,\n              paid_through: form.paid_through || 'Bank',\n              prepared_by: user?.user_id || null,\n              description: form.description || '',\n              payment_lines: mappedPaymentLines,\n              journal_lines: (form.journal_lines || []).map((l:any) => ({ coa_id: l.coa_id || null, debit: Number(l.debit)||0, credit: Number(l.credit)||0, remarks: l.remarks || '' })),\n              // include both id/manual variants and let backend persist whichever is provided\n              reviewer_id: reviewerSpec.id,\n              reviewer_manual: reviewerSpec.manual,\n              approver_id: approverSpec.id,\n              approver_manual: approverSpec.manual\n            };\n            try {\n              const token = localStorage.getItem('token');\n              if (editing) {\n                await axios.put(buildUrl(`/api/payment-vouchers/${editing.payment_voucher_id}`), payload, { headers: { Authorization: `Bearer ${token}` } });\n                setSnackMsg('Payment Voucher updated'); setSnackSeverity('success'); setSnackOpen(true); setOpen(false); fetchAll();\n              } else {\n                const res = await axios.post(buildUrl('/api/payment-vouchers'), payload, { headers: { Authorization: `Bearer ${token}` } });\n                const ctrl = res.data && res.data.payment_voucher_control ? res.data.payment_voucher_control : null;\n                setSnackMsg(ctrl ? `Payment Voucher created (${ctrl})` : 'Payment Voucher created'); setSnackSeverity('success'); setSnackOpen(true); setOpen(false); fetchAll();\n              }\n            } catch (err:any) { setSnackMsg(err.response?.data?.error || err.message || 'Save failed'); setSnackSeverity('error'); setSnackOpen(true); }\n          }} variant=\"contained\">Save</Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Preview / Print dialog */}\n      <Dialog open={previewOpen} onClose={() => setPreviewOpen(false)} fullWidth maxWidth=\"md\">\n        <DialogTitle>Preview Payment Voucher</DialogTitle>\n        <DialogContent>\n          {previewItem ? (\n            <div id=\"pv-print-area\" style={{padding:20, fontFamily: 'Arial, sans-serif', color: '#000'}}>\n              <div style={{display:'flex', justifyContent:'space-between', alignItems:'center', marginBottom:20}}>\n                <div>\n                  <div style={{fontSize:20, fontWeight:700}}>{companyProfile?.company_name || companyProfile?.name || 'Company Name'}</div>\n                  <div style={{fontSize:12}}>{companyProfile?.address || ''}</div>\n                </div>\n                <div>\n                  {companyProfile?.logo ? <img src={companyProfile.logo} alt=\"logo\" style={{height:60}} /> : null}\n                </div>\n              </div>\n              <hr />\n              <div style={{display:'flex', justifyContent:'space-between', marginTop:10}}>\n                <div>\n                  <div><strong>PV Ctrl:</strong> {previewItem.payment_voucher_control}</div>\n                  <div><strong>Prepared:</strong> {formatDateToMMDDYYYY(previewItem.preparation_date)}</div>\n                  <div><strong>Purpose:</strong> {previewItem.purpose}</div>\n                </div>\n                <div style={{textAlign:'right'}}>\n                  <div><strong>Amount:</strong> PHP {previewItem.amount_to_pay || (previewItem.payment_lines && previewItem.payment_lines.length ? previewItem.payment_lines.reduce((s:any,l:any)=>s + (Number(l.amount)||0),0) : 0)}</div>\n                </div>\n              </div>\n              <div style={{marginTop:20}}>\n                <div style={{fontWeight:700}}>Payment Details</div>\n                <table style={{width:'100%', borderCollapse:'collapse', marginTop:8}}>\n                  <thead>\n                    <tr><th style={{borderBottom:'1px solid #ccc', textAlign:'left'}}>Payee</th><th style={{borderBottom:'1px solid #ccc', textAlign:'left'}}>Description</th><th style={{borderBottom:'1px solid #ccc', textAlign:'right'}}>Amount</th></tr>\n                  </thead>\n                  <tbody>\n                    {(previewItem.payment_lines || []).map((l:any, i:number) => (\n                      <tr key={i}><td style={{padding:'6px 0'}}>{l.payee_display || l.payee_name || l.payee_contact_id || '-'}</td><td style={{padding:'6px 0'}}>{l.description || ''}</td><td style={{padding:'6px 0', textAlign:'right'}}>{Number(l.amount).toFixed(2)}</td></tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div style={{marginTop:20}}>\n                <div style={{fontWeight:700}}>Journal Entries</div>\n                <table style={{width:'100%', borderCollapse:'collapse', marginTop:8}}>\n                  <thead>\n                    <tr><th style={{borderBottom:'1px solid #ccc', textAlign:'left'}}>COA</th><th style={{borderBottom:'1px solid #ccc', textAlign:'right'}}>Debit</th><th style={{borderBottom:'1px solid #ccc', textAlign:'right'}}>Credit</th></tr>\n                  </thead>\n                  <tbody>\n                    {(previewItem.journal_lines || []).map((j:any, i:number) => (\n                      <tr key={i}><td style={{padding:'6px 0'}}>{j.account_name || j.coa_name || ''}</td><td style={{padding:'6px 0', textAlign:'right'}}>{Number(j.debit||0).toFixed(2)}</td><td style={{padding:'6px 0', textAlign:'right'}}>{Number(j.credit||0).toFixed(2)}</td></tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div style={{marginTop:20}}>\n                <div style={{display:'flex', justifyContent:'space-between'}}>\n                  <div style={{textAlign:'center', width:'30%'}}>\n                    <div style={{fontWeight:700}}>Prepared By</div>\n                    <div style={{marginTop:24}}>__________________</div>\n                    <div style={{marginTop:8, fontSize:12}}>{previewItem.prepared_by_name || getSignatoryDisplay(previewItem.prepared_by || previewItem.prepared_by_manual || '')}</div>\n                  </div>\n                  <div style={{textAlign:'center', width:'30%'}}>\n                    <div style={{fontWeight:700}}>Reviewed By</div>\n                    <div style={{marginTop:24}}>__________________</div>\n                    <div style={{marginTop:8, fontSize:12}}>{previewItem.reviewed_by_name || getSignatoryDisplay(previewItem.reviewed_by || previewItem.reviewed_by_manual || '')}</div>\n                  </div>\n                  <div style={{textAlign:'center', width:'30%'}}>\n                    <div style={{fontWeight:700}}>Approved By</div>\n                    <div style={{marginTop:24}}>__________________</div>\n                    <div style={{marginTop:8, fontSize:12}}>{previewItem.approved_by_name || getSignatoryDisplay(previewItem.approved_by || previewItem.approved_by_manual || '')}</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ) : <div>No preview data</div>}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setPreviewOpen(false)}>Close</Button>\n          <Button onClick={() => previewItem && downloadPdf(previewItem.payment_voucher_id)} sx={{mr:1}}>Download PDF</Button>\n          <Button onClick={() => {\n            const el = document.getElementById('pv-print-area');\n            if (!el) {\n              setSnackMsg('Nothing to print'); setSnackSeverity('info'); setSnackOpen(true); return;\n            }\n            // Embed a small script that triggers print when the new window finishes loading.\n            // This avoids calling print asynchronously from the opener (which many browsers block).\n            const printHtml = `<!doctype html><html><head><meta charset=\"utf-8\"><title>Payment Voucher</title><style>body{font-family: Arial, sans-serif; color:#000; padding:20px;} table{width:100%;border-collapse:collapse;} th,td{padding:6px 4px;} th{border-bottom:1px solid #ccc;}</style></head><body>${el.innerHTML}<script> (function(){ function doPrint(){ try{ window.focus(); window.print(); }catch(e){ console.error('Print failed', e); } } if(document.readyState==='complete'){ setTimeout(doPrint,50); } else { window.addEventListener('load', function(){ setTimeout(doPrint,50); }); } window.addEventListener('afterprint', function(){ try{ window.close(); }catch(e){} }); })(); </script></body></html>`;\n            const win = window.open('', '_blank');\n            if (!win) {\n              // Popup blocked  fallback to printing via a hidden iframe which is less likely to be blocked.\n              try {\n                const iframe = document.createElement('iframe');\n                iframe.style.position = 'fixed'; iframe.style.right = '0'; iframe.style.bottom = '0'; iframe.style.width = '0'; iframe.style.height = '0'; iframe.style.border = '0';\n                document.body.appendChild(iframe);\n                const idoc = iframe.contentWindow?.document;\n                if (!idoc) throw new Error('iframe doc unavailable');\n                idoc.open();\n                idoc.write(printHtml);\n                idoc.close();\n                const tryPrint = () => {\n                  try { iframe.contentWindow?.focus(); iframe.contentWindow?.print(); } catch (e) { console.error('Iframe print failed', e); setSnackMsg('Print failed in iframe'); setSnackSeverity('error'); setSnackOpen(true); }\n                  setTimeout(() => { try { document.body.removeChild(iframe); } catch (e) {} }, 500);\n                };\n                // Some browsers need onload\n                iframe.onload = tryPrint;\n                // fallback timeout\n                setTimeout(tryPrint, 800);\n                return;\n              } catch (e:any) {\n                console.error('Print fallback failed', e);\n                setSnackMsg('Popup blocked and fallback failed. Allow popups or use Download PDF.'); setSnackSeverity('error'); setSnackOpen(true);\n                return;\n              }\n            }\n            win.document.open();\n            win.document.write(printHtml);\n            win.document.close();\n          }} variant=\"contained\">Print / Save as PDF</Button>\n        </DialogActions>\n      </Dialog>\n\n      <Dialog open={confirmOpen} onClose={() => setConfirmOpen(false)}>\n        <DialogTitle>Confirm Delete</DialogTitle>\n        <DialogContent>Are you sure you want to delete this payment voucher?</DialogContent>\n        <DialogActions>\n          <Button onClick={() => setConfirmOpen(false)}>Cancel</Button>\n          <Button color=\"error\" onClick={doDelete}>Delete</Button>\n        </DialogActions>\n      </Dialog>\n\n      <Snackbar open={snackOpen} autoHideDuration={4000} onClose={() => setSnackOpen(false)}>\n        <Alert severity={snackSeverity} sx={{ width: '100%' }}>{snackMsg}</Alert>\n      </Snackbar>\n    </Box>\n  );\n};\n\nexport default PaymentVouchers;\n","import React, { useState, useEffect } from 'react';\nimport { useCrud } from '../hooks/useCrud';\nimport axios from 'axios';\nimport { Snackbar, Alert, CircularProgress, Dialog, DialogTitle, DialogContent, DialogActions, Button } from '@mui/material';\nimport { buildUrl, API_BASE as RESOLVED_API_BASE } from '../apiBase';\nimport { formatDateToMMDDYYYY } from '../utils/date';\nconsole.debug && console.debug('DisbursementReports: resolved API_BASE =', RESOLVED_API_BASE || '(empty, using fallback)');\n\nexport default function DisbursementReports() {\n  const { data: reports, loading, error, fetchAll } = useCrud<any>({ endpoint: '/api/disbursement-reports' });\n  const [expanded, setExpanded] = useState({} as Record<number, boolean>);\n  const [pvList, setPvList] = useState<any[]>([]);\n  const [selected, setSelected] = useState<Record<number, boolean>>({});\n  const [creating, setCreating] = useState(false);\n\n  useEffect(() => {\n  // fetch available payment vouchers\n  axios.get(buildUrl('/api/payment-vouchers')).then(r => setPvList(r.data)).catch(() => {});\n  }, []);\n\n  React.useEffect(() => { fetchAll(); }, [fetchAll]);\n\n  // Snackbar state\n  const [snackOpen, setSnackOpen] = useState(false);\n  const [snackMsg, setSnackMsg] = useState('');\n  const [snackSeverity, setSnackSeverity] = useState<'success'|'error'|'info'>('info');\n  const [submitModalOpen, setSubmitModalOpen] = useState(false);\n  const [currentReport, setCurrentReport] = useState<any>(null);\n  const [routingInfo, setRoutingInfo] = useState<any>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [cascadeNow, setCascadeNow] = useState(false);\n\n  if (loading) return <div>Loading...</div>;\n  if (error) return <div>Error loading reports</div>;\n\n  return (\n    <div>\n      <h2>Disbursement Reports</h2>\n      <button onClick={() => fetchAll()}>Refresh</button>\n      <div style={{display:'flex',gap: '2rem'}}>\n        <div style={{flex:1}}>\n          <h3>Available Payment Vouchers</h3>\n          <div>\n            <button onClick={() => setSelected({})}>Clear</button>\n            <button onClick={() => axios.get(buildUrl('/api/payment-vouchers')).then(r => setPvList(r.data)).catch(() => {})}>Refresh</button>\n          </div>\n          <ul>\n            {pvList.map(pv => (\n              <li key={pv.payment_voucher_id} style={{display:'flex',alignItems:'center',gap:'0.5rem'}}>\n                <input type=\"checkbox\" checked={!!selected[pv.payment_voucher_id]} onChange={() => setSelected(prev=>({...prev,[pv.payment_voucher_id]: !prev[pv.payment_voucher_id]}))} />\n                <div>{pv.payment_voucher_control}  {pv.payee_name || (pv.payment_lines && pv.payment_lines[0] && (pv.payment_lines[0].payee_display || pv.payment_lines[0].payee_contact_id)) || ''}  {pv.amount_to_pay || (pv.payment_lines && pv.payment_lines.length ? pv.payment_lines.reduce((s:any,l:any)=>s + (Number(l.amount)||0),0) : 0)}</div>\n              </li>\n            ))}\n          </ul>\n          <div>\n            <button disabled={creating} onClick={async () => {\n              const ids = Object.keys(selected).filter(k=>selected[+k]).map(k=>+k);\n              if (ids.length === 0) {\n                setSnackMsg('Select at least one PV');\n                setSnackSeverity('info');\n                setSnackOpen(true);\n                return;\n              }\n              const amount_to_pay = pvList.filter(p => ids.includes(p.payment_voucher_id)).reduce((s, p) => s + (Number(p.amount_to_pay) || (p.payment_lines && p.payment_lines.length ? p.payment_lines.reduce((ss:any,l:any)=>ss + (Number(l.amount)||0),0) : 0)), 0);\n              setCreating(true);\n              try {\n                const token = localStorage.getItem('token');\n                await axios.post(buildUrl('/api/disbursement-reports'), {\n                  status: 'Draft',\n                  disbursement_date: new Date().toISOString().slice(0,10),\n                  purpose: 'Bulk created from UI',\n                  amount_to_pay,\n                  paid_through: 'Bank',\n                  voucher_ids: ids\n                }, { headers: { Authorization: `Bearer ${token}` } });\n                setSnackMsg('Disbursement Report created');\n                setSnackSeverity('success');\n                setSnackOpen(true);\n                fetchAll();\n                setSelected({});\n              } catch (e:any) {\n                setSnackMsg(e.response?.data?.error || e.message || 'Create failed');\n                setSnackSeverity('error');\n                setSnackOpen(true);\n              } finally { setCreating(false); }\n            }}>{creating ? <><CircularProgress size={16} /> Creating...</> : 'Create DR from selected'}</button>\n          </div>\n        </div>\n        <div style={{flex:2}}>\n          <h2>Disbursement Reports</h2>\n          <button onClick={() => fetchAll()}>Refresh</button>\n          <ul>\n            {reports && reports.map((r: any) => (\n          <li key={r.disbursement_report_id} style={{marginBottom: '1rem'}}>\n            <div style={{display:'flex',justifyContent:'space-between'}}>\n              <div>\n                <strong>{r.disbursement_report_ctrl_number}</strong>  {formatDateToMMDDYYYY(r.disbursement_date)}  {r.status}\n              </div>\n              <div>\n                  <button onClick={() => setExpanded(prev => ({...prev, [r.disbursement_report_id]: !prev[r.disbursement_report_id]}))}>\n                    {expanded[r.disbursement_report_id] ? 'Hide' : 'Show'} Vouchers\n                  </button>\n                  <button style={{marginLeft:8}} onClick={async () => {\n                    // fetch routing preview\n                    try {\n                      const res = await axios.get(`/api/disbursement-reports/${r.disbursement_report_id}`);\n                      setCurrentReport(res.data);\n                      // call routing preview endpoint (reuse routeReport via submit with cascade=false and autoApprove=false?)\n                      const routeRes = await axios.post(`/api/disbursement-reports/${r.disbursement_report_id}/submit`, { cascade: false }, { headers: { Authorization: `Bearer ${localStorage.getItem('token')}` } }).then(x => x.data);\n                      setRoutingInfo(routeRes.routing || null);\n                      setSubmitModalOpen(true);\n                    } catch (e:any) {\n                      setSnackMsg(e.response?.data?.error || e.message || 'Routing preview failed');\n                      setSnackSeverity('error');\n                      setSnackOpen(true);\n                    }\n                  }}>Submit for Approval</button>\n              </div>\n            </div>\n            {expanded[r.disbursement_report_id] && (\n              <div style={{paddingLeft: '1rem', marginTop: '0.5rem'}}>\n                {r.vouchers && r.vouchers.length > 0 ? (\n                  <table style={{width:'100%',borderCollapse:'collapse'}}>\n                    <thead>\n                      <tr><th>PV Ctrl</th><th>Payee</th><th>Amount</th><th>Date</th></tr>\n                    </thead>\n                    <tbody>\n                      {r.vouchers.map((v: any) => (\n                        <tr key={v.payment_voucher_id}>\n                          <td>{v.payment_voucher_control}</td>\n                          <td>{v.payee_name || (v.payment_lines && v.payment_lines[0] && (v.payment_lines[0].payee_display || v.payment_lines[0].payee_contact_id)) || ''}</td>\n                          <td>{v.amount_to_pay || (v.payment_lines && v.payment_lines.length ? v.payment_lines.reduce((ss:any,l:any)=>ss + (Number(l.amount)||0),0) : 0)}</td>\n                          <td>{formatDateToMMDDYYYY(v.preparation_date)}</td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                ) : <div>No vouchers</div>}\n              </div>\n            )}\n          </li>\n        ))}\n          </ul>\n        </div>\n      </div>\n      <Snackbar open={snackOpen} autoHideDuration={4000} onClose={() => setSnackOpen(false)}>\n        <Alert severity={snackSeverity} sx={{ width: '100%' }}>{snackMsg}</Alert>\n      </Snackbar>\n      <Dialog open={submitModalOpen} onClose={() => setSubmitModalOpen(false)} maxWidth=\"sm\" fullWidth>\n        <DialogTitle>Submit Disbursement Report for Approval</DialogTitle>\n        <DialogContent>\n          {routingInfo ? (\n            <div>\n              <div><strong>Reviewer:</strong> {routingInfo.reviewer ? (routingInfo.reviewer.id || routingInfo.reviewer.manual) : 'None'}</div>\n              <div><strong>Approver:</strong> {routingInfo.approver ? (routingInfo.approver.id || routingInfo.approver.manual) : 'None'}</div>\n              <div style={{marginTop:8}}>\n                <label><input type=\"checkbox\" checked={cascadeNow} onChange={(e) => setCascadeNow(e.target.checked)} /> Cascade immediately if approver present</label>\n              </div>\n              {routingInfo.notes && routingInfo.notes.length > 0 && (\n                <div style={{marginTop:8}}><strong>Notes:</strong><ul>{routingInfo.notes.map((n:any,i:number)=>(<li key={i}>{n}</li>))}</ul></div>\n              )}\n            </div>\n          ) : <div>Loading routing info...</div>}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setSubmitModalOpen(false)}>Cancel</Button>\n          <Button color=\"primary\" variant=\"contained\" disabled={submitting} onClick={async () => {\n            if (!currentReport) return;\n            setSubmitting(true);\n            try {\n              const res = await axios.post(`/api/disbursement-reports/${currentReport.disbursement_report_id}/submit`, { cascade: cascadeNow }, { headers: { Authorization: `Bearer ${localStorage.getItem('token')}` } });\n              setSnackMsg(res.data.message || 'Submitted');\n              setSnackSeverity('success');\n              setSnackOpen(true);\n              setSubmitModalOpen(false);\n              fetchAll();\n            } catch (e:any) {\n              setSnackMsg(e.response?.data?.error || e.message || 'Submit failed');\n              setSnackSeverity('error');\n              setSnackOpen(true);\n            } finally { setSubmitting(false); }\n          }}>Submit</Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","import { useState, useCallback } from 'react';\nimport axios from 'axios';\nimport { buildUrl, API_BASE as RESOLVED_API_BASE } from '../apiBase';\n\nexport interface CrudOptions<T> {\n  endpoint: string; // e.g. '/api/contacts'\n  initialData?: T[];\n}\n\nexport function useCrud<T>({ endpoint, initialData = [] }: CrudOptions<T>) {\n  const [data, setData] = useState<T[]>(initialData);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  console.debug && console.debug('useCrud: resolved API_BASE =', RESOLVED_API_BASE || '(empty, using fallback)');\n\n  const makeUrl = (ep: string) => buildUrl(ep.startsWith('/') ? ep : '/' + ep);\n\n  const fetchAll = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const url = makeUrl(endpoint);\n      const res = await axios.get(url);\n      setData(res.data);\n    } catch (err: any) {\n      setError(err.response?.data?.message || err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, [endpoint]);\n\n  const add = useCallback(async (item: Partial<T>) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const url = makeUrl(endpoint);\n      await axios.post(url, item);\n      await fetchAll();\n    } catch (err: any) {\n      setError(err.response?.data?.message || err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, [endpoint, fetchAll]);\n\n  const update = useCallback(async (id: string | number, item: Partial<T>) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const url = makeUrl(`${endpoint}/${id}`);\n      await axios.put(url, item);\n      await fetchAll();\n    } catch (err: any) {\n      setError(err.response?.data?.message || err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, [endpoint, fetchAll]);\n\n  const remove = useCallback(async (id: string | number) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const url = makeUrl(`${endpoint}/${id}`);\n      await axios.delete(url);\n      await fetchAll();\n    } catch (err: any) {\n      setError(err.response?.data?.message || err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, [endpoint, fetchAll]);\n\n  return {\n    data,\n    loading,\n    error,\n    fetchAll,\n    add,\n    update,\n    remove,\n    setData,\n  };\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport { Box, Button, Dialog, DialogTitle, DialogContent, DialogActions, TextField, Select, MenuItem, Snackbar, Alert, IconButton, Table, TableHead, TableRow, TableCell, TableBody, Grid, Paper, Divider, Typography, Autocomplete } from '@mui/material';\nimport CloseIcon from '@mui/icons-material/Close';\nimport axios from 'axios';\nimport { tryFetchWithFallback, buildUrl } from '../apiBase';\nimport { formatDateToMMDDYYYY } from '../utils/date';\n\ntype PaymentLine = { payee_contact_id?: number | null; payee_display?: string; description?: string; amount?: number | string };\ntype JournalLine = { coa_id?: number | string | null; debit?: number | string; credit?: number | string; remarks?: string };\n\nconst emptyPaymentLine = (): PaymentLine => ({ payee_contact_id: null, payee_display: '', description: '', amount: 0 });\nconst emptyJournalLine = (): JournalLine => ({ coa_id: '', debit: 0, credit: 0, remarks: '' });\n\nconst CheckVouchers: React.FC = () => {\n  const [items, setItems] = useState<any[]>([]);\n  // loading is intentionally not used in the modal flow; keep local if needed in future\n  const [contacts, setContacts] = useState<any[]>([]);\n  const [coas, setCoas] = useState<any[]>([]);\n\n  // Dialog/form state modeled after PaymentVouchers modal\n  const [open, setOpen] = useState(false);\n  const [editing, setEditing] = useState<any | null>(null);\n  const [form, setForm] = useState<any>({});\n  const firstFocusRef = useRef<HTMLInputElement | null>(null);\n  const [snackOpen, setSnackOpen] = useState(false);\n  const [snackMsg, setSnackMsg] = useState('');\n  const [snackSeverity, setSnackSeverity] = useState<'success'|'error'|'info'>('info');\n  const [userNames, setUserNames] = useState<Record<string,string>>({});\n  const [userOptions, setUserOptions] = useState<Array<{user_id:number, full_name?:string, username?:string}>>([]);\n\n  const fetchList = async () => {\n    try {\n      const r = await tryFetchWithFallback('/api/check-vouchers');\n      if (r.ok) setItems(await r.json());\n      else setItems([]);\n    } catch (_) { setItems([]); }\n  };\n\n  useEffect(() => { fetchList(); }, []);\n\n  const fetchContacts = async () => {\n    try {\n      const r = await axios.get(buildUrl('/api/contacts'));\n      setContacts(Array.isArray(r.data) ? r.data : []);\n      return r.data;\n    } catch (e) { setContacts([]); return [] }\n  };\n  const fetchCoas = async () => {\n    try { const r = await axios.get(buildUrl('/api/coa/all/simple')); setCoas(Array.isArray(r.data)?r.data:[]); return r.data; } catch (e) { setCoas([]); return []; }\n  };\n\n  const fetchUserOptions = async () => {\n    try {\n      const r = await axios.get(buildUrl('/api/users/public'));\n      setUserOptions(Array.isArray(r.data) ? r.data : []);\n      // seed userNames cache\n      const map: Record<string,string> = {};\n      for (const u of (r.data||[])) { if (u && u.user_id) map[String(u.user_id)] = u.full_name || u.username || String(u.user_id); }\n      setUserNames(prev => ({ ...map, ...prev }));\n      return r.data;\n    } catch (e) { return []; }\n  };\n\n  const openNew = async () => {\n    await Promise.all([fetchContacts(), fetchCoas(), fetchUserOptions()]);\n    setEditing(null);\n    // seed current user into userNames cache when available\n    let currentUserId: number | null = null;\n    let reviewerVal: any = null;\n    let approverVal: any = null;\n    try {\n      const token = localStorage.getItem('token');\n      const meResp = await axios.get(buildUrl('/api/auth/me'), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n      if (meResp && meResp.data && meResp.data.user_id) {\n        currentUserId = meResp.data.user_id;\n        setUserNames(prev => ({ ...prev, [String(meResp.data.user_id)]: meResp.data.full_name || meResp.data.username || String(meResp.data.user_id) }));\n        // pull reviewer/approver from workflow\n        if (meResp.data.reviewer_id) reviewerVal = meResp.data.reviewer_id; else if (meResp.data.reviewer_manual) reviewerVal = meResp.data.reviewer_manual;\n        if (meResp.data.approver_id) approverVal = meResp.data.approver_id; else if (meResp.data.approver_manual) approverVal = meResp.data.approver_manual;\n        // resolve numeric names if needed\n        try {\n          const idsToResolve: string[] = [];\n          if (reviewerVal && !isNaN(Number(reviewerVal))) idsToResolve.push(String(reviewerVal));\n          if (approverVal && !isNaN(Number(approverVal))) idsToResolve.push(String(approverVal));\n          for (const id of Array.from(new Set(idsToResolve))) {\n            if (!userNames[id]) {\n              try {\n                const r = await axios.get(buildUrl(`/api/users/${id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n                if (r && r.data) setUserNames(prev => ({ ...prev, [id]: r.data.full_name || r.data.username || id }));\n              } catch (e) { /* ignore */ }\n            }\n          }\n        } catch (_) {}\n      }\n    } catch (e) {}\n    setForm({\n      cvoucher_date: new Date().toISOString().slice(0,10),\n      purpose: '',\n      payment_lines: [ emptyPaymentLine() ],\n      journal_lines: [ emptyJournalLine(), emptyJournalLine() ], // require at least two\n      // check lines for multi-check mode\n      mode: 'single',\n      check_lines: [],\n      prepared_by: currentUserId,\n      reviewed_by: reviewerVal,\n      approved_by: approverVal,\n      paid_through: 'Bank',\n      status: 'Draft'\n    });\n    setOpen(true);\n    setTimeout(()=>{ try { firstFocusRef.current?.focus(); } catch(e){} }, 0);\n  };\n\n  const openEdit = async (cv:any) => {\n    await Promise.all([fetchContacts(), fetchCoas(), fetchUserOptions()]);\n    setEditing(cv);\n    // Load current user to fallback reviewer/approver if CV missing values\n    let me: any = null;\n    try {\n      const token = localStorage.getItem('token');\n      const meResp = await axios.get(buildUrl('/api/auth/me'), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n      if (meResp && meResp.data) me = meResp.data;\n    } catch (_) {}\n\n    const reviewerValue = (cv.reviewer_id ?? cv.reviewed_by ?? cv.reviewer_manual ?? cv.reviewed_by_manual ?? null) ?? null;\n    const approverValue = (cv.approver_id ?? cv.approved_by ?? cv.approver_manual ?? cv.approved_by_manual ?? null) ?? null;\n    const resolvedReviewer = reviewerValue != null && reviewerValue !== '' ? reviewerValue : (me ? (me.reviewer_id ?? me.reviewer_manual ?? null) : null);\n    const resolvedApprover = approverValue != null && approverValue !== '' ? approverValue : (me ? (me.approver_id ?? me.approver_manual ?? null) : null);\n\n    setForm({\n      ...cv,\n      cvoucher_date: cv.cvoucher_date && typeof cv.cvoucher_date === 'string' && cv.cvoucher_date.indexOf('T') !== -1 ? cv.cvoucher_date.slice(0,10) : cv.cvoucher_date,\n      payment_lines: (cv.payment_lines && cv.payment_lines.length) ? cv.payment_lines.map((pl:any)=>({ payee_contact_id: pl.payee_contact_id, payee_display: pl.payee_display, description: pl.description, amount: pl.amount })) : [ emptyPaymentLine() ],\n      journal_lines: (cv.journal_lines && cv.journal_lines.length) ? cv.journal_lines.map((jl:any)=>({ coa_id: jl.coa_id, debit: jl.debit, credit: jl.credit, remarks: jl.remarks })) : [ emptyJournalLine(), emptyJournalLine() ],\n      mode: cv.multiple_checks ? 'multi' : 'single',\n      check_lines: cv.check_lines && cv.check_lines.length ? cv.check_lines.map((cl:any)=>({ check_date: cl.check_date, check_number: cl.check_number, check_amount: cl.check_amount, check_subpayee: cl.check_subpayee })) : [],\n      reviewed_by: resolvedReviewer,\n      approved_by: resolvedApprover\n    });\n    setOpen(true);\n    // seed signatory names cache for prepared/reviewed/approved if numeric IDs\n    try {\n      const token = localStorage.getItem('token');\n      const toResolve: string[] = [];\n      const maybe = (v:any) => (v !== undefined && v !== null) ? v : '';\n      const vals = [maybe(cv.prepared_by), maybe(cv.prepared_by_manual), maybe(resolvedReviewer), maybe(cv.reviewed_by_manual), maybe(resolvedApprover), maybe(cv.approved_by_manual)];\n      for (const v of vals) {\n        if (v && !isNaN(Number(v))) toResolve.push(String(v));\n      }\n      for (const id of Array.from(new Set(toResolve))) {\n        if (!userNames[id]) {\n          try { const r = await axios.get(buildUrl(`/api/users/${id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} }); if (r && r.data) setUserNames(prev => ({ ...prev, [id]: r.data.full_name || r.data.username || id })); } catch (e) { }\n        }\n      }\n    } catch (e) {}\n  };\n\n  const parseSignatoryValue = (val:any): string[] => {\n    if (val === undefined || val === null || val === '') return [];\n    if (Array.isArray(val)) return val.map(String).filter(Boolean);\n    if (typeof val === 'number') return [String(val)];\n    if (typeof val === 'string') {\n      try {\n        const p = JSON.parse(val);\n        if (Array.isArray(p)) return p.map(String).filter(Boolean);\n        if (typeof p === 'number' || typeof p === 'string') return [String(p)];\n      } catch (e) {}\n      const m = val.match(/\\d+/);\n      if (m) return [m[0]];\n      return [];\n    }\n    return [];\n  };\n\n  const getSignatoryDisplay = (val:any): string => {\n    const ids = parseSignatoryValue(val);\n    if (ids.length) return ids.map(id => userNames[String(id)] || String(id)).join(', ');\n    if (val && typeof val === 'string') return val;\n    return '';\n  };\n\n  const resetForm = () => { setForm({}); setEditing(null); setOpen(false); };\n\n  const save = async () => {\n    // Validation similar to PaymentVouchers\n    if (!form.purpose) { setSnackMsg('Purpose is required'); setSnackSeverity('error'); setSnackOpen(true); return; }\n    if (!form.payment_lines || form.payment_lines.length === 0) { setSnackMsg('At least one payment line is required'); setSnackSeverity('error'); setSnackOpen(true); return; }\n    if (!form.journal_lines || form.journal_lines.length < 2) { setSnackMsg('At least two journal entry lines are required'); setSnackSeverity('error'); setSnackOpen(true); return; }\n  // totalPay computed implicitly via totals below when needed\n    const totalDebit = (form.journal_lines || []).reduce((s:any,l:any)=>s + (Number(l.debit)||0), 0);\n    const totalCredit = (form.journal_lines || []).reduce((s:any,l:any)=>s + (Number(l.credit)||0), 0);\n    if (totalDebit !== totalCredit) { setSnackMsg('Total Debit and Total Credit must be equal'); setSnackSeverity('error'); setSnackOpen(true); return; }\n\n    // Map payment lines\n    const mappedPaymentLines = (form.payment_lines || []).map((l:any) => ({ payee_contact_id: l.payee_contact_id ? Number(l.payee_contact_id) : null, payee_display: l.payee_display || (contacts.find((c:any)=>String(c.contact_id)===String(l.payee_contact_id))?.display_name) || '', description: l.description || '', amount: Number(l.amount)||0 }));\n    const mappedJournalLines = (form.journal_lines || []).map((l:any)=>({ coa_id: l.coa_id || null, debit: Number(l.debit)||0, credit: Number(l.credit)||0, remarks: l.remarks || '' }));\n\n    const payload: any = {\n      status: form.status || 'Draft',\n      cvoucher_date: form.cvoucher_date,\n      purpose: form.purpose,\n      paid_through: form.paid_through || 'Bank',\n      prepared_by: form.prepared_by || null,\n      description: form.description || '',\n      payment_lines: mappedPaymentLines,\n      journal_lines: mappedJournalLines\n    };\n    // map reviewers/approvers: numeric -> reviewer_id/approver_id, free text -> reviewer_manual/approver_manual\n    const parseReviewer = (v:any) => {\n      if (v === null || v === undefined || v === '') return { id: null, manual: null };\n      if (!isNaN(Number(v))) return { id: Number(v), manual: null };\n      return { id: null, manual: String(v) };\n    };\n    const rv = parseReviewer(form.reviewed_by);\n    const av = parseReviewer(form.approved_by);\n    if (rv.id) payload.reviewer_id = rv.id; else if (rv.manual) payload.reviewer_manual = rv.manual;\n    if (av.id) payload.approver_id = av.id; else if (av.manual) payload.approver_manual = av.manual;\n    // keep legacy fields as well\n    payload.reviewed_by = form.reviewed_by || null;\n    payload.approved_by = form.approved_by || null;\n    // include check_lines if multi; for single mode include check_no and check_amount\n    if (form.mode === 'multi' && Array.isArray(form.check_lines)) {\n      payload.check_lines = (form.check_lines || []).map((c:any)=>({ check_number: c.check_number || c.check_no || null, check_date: c.check_date || null, check_amount: Number(c.check_amount)||0, check_subpayee: c.check_subpayee || null }));\n      payload.multiple_checks = 1;\n    } else {\n      payload.multiple_checks = 0;\n      // include single-check fields\n      if (form.check_no) payload.check_no = form.check_no;\n      // include top-level check_amount if present (otherwise backend computes from payment_lines)\n      if (form.check_amount || form.check_amount === 0) payload.check_amount = Number(form.check_amount);\n    }\n\n    try {\n      const token = localStorage.getItem('token');\n      if (editing && editing.check_voucher_id) {\n        await axios.put(buildUrl(`/api/check-vouchers/${editing.check_voucher_id}`), payload, { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n        setSnackMsg('Check Voucher updated'); setSnackSeverity('success'); setSnackOpen(true); setOpen(false); fetchList();\n      } else {\n        const res = await axios.post(buildUrl('/api/check-vouchers'), payload, { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n        const ctrl = res.data && res.data.check_voucher && res.data.check_voucher.check_voucher_control ? res.data.check_voucher.check_voucher_control : null;\n        setSnackMsg(ctrl ? `Check Voucher created (${ctrl})` : 'Check Voucher created'); setSnackSeverity('success'); setSnackOpen(true); setOpen(false); fetchList();\n      }\n    } catch (err:any) {\n      setSnackMsg(err.response?.data?.error || err.message || 'Save failed'); setSnackSeverity('error'); setSnackOpen(true);\n    }\n  };\n\n  // Preview / Print\n  const [previewOpen, setPreviewOpen] = useState(false);\n  const [previewItem, setPreviewItem] = useState<any | null>(null);\n  const downloadPdf = async (cvId: number | string | undefined) => {\n    if (!cvId) return;\n    try {\n      const token = localStorage.getItem('token');\n      const headers: Record<string,string> = {};\n      if (token) headers.Authorization = `Bearer ${token}`;\n      const resp = await tryFetchWithFallback(`/api/check-vouchers/${cvId}/pdf`, { headers });\n      if (!resp.ok) {\n        const txt = await resp.text();\n        let msg = txt;\n        try { msg = JSON.parse(txt).error || txt; } catch (e) { msg = txt; }\n        setSnackMsg(msg || `PDF request failed: ${resp.status}`); setSnackSeverity('error'); setSnackOpen(true); return;\n      }\n      const ct = resp.headers.get('content-type') || '';\n      if (!ct.includes('application/pdf')) {\n        const txt = await resp.text();\n        let msg = txt;\n        try { msg = JSON.parse(txt).error || txt; } catch (e) { msg = txt; }\n        setSnackMsg(msg || 'Server did not return a PDF'); setSnackSeverity('error'); setSnackOpen(true); return;\n      }\n      const blob = await resp.blob();\n      const url = URL.createObjectURL(blob);\n      const disp = resp.headers.get('content-disposition') || '';\n      let filename = 'check-voucher.pdf';\n      const m = /filename=\"?([^\";]+)\"?/.exec(disp);\n      if (m && m[1]) filename = m[1];\n      const a = document.createElement('a'); a.href = url; a.download = filename; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);\n    } catch (e:any) { setSnackMsg(e?.message || 'Download failed'); setSnackSeverity('error'); setSnackOpen(true); }\n  };\n\n  return (\n    <Box>\n      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>\n        <h3>Check Vouchers</h3>\n        <div>\n          <Button variant=\"contained\" onClick={openNew} sx={{mr:1}}>New CV</Button>\n          <Button onClick={() => fetchList()} sx={{mr:1}}>Refresh</Button>\n        </div>\n      </div>\n\n      <Grid container spacing={2}>\n        <Grid item xs={12} md={6}>\n          <Paper sx={{ p: 2 }}>\n            <Typography variant=\"h6\">Existing Check Vouchers</Typography>\n            <Divider sx={{ my: 1 }} />\n            <Box>\n              <ul>\n                {items.map(cv => (\n                  <li key={cv.check_voucher_id} style={{marginBottom:6}}>\n                    <strong>{cv.check_voucher_control}</strong>  {cv.check_payee || (cv.payment_lines && cv.payment_lines[0] && (cv.payment_lines[0].payee_display || cv.payment_lines[0].payee_name)) || ''}  PHP {cv.check_amount || (cv.payment_lines && cv.payment_lines.length ? cv.payment_lines.reduce((s:any,l:any)=>s + (Number(l.amount)||0),0) : 0)}\n                    <div style={{marginTop:4}}>\n                      <Button size=\"small\" onClick={() => openEdit(cv)} sx={{mr:1}}>Edit</Button>\n                      <Button size=\"small\" onClick={async () => {\n                        // Try fetch full server item then open enriched preview, ensuring signatory names are resolved\n                        try {\n                          const token = localStorage.getItem('token');\n                          const r = await axios.get(buildUrl(`/api/check-vouchers/${cv.check_voucher_id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n                          const base = r && r.data ? r.data : cv;\n                          const enriched = { ...base } as any;\n                          // If server did not attach company, try client-side best-effort\n                          if (!enriched.company) {\n                            try {\n                              const cr = await tryFetchWithFallback('/api/company-profile', { cache: 'no-store' });\n                              if (cr.ok) enriched.company = await cr.json();\n                            } catch (_) {}\n                          }\n                          // Resolve user names for numeric IDs if names missing\n                          const fetchedNames: Record<string,string> = {};\n                          const maybe = (v:any) => (v !== undefined && v !== null) ? v : '';\n                          const ids: string[] = [];\n                          const collect = (val:any) => { const m = parseSignatoryValue(val); if (m && m.length) ids.push(...m); };\n                          collect(maybe(enriched.prepared_by) || maybe(enriched.prepared_by_manual));\n                          collect(maybe(enriched.reviewed_by) || maybe(enriched.reviewer_id) || maybe(enriched.reviewed_by_manual) || maybe(enriched.reviewer_manual));\n                          collect(maybe(enriched.approved_by) || maybe(enriched.approver_id) || maybe(enriched.approved_by_manual) || maybe(enriched.approver_manual));\n                          const idsToFetch = Array.from(new Set(ids.filter(id => id && !userNames[id])));\n                          if (idsToFetch.length) {\n                            await Promise.all(idsToFetch.map(async id => {\n                              try { const ur = await axios.get(buildUrl(`/api/users/${id}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} }); if (ur && ur.data) fetchedNames[id] = ur.data.full_name || ur.data.username || id; } catch (_) {}\n                            }));\n                            if (Object.keys(fetchedNames).length) setUserNames(prev => ({ ...prev, ...fetchedNames }));\n                          }\n                          // Attach name fields when missing\n                          if (!enriched.prepared_by_name) {\n                            const vals = parseSignatoryValue(enriched.prepared_by || enriched.prepared_by_manual || '');\n                            enriched.prepared_by_name = (vals[0] && (userNames[vals[0]] || fetchedNames[vals[0]])) || enriched.prepared_by_manual || '';\n                          }\n                          if (!enriched.reviewed_by_name) {\n                            const vals = parseSignatoryValue(enriched.reviewed_by || enriched.reviewer_id || enriched.reviewed_by_manual || enriched.reviewer_manual || '');\n                            enriched.reviewed_by_name = (vals[0] && (userNames[vals[0]] || fetchedNames[vals[0]])) || enriched.reviewed_by_manual || enriched.reviewer_manual || '';\n                          }\n                          if (!enriched.approved_by_name) {\n                            const vals = parseSignatoryValue(enriched.approved_by || enriched.approver_id || enriched.approved_by_manual || enriched.approver_manual || '');\n                            enriched.approved_by_name = (vals[0] && (userNames[vals[0]] || fetchedNames[vals[0]])) || enriched.approved_by_manual || enriched.approver_manual || '';\n                          }\n                          // If still missing any names, fall back to current user's workflow settings\n                          if (!enriched.prepared_by_name || !enriched.reviewed_by_name || !enriched.approved_by_name) {\n                            try {\n                              const meR = await axios.get(buildUrl('/api/auth/me'), { headers: token ? { Authorization: `Bearer ${token}` } : {} });\n                              const me = meR && meR.data ? meR.data : null;\n                              if (me) {\n                                if (!enriched.prepared_by_name) enriched.prepared_by_name = me.full_name || me.username || '';\n                                const resolveIdToName = async (id:any) => {\n                                  if (id && !isNaN(Number(id))) {\n                                    const sid = String(id);\n                                    if (userNames[sid]) return userNames[sid];\n                                    try { const ur = await axios.get(buildUrl(`/api/users/${sid}`), { headers: token ? { Authorization: `Bearer ${token}` } : {} }); return ur && ur.data ? (ur.data.full_name || ur.data.username || sid) : sid; } catch { return sid; }\n                                  }\n                                  return String(id || '');\n                                };\n                                if (!enriched.reviewed_by_name) {\n                                  const rv = me.reviewer_id || me.reviewer_manual || '';\n                                  enriched.reviewed_by_name = await resolveIdToName(rv);\n                                }\n                                if (!enriched.approved_by_name) {\n                                  const av = me.approver_id || me.approver_manual || '';\n                                  enriched.approved_by_name = await resolveIdToName(av);\n                                }\n                              }\n                            } catch (_) {}\n                          }\n                          setPreviewItem(enriched);\n                        } catch (e) { setPreviewItem(cv); }\n                        setPreviewOpen(true);\n                      }}>Preview</Button>\n                    </div>\n                  </li>\n                ))}\n                {items.length === 0 && <li>No check vouchers found.</li>}\n              </ul>\n            </Box>\n          </Paper>\n        </Grid>\n      </Grid>\n\n      <Dialog open={open} onClose={() => setOpen(false)} fullWidth maxWidth=\"lg\">\n        <DialogTitle>{editing ? `Edit Check Voucher (${(editing && editing.check_voucher_control) || ''})` : `New Check Voucher`}<IconButton aria-label=\"close\" onClick={() => setOpen(false)} sx={{position:'absolute', right:8, top:8}}><CloseIcon /></IconButton></DialogTitle>\n        <DialogContent>\n          <Box sx={{display:'grid', gridTemplateColumns: '1fr 1fr', gap: 2, mb:2}}>\n            <TextField inputRef={firstFocusRef} label=\"Check Date\" type=\"date\" value={form.cvoucher_date || ''} onChange={e => setForm({...form, cvoucher_date: e.target.value})} InputLabelProps={{ shrink: true }} />\n            <TextField label=\"Purpose\" value={form.purpose || ''} onChange={e => setForm({...form, purpose: e.target.value})} />\n          </Box>\n\n          {/* Single check number field (only when mode is single) */}\n          {form.mode !== 'multi' && (\n            <Box sx={{mb:2}}>\n              <TextField label=\"Check Number\" value={form.check_no || ''} onChange={e => setForm({...form, check_no: e.target.value})} />\n            </Box>\n          )}\n\n          {/* Mode: single or multi checks */}\n          <Box sx={{my:1}}>\n            <Box>\n              <label style={{marginRight:12}}><input type=\"radio\" name=\"mode\" checked={form.mode !== 'multi'} onChange={()=>setForm({...form, mode: 'single'})} /> Single Check Voucher</label>\n              <label><input type=\"radio\" name=\"mode\" checked={form.mode === 'multi'} onChange={()=>setForm({...form, mode: 'multi'})} /> Multi-Check Voucher</label>\n            </Box>\n          </Box>\n\n          {/* Check lines for multi */}\n          {form.mode === 'multi' && (\n            <Box sx={{mt:2, mb:2}}>\n              <Typography variant=\"subtitle1\">Check Lines</Typography>\n              <Table size=\"small\">\n                <TableHead>\n                  <TableRow>\n                    <TableCell>Check Date</TableCell>\n                    <TableCell>Check No</TableCell>\n                    <TableCell>Payee</TableCell>\n                    <TableCell align=\"right\">Amount</TableCell>\n                    <TableCell></TableCell>\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {(form.check_lines || []).map((cl:any, idx:number) => (\n                    <TableRow key={idx}>\n                      <TableCell><TextField type=\"date\" value={cl.check_date || ''} onChange={e => { const copy = {...form}; copy.check_lines = copy.check_lines || []; copy.check_lines[idx] = { ...(copy.check_lines[idx]||{}), check_date: e.target.value }; setForm(copy); }} InputLabelProps={{ shrink: true }} /></TableCell>\n                      <TableCell><TextField value={cl.check_number || ''} onChange={e => { const copy = {...form}; copy.check_lines = copy.check_lines || []; copy.check_lines[idx] = { ...(copy.check_lines[idx]||{}), check_number: e.target.value }; setForm(copy); }} /></TableCell>\n                      <TableCell>\n                        <Select fullWidth value={String(cl.check_subpayee || '')} onChange={e => { const copy = {...form}; copy.check_lines = copy.check_lines || []; copy.check_lines[idx] = { ...(copy.check_lines[idx]||{}), check_subpayee: e.target.value ? Number(e.target.value) : null }; setForm(copy); }}>\n                          <MenuItem value=\"\">(Select contact)</MenuItem>\n                          {contacts.map((c:any)=> <MenuItem key={c.contact_id} value={c.contact_id}>{c.display_name}</MenuItem>)}\n                        </Select>\n                      </TableCell>\n                      <TableCell align=\"right\"><TextField type=\"number\" value={cl.check_amount || ''} onChange={e => { const copy = {...form}; copy.check_lines = copy.check_lines || []; copy.check_lines[idx] = { ...(copy.check_lines[idx]||{}), check_amount: e.target.value === '' ? '' : Number(e.target.value) }; setForm(copy); }} InputProps={{ sx: { textAlign: 'right' } }} /></TableCell>\n                      <TableCell><Button color=\"error\" onClick={() => { const copy = {...form}; copy.check_lines = copy.check_lines || []; copy.check_lines = copy.check_lines.filter((_:any,i:number)=>i!==idx); setForm(copy); }}>Remove</Button></TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n              <Box sx={{mt:1}}><Button onClick={() => { const copy = {...form}; copy.check_lines = copy.check_lines || []; copy.check_lines.push({ check_date:'', check_number:'', check_amount:0, check_subpayee: null }); setForm(copy); }}>Add Check Line</Button></Box>\n            </Box>\n          )}\n\n          {/* Payment Details */}\n          <Box sx={{mt:2, mb:2}}>\n            <Box sx={{fontWeight:700, mb:1}}>PAYMENT DETAILS</Box>\n            <Table size=\"small\">\n              <TableHead>\n                <TableRow>\n                  <TableCell>Payee</TableCell>\n                  <TableCell>Description</TableCell>\n                  <TableCell align=\"right\">Amount to Pay</TableCell>\n                  <TableCell></TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {(form.payment_lines || []).map((line:any, idx:number) => (\n                  <TableRow key={idx}>\n                    <TableCell sx={{minWidth:200}}>\n                      <Select fullWidth value={String(line.payee_contact_id || '')} onChange={e => { const v = e.target.value; const copy = {...form}; copy.payment_lines = copy.payment_lines || []; copy.payment_lines[idx] = { ...(copy.payment_lines[idx] || {}), payee_contact_id: v ? Number(v) : null, payee_display: contacts.find((c:any)=>String(c.contact_id)===String(v))?.display_name || '' }; setForm(copy); }}>\n                        <MenuItem value=\"\">-- Select Payee --</MenuItem>\n                        {contacts.map((c:any) => <MenuItem key={c.contact_id} value={String(c.contact_id)}>{c.display_name}{c.contact_type ? ` (${c.contact_type})` : ''}</MenuItem>)}\n                      </Select>\n                    </TableCell>\n                    <TableCell>\n                      <TextField fullWidth value={line.description || ''} onChange={e => { const copy = {...form}; copy.payment_lines = copy.payment_lines || []; copy.payment_lines[idx] = { ...(copy.payment_lines[idx] || {}), description: e.target.value }; setForm(copy); }} />\n                    </TableCell>\n                    <TableCell align=\"right\">\n                      <TextField type=\"number\" value={line.amount || ''} onChange={e => { const copy = {...form}; copy.payment_lines = copy.payment_lines || []; copy.payment_lines[idx] = { ...(copy.payment_lines[idx] || {}), amount: e.target.value }; setForm(copy); }} InputProps={{ sx: { textAlign: 'right' } }} />\n                    </TableCell>\n                    <TableCell>\n                      <Button color=\"error\" onClick={() => { const copy = {...form}; copy.payment_lines = copy.payment_lines || []; copy.payment_lines = copy.payment_lines.filter((_:any,i:number)=>i!==idx); setForm(copy); }}>Remove</Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n            <Box sx={{mt:1}}>\n              <Button onClick={() => { const copy = {...form}; copy.payment_lines = copy.payment_lines || []; copy.payment_lines.push(emptyPaymentLine()); setForm(copy); }}>+ Add another line</Button>\n            </Box>\n            <Box sx={{mt:2, textAlign:'right', fontWeight:700}}>Total Amount to Pay: PHP {(form.payment_lines || []).reduce((s:any,l:any)=>s + (Number(l.amount)||0), 0)}</Box>\n          </Box>\n\n          {/* Journal Entry */}\n          <Box sx={{mt:2, mb:2}}>\n            <Box sx={{fontWeight:700, mb:1}}>JOURNAL ENTRY</Box>\n            <Table size=\"small\">\n              <TableHead>\n                <TableRow>\n                  <TableCell>COA</TableCell>\n                  <TableCell>Debit</TableCell>\n                  <TableCell>Credit</TableCell>\n                  <TableCell>Remarks</TableCell>\n                  <TableCell></TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {(form.journal_lines || []).map((line:any, idx:number) => (\n                  <TableRow key={idx}>\n                    <TableCell sx={{minWidth:200}}>\n                      <Select fullWidth value={String(line.coa_id || '')} onChange={e => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines[idx] = { ...(copy.journal_lines[idx] || {}), coa_id: e.target.value }; setForm(copy); }}>\n                        <MenuItem value=\"\">-- Select COA --</MenuItem>\n                        {coas.map((a:any) => <MenuItem key={a.coa_id} value={String(a.coa_id)}>{a.account_name || a.name || a.coa_id}</MenuItem>)}\n                      </Select>\n                    </TableCell>\n                    <TableCell>\n                      <TextField fullWidth value={line.debit || ''} onChange={e => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines[idx] = { ...(copy.journal_lines[idx] || {}), debit: e.target.value }; setForm(copy); }} InputProps={{ sx: { textAlign: 'right' } }} />\n                    </TableCell>\n                    <TableCell>\n                      <TextField fullWidth value={line.credit || ''} onChange={e => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines[idx] = { ...(copy.journal_lines[idx] || {}), credit: e.target.value }; setForm(copy); }} InputProps={{ sx: { textAlign: 'right' } }} />\n                    </TableCell>\n                    <TableCell>\n                      <TextField fullWidth value={line.remarks || ''} onChange={e => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines[idx] = { ...(copy.journal_lines[idx] || {}), remarks: e.target.value }; setForm(copy); }} />\n                    </TableCell>\n                    <TableCell>\n                      <Button color=\"error\" onClick={() => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines = copy.journal_lines.filter((_:any,i:number)=>i!==idx); setForm(copy); }}>Remove</Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n            <Box sx={{mt:1}}>\n              <Button onClick={() => { const copy = {...form}; copy.journal_lines = copy.journal_lines || []; copy.journal_lines.push(emptyJournalLine()); setForm(copy); }}>+ Add another line</Button>\n            </Box>\n            <Box sx={{mt:2, textAlign:'right'}}>\n              <div><strong>Total Debit</strong> PHP {(form.journal_lines || []).reduce((s:any,l:any)=>s + (Number(l.debit)||0), 0)}</div>\n              <div><strong>Total Credit</strong> PHP {(form.journal_lines || []).reduce((s:any,l:any)=>s + (Number(l.credit)||0), 0)}</div>\n            </Box>\n          </Box>\n\n          {/* Signatories */}\n          <Box sx={{mt:2, mb:2}}>\n            <Box sx={{fontWeight:700, mb:1}}>SIGNATORIES</Box>\n            <Box sx={{display:'grid', gridTemplateColumns: '1fr 1fr 1fr', gap:2}}>\n              <TextField label=\"Prepared By\" value={(form.prepared_by_manual && form.prepared_by_manual) || (form.prepared_by && userNames[String(form.prepared_by)]) || ''} disabled />\n              <Autocomplete\n                freeSolo\n                options={userOptions.map(u => ({ id: u.user_id, label: u.full_name || u.username || String(u.user_id) }))}\n                getOptionLabel={(opt:any) => typeof opt === 'string' ? opt : (opt && opt.label) || ''}\n                // value is the selected option or a string when freeSolo; keep input in sync with form.reviewed_by\n                value={(() => {\n                  const v = form.reviewed_by;\n                  if (v === null || v === undefined || v === '') return '';\n                  if (!isNaN(Number(v))) return userNames[String(v)] || String(v);\n                  return v;\n                })()}\n                inputValue={(() => {\n                  const v = form.reviewed_by;\n                  if (v === null || v === undefined || v === '') return '';\n                  if (!isNaN(Number(v))) return userNames[String(v)] || String(v);\n                  return v;\n                })()}\n                onInputChange={(_, newInput) => {\n                  // keep the form in sync with typed input (freeSolo)\n                  setForm((prev: any) => ({ ...prev, reviewed_by: newInput }));\n                }}\n                onChange={(_, newVal) => {\n                  if (!newVal) return setForm((prev: any) => ({ ...prev, reviewed_by: null }));\n                  if (typeof newVal === 'string') return setForm((prev: any) => ({ ...prev, reviewed_by: newVal }));\n                  return setForm((prev: any) => ({ ...prev, reviewed_by: newVal.id }));\n                }}\n                renderInput={(params) => <TextField {...params} label=\"Reviewed By\" />}\n              />\n              <Autocomplete\n                freeSolo\n                options={userOptions.map(u => ({ id: u.user_id, label: u.full_name || u.username || String(u.user_id) }))}\n                getOptionLabel={(opt:any) => typeof opt === 'string' ? opt : (opt && opt.label) || ''}\n                value={(() => {\n                  const v = form.approved_by;\n                  if (v === null || v === undefined || v === '') return '';\n                  if (!isNaN(Number(v))) return userNames[String(v)] || String(v);\n                  return v;\n                })()}\n                inputValue={(() => {\n                  const v = form.approved_by;\n                  if (v === null || v === undefined || v === '') return '';\n                  if (!isNaN(Number(v))) return userNames[String(v)] || String(v);\n                  return v;\n                })()}\n                onInputChange={(_, newInput) => {\n                  setForm((prev: any) => ({ ...prev, approved_by: newInput }));\n                }}\n                onChange={(_, newVal) => {\n                  if (!newVal) return setForm((prev: any) => ({ ...prev, approved_by: null }));\n                  if (typeof newVal === 'string') return setForm((prev: any) => ({ ...prev, approved_by: newVal }));\n                  return setForm((prev: any) => ({ ...prev, approved_by: newVal.id }));\n                }}\n                renderInput={(params) => <TextField {...params} label=\"Approved By\" />}\n              />\n            </Box>\n          </Box>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => { resetForm(); }}>Cancel</Button>\n          <Button onClick={async () => { await save(); /* save already closes and fetches; ensure form reset */ resetForm(); }} variant=\"contained\">Save</Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* Preview / Print dialog */}\n      <Dialog open={previewOpen} onClose={() => setPreviewOpen(false)} fullWidth maxWidth=\"md\">\n        <DialogTitle>Preview Check Voucher</DialogTitle>\n        <DialogContent>\n          {previewItem ? (\n            <div id=\"cv-print-area\" style={{padding:20, fontFamily: 'Arial, sans-serif', color: '#000'}}>\n              <div style={{display:'flex', justifyContent:'space-between', alignItems:'center', marginBottom:20}}>\n                <div>\n                  <div style={{fontSize:20, fontWeight:700}}>{previewItem.company ? (previewItem.company.name || previewItem.company.company_name || '') : ''}</div>\n                  <div style={{fontSize:12}}>{previewItem.company ? (previewItem.company.address || '') : ''}</div>\n                </div>\n                <div>\n                  {previewItem.company && previewItem.company.logo ? <img src={previewItem.company.logo} alt=\"logo\" style={{height:60}}/> : null}\n                </div>\n              </div>\n              <hr />\n              <div style={{display:'flex', justifyContent:'space-between', marginTop:10}}>\n                <div>\n                  <div><strong>CV Ctrl:</strong> {previewItem.check_voucher_control || previewItem.check_voucher_id}</div>\n                  <div><strong>Prepared:</strong> {formatDateToMMDDYYYY(previewItem.cvoucher_date)}</div>\n                  <div><strong>Purpose:</strong> {previewItem.purpose}</div>\n                </div>\n                <div style={{textAlign:'right'}}>\n                  <div><strong>Amount:</strong> PHP {previewItem.check_amount || (previewItem.payment_lines && previewItem.payment_lines.length ? previewItem.payment_lines.reduce((s:any,l:any)=>s + (Number(l.amount)||0),0) : 0)}</div>\n                </div>\n              </div>\n              <div style={{marginTop:20}}>\n                <div style={{fontWeight:700}}>Payment Details</div>\n                <table style={{width:'100%', borderCollapse:'collapse', marginTop:8}}>\n                  <thead>\n                    <tr><th style={{borderBottom:'1px solid #ccc', textAlign:'left'}}>Payee</th><th style={{borderBottom:'1px solid #ccc', textAlign:'left'}}>Description</th><th style={{borderBottom:'1px solid #ccc', textAlign:'right'}}>Amount</th></tr>\n                  </thead>\n                  <tbody>\n                    {(previewItem.payment_lines || []).map((l:any, i:number) => (\n                      <tr key={i}><td style={{padding:'6px 0'}}>{l.payee_display || l.payee_name || l.payee_contact_id || '-'}</td><td style={{padding:'6px 0'}}>{l.description || ''}</td><td style={{padding:'6px 0', textAlign:'right'}}>{Number(l.amount||0).toFixed(2)}</td></tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div style={{marginTop:20}}>\n                <div style={{fontWeight:700}}>Journal Entries</div>\n                <table style={{width:'100%', borderCollapse:'collapse', marginTop:8}}>\n                  <thead>\n                    <tr><th style={{borderBottom:'1px solid #ccc', textAlign:'left'}}>COA</th><th style={{borderBottom:'1px solid #ccc', textAlign:'right'}}>Debit</th><th style={{borderBottom:'1px solid #ccc', textAlign:'right'}}>Credit</th></tr>\n                  </thead>\n                  <tbody>\n                    {(previewItem.journal_lines || []).map((j:any, i:number) => (\n                      <tr key={i}><td style={{padding:'6px 0'}}>{j.account_name || j.coa_name || j.coa_id || ''}</td><td style={{padding:'6px 0', textAlign:'right'}}>{Number(j.debit||0).toFixed(2)}</td><td style={{padding:'6px 0', textAlign:'right'}}>{Number(j.credit||0).toFixed(2)}</td></tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div style={{marginTop:20}}>\n                <div style={{display:'flex', justifyContent:'space-between'}}>\n                  <div style={{textAlign:'center', width:'30%'}}>\n                    <div style={{fontWeight:700}}>Prepared By</div>\n                    <div style={{marginTop:24}}>__________________</div>\n                    <div style={{marginTop:8, fontSize:12}}>{previewItem.prepared_by_name || getSignatoryDisplay(previewItem.prepared_by || previewItem.prepared_by_manual || '')}</div>\n                  </div>\n                  <div style={{textAlign:'center', width:'30%'}}>\n                    <div style={{fontWeight:700}}>Reviewed By</div>\n                    <div style={{marginTop:24}}>__________________</div>\n                    <div style={{marginTop:8, fontSize:12}}>{previewItem.reviewed_by_name || getSignatoryDisplay(previewItem.reviewed_by || previewItem.reviewed_by_manual || '')}</div>\n                  </div>\n                  <div style={{textAlign:'center', width:'30%'}}>\n                    <div style={{fontWeight:700}}>Approved By</div>\n                    <div style={{marginTop:24}}>__________________</div>\n                    <div style={{marginTop:8, fontSize:12}}>{previewItem.approved_by_name || getSignatoryDisplay(previewItem.approved_by || previewItem.approved_by_manual || '')}</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ) : <div>No preview data</div>}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setPreviewOpen(false)}>Close</Button>\n          <Button onClick={() => previewItem && downloadPdf(previewItem.check_voucher_id)} sx={{mr:1}}>Download PDF</Button>\n          <Button onClick={() => {\n            const el = document.getElementById('cv-print-area');\n            if (!el) { setSnackMsg('Nothing to print'); setSnackSeverity('info'); setSnackOpen(true); return; }\n            const printHtml = `<!doctype html><html><head><meta charset=\"utf-8\"><title>Check Voucher</title><style>body{font-family: Arial, sans-serif; color:#000; padding:20px;} table{width:100%;border-collapse:collapse;} th,td{padding:6px 4px;} th{border-bottom:1px solid #ccc;}</style></head><body>${el.innerHTML}<script> (function(){ function doPrint(){ try{ window.focus(); window.print(); }catch(e){ console.error('Print failed', e); } } if(document.readyState==='complete'){ setTimeout(doPrint,50); } else { window.addEventListener('load', function(){ setTimeout(doPrint,50); }); } window.addEventListener('afterprint', function(){ try{ window.close(); }catch(e){} }); })(); </script></body></html>`;\n            const win = window.open('', '_blank');\n            if (!win) {\n              // fallback to iframe\n              try {\n                const iframe = document.createElement('iframe'); iframe.style.position='fixed'; iframe.style.right='0'; iframe.style.bottom='0'; iframe.style.width='0'; iframe.style.height='0'; iframe.style.border='0'; document.body.appendChild(iframe);\n                const idoc = iframe.contentWindow?.document; if (!idoc) throw new Error('iframe doc unavailable'); idoc.open(); idoc.write(printHtml); idoc.close(); const tryPrint = () => { try { iframe.contentWindow?.focus(); iframe.contentWindow?.print(); } catch (e) { setSnackMsg('Print failed in iframe'); setSnackSeverity('error'); setSnackOpen(true); } setTimeout(() => { try { document.body.removeChild(iframe); } catch (e) {} }, 500); };\n                iframe.onload = tryPrint; setTimeout(tryPrint, 800); return;\n              } catch (e:any) { setSnackMsg('Popup blocked and fallback failed. Allow popups or use Download PDF.'); setSnackSeverity('error'); setSnackOpen(true); return; }\n            }\n            win.document.open(); win.document.write(printHtml); win.document.close();\n          }} variant=\"contained\">Print / Save as PDF</Button>\n        </DialogActions>\n      </Dialog>\n\n      <Snackbar open={snackOpen} autoHideDuration={4000} onClose={() => setSnackOpen(false)}>\n        <Alert severity={snackSeverity} sx={{ width: '100%' }}>{snackMsg}</Alert>\n      </Snackbar>\n    </Box>\n  );\n};\n\nexport default CheckVouchers;\n","import React from 'react';\r\nimport { Box, Tabs, Tab, Paper } from '@mui/material';\r\nimport PaymentVouchers from './PaymentVouchers';\r\nimport DisbursementReports from './DisbursementReports';\r\nimport CheckVouchers from './CheckVouchers';\r\n\r\nfunction TabPanel({ children, value, index }: any) {\r\n\treturn <div role=\"tabpanel\" hidden={value !== index}>{value === index && <Box p={2}>{children}</Box>}</div>;\r\n}\r\n\r\nconst APManagement: React.FC = () => {\r\n\tconst [tab, setTab] = React.useState(0);\r\n\t\treturn (\r\n\t\t\t<Box>\r\n\t\t\t\t<h2>AP Management Module</h2>\r\n\t\t\t<Paper>\r\n\t\t\t\t<Tabs value={tab} onChange={(e, v) => setTab(v)} indicatorColor=\"primary\" textColor=\"primary\">\r\n\t\t\t\t\t<Tab label=\"Payment Vouchers\" />\r\n\t\t\t\t\t<Tab label=\"Disbursement Reports\" />\r\n\t\t\t\t\t<Tab label=\"Check Vouchers\" />\r\n\t\t\t\t</Tabs>\r\n\t\t\t</Paper>\r\n\t\t\t<TabPanel value={tab} index={0}><PaymentVouchers /></TabPanel>\r\n\t\t\t<TabPanel value={tab} index={1}><DisbursementReports /></TabPanel>\r\n\t\t\t<TabPanel value={tab} index={2}><CheckVouchers /></TabPanel>\r\n\t\t</Box>\r\n\t);\r\n};\r\n\r\nexport default APManagement;\r\n","export function formatDateToMMDDYYYY(input: string | Date | undefined | null): string {\n  if (!input) return '';\n  const d = typeof input === 'string' ? new Date(input) : input;\n  if (Number.isNaN(d.getTime())) return '';\n  const mm = String(d.getMonth() + 1).padStart(2, '0');\n  const dd = String(d.getDate()).padStart(2, '0');\n  const yyyy = String(d.getFullYear());\n  return `${mm}/${dd}/${yyyy}`;\n}\n"],"names":["console","debug","RESOLVED_API_BASE","emptyForm","status","preparation_date","purpose","paid_through","prepared_by","description","payment_lines","journal_lines","PaymentVouchers","user","useContext","UserContext","items","setItems","useState","loading","setLoading","contacts","setContacts","coas","setCoas","open","setOpen","editing","setEditing","form","setForm","expectedControl","setExpectedControl","firstFocusRef","useRef","companyProfile","setCompanyProfile","userNames","setUserNames","previewOpen","setPreviewOpen","previewItem","setPreviewItem","parseSignatoryValue","val","undefined","Array","isArray","map","String","filter","Boolean","p","JSON","parse","e","m","match","getSignatoryDisplay","ids","length","id","join","deleteId","setDeleteId","confirmOpen","setConfirmOpen","selected","setSelected","snackOpen","setSnackOpen","snackMsg","setSnackMsg","snackSeverity","setSnackSeverity","fetchAll","useCallback","async","pvResData","pvRes","axios","get","buildUrl","data","err","_err$response","error","response","message","seed","idsToFetch","Set","prepared_by_username","isNaN","Number","sid","add","Object","keys","prev","_objectSpread","size","token","localStorage","getItem","Promise","all","from","r","concat","headers","Authorization","full_name","username","fetchedContacts","contactRes","_err$response2","vendRes","mapped","v","contact_id","vendor_id","display_name","name","contact_type","log","slice","_e$response","coaRes","c","_err$response3","warn","fb","c2","err2","_err2$response","fetchCoas","res","tryFetchWithFallback","ok","Error","json","fbRes","data2","fetchContacts","_e$response2","_err$response4","React","setTimeout","_firstFocusRef$curren","current","focus","cache","then","d","catch","_jsxs","Box","children","style","display","justifyContent","alignItems","_jsx","Button","variant","onClick","rows","_e$response3","refreshedUser","resp","reviewed_by_val","approved_by_val","me","_me","reviewer_id","reviewer_manual","approver_id","approver_manual","user_id","rid","aid","Date","toISOString","reviewed_by","approved_by","payee_id","amount","coa_id","debit","credit","remarks","id2","sx","mr","color","CircularProgress","Table","TableHead","TableRow","TableCell","TableBody","pv","Checkbox","checked","payment_voucher_id","onChange","toggleSelect","payment_voucher_control","formatDateToMMDDYYYY","amount_to_pay","reduce","s","l","pvReviewer","reviewed_by_manual","pvApprover","approved_by_manual","reviewerValue","approverValue","indexOf","pl","payee_contact_id","payee_name","payee_display","idsToResolve","pid","push","openEdit","confirmDelete","serverPV","basePV","resolvedJournal","j","copy","account_name","cid","coa","found","find","enrichedPV","fetchedNames","maybe","ridVals","aidVals","pidVals","prepared_by_manual","prepared_by_name","vals","reviewed_by_name","approved_by_name","reviewerSource","approverSource","ex","colSpan","Dialog","onClose","fullWidth","maxWidth","DialogTitle","IconButton","position","right","top","CloseIcon","DialogContent","gridTemplateColumns","gap","mb","TextField","inputRef","label","type","value","target","InputLabelProps","shrink","FormControl","InputLabel","Select","labelId","MenuItem","mt","fontWeight","align","line","idx","minWidth","payee","_contacts$find","InputProps","textAlign","_","i","a","disabled","DialogActions","mappedPaymentLines","_contacts$find2","contactId","determineSignatory","manual","reviewerSpec","approverSpec","payload","put","post","ctrl","_err$response5","_err$response5$data","padding","fontFamily","marginBottom","fontSize","company_name","address","logo","src","alt","height","marginTop","width","borderCollapse","borderBottom","toFixed","coa_name","pvId","txt","text","msg","includes","blob","url","URL","createObjectURL","disp","filename","exec","document","createElement","href","download","body","appendChild","click","remove","revokeObjectURL","downloadPdf","el","getElementById","printHtml","innerHTML","win","window","_iframe$contentWindow","iframe","bottom","border","idoc","contentWindow","write","close","tryPrint","_iframe$contentWindow2","_iframe$contentWindow3","print","removeChild","onload","delete","_e$response4","_e$response4$data","Snackbar","autoHideDuration","Alert","severity","DisbursementReports","reports","_ref","endpoint","initialData","setData","setError","makeUrl","ep","startsWith","_err$response$data","item","_err$response2$data","update","_err$response3$data","_err$response4$data","useCrud","expanded","setExpanded","pvList","setPvList","creating","setCreating","useEffect","submitModalOpen","setSubmitModalOpen","currentReport","setCurrentReport","routingInfo","setRoutingInfo","submitting","setSubmitting","cascadeNow","setCascadeNow","flex","k","ss","disbursement_date","voucher_ids","_e$response$data","_Fragment","disbursement_report_ctrl_number","disbursement_report_id","marginLeft","routeRes","cascade","x","routing","_e$response2$data","paddingLeft","vouchers","reviewer","approver","notes","n","_e$response3$data","CheckVouchers","userOptions","setUserOptions","fetchList","fetchUserOptions","u","resetForm","currentUserId","reviewerVal","approverVal","meResp","cvoucher_date","mode","check_lines","Grid","container","spacing","xs","md","Paper","Typography","Divider","my","cv","check_voucher_control","check_payee","check_amount","_ref2","_ref3","_ref4","_cv$reviewer_id","_ref5","_ref6","_ref7","_ref8","_cv$approver_id","_ref9","_me$reviewer_id","_ref0","_me$approver_id","resolvedReviewer","resolvedApprover","jl","multiple_checks","cl","check_date","check_number","check_subpayee","toResolve","check_voucher_id","base","enriched","company","cr","collect","ur","meR","resolveIdToName","_unused","rv","av","check_no","marginRight","Autocomplete","freeSolo","options","getOptionLabel","opt","inputValue","onInputChange","newInput","newVal","renderInput","params","mappedJournalLines","parseReviewer","check_voucher","save","cvId","TabPanel","index","role","hidden","APManagement","tab","setTab","Tabs","indicatorColor","textColor","Tab","input","getTime","mm","getMonth","padStart","dd","getDate","yyyy","getFullYear"],"sourceRoot":""}